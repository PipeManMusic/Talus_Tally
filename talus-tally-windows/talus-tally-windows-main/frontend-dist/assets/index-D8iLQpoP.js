(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const h of f)if(h.type==="childList")for(const x of h.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function i(f){const h={};return f.integrity&&(h.integrity=f.integrity),f.referrerPolicy&&(h.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?h.credentials="include":f.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function u(f){if(f.ep)return;f.ep=!0;const h=i(f);fetch(f.href,h)}})();function Oy(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var au={exports:{}},Si={};var bm;function zy(){if(bm)return Si;bm=1;var o=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function i(u,f,h){var x=null;if(h!==void 0&&(x=""+h),f.key!==void 0&&(x=""+f.key),"key"in f){h={};for(var w in f)w!=="key"&&(h[w]=f[w])}else h=f;return f=h.ref,{$$typeof:o,type:u,key:x,ref:f!==void 0?f:null,props:h}}return Si.Fragment=s,Si.jsx=i,Si.jsxs=i,Si}var xm;function My(){return xm||(xm=1,au.exports=zy()),au.exports}var l=My(),su={exports:{}},Fe={};var vm;function Ry(){if(vm)return Fe;vm=1;var o=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),x=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),G=Symbol.iterator;function L(g){return g===null||typeof g!="object"?null:(g=G&&g[G]||g["@@iterator"],typeof g=="function"?g:null)}var ce={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,ve={};function ge(g,T,A){this.props=g,this.context=T,this.refs=ve,this.updater=A||ce}ge.prototype.isReactComponent={},ge.prototype.setState=function(g,T){if(typeof g!="object"&&typeof g!="function"&&g!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,T,"setState")},ge.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")};function Ee(){}Ee.prototype=ge.prototype;function _e(g,T,A){this.props=g,this.context=T,this.refs=ve,this.updater=A||ce}var W=_e.prototype=new Ee;W.constructor=_e,ie(W,ge.prototype),W.isPureReactComponent=!0;var Te=Array.isArray;function fe(){}var oe={H:null,A:null,T:null,S:null},Ce=Object.prototype.hasOwnProperty;function Re(g,T,A){var X=A.ref;return{$$typeof:o,type:g,key:T,ref:X!==void 0?X:null,props:A}}function Oe(g,T){return Re(g.type,T,g.props)}function $(g){return typeof g=="object"&&g!==null&&g.$$typeof===o}function ye(g){var T={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,function(A){return T[A]})}var ee=/\/+/g;function Se(g,T){return typeof g=="object"&&g!==null&&g.key!=null?ye(""+g.key):T.toString(36)}function B(g){switch(g.status){case"fulfilled":return g.value;case"rejected":throw g.reason;default:switch(typeof g.status=="string"?g.then(fe,fe):(g.status="pending",g.then(function(T){g.status==="pending"&&(g.status="fulfilled",g.value=T)},function(T){g.status==="pending"&&(g.status="rejected",g.reason=T)})),g.status){case"fulfilled":return g.value;case"rejected":throw g.reason}}throw g}function v(g,T,A,X,me){var we=typeof g;(we==="undefined"||we==="boolean")&&(g=null);var qe=!1;if(g===null)qe=!0;else switch(we){case"bigint":case"string":case"number":qe=!0;break;case"object":switch(g.$$typeof){case o:case s:qe=!0;break;case S:return qe=g._init,v(qe(g._payload),T,A,X,me)}}if(qe)return me=me(g),qe=X===""?"."+Se(g,0):X,Te(me)?(A="",qe!=null&&(A=qe.replace(ee,"$&/")+"/"),v(me,T,A,"",function(Xe){return Xe})):me!=null&&($(me)&&(me=Oe(me,A+(me.key==null||g&&g.key===me.key?"":(""+me.key).replace(ee,"$&/")+"/")+qe)),T.push(me)),1;qe=0;var te=X===""?".":X+":";if(Te(g))for(var de=0;de<g.length;de++)X=g[de],we=te+Se(X,de),qe+=v(X,T,A,we,me);else if(de=L(g),typeof de=="function")for(g=de.call(g),de=0;!(X=g.next()).done;)X=X.value,we=te+Se(X,de++),qe+=v(X,T,A,we,me);else if(we==="object"){if(typeof g.then=="function")return v(B(g),T,A,X,me);throw T=String(g),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.")}return qe}function M(g,T,A){if(g==null)return g;var X=[],me=0;return v(g,X,"","",function(we){return T.call(A,we,me++)}),X}function Z(g){if(g._status===-1){var T=g._result;T=T(),T.then(function(A){(g._status===0||g._status===-1)&&(g._status=1,g._result=A)},function(A){(g._status===0||g._status===-1)&&(g._status=2,g._result=A)}),g._status===-1&&(g._status=0,g._result=T)}if(g._status===1)return g._result.default;throw g._result}var j=typeof reportError=="function"?reportError:function(g){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var T=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof g=="object"&&g!==null&&typeof g.message=="string"?String(g.message):String(g),error:g});if(!window.dispatchEvent(T))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",g);return}console.error(g)},se={map:M,forEach:function(g,T,A){M(g,function(){T.apply(this,arguments)},A)},count:function(g){var T=0;return M(g,function(){T++}),T},toArray:function(g){return M(g,function(T){return T})||[]},only:function(g){if(!$(g))throw Error("React.Children.only expected to receive a single React element child.");return g}};return Fe.Activity=b,Fe.Children=se,Fe.Component=ge,Fe.Fragment=i,Fe.Profiler=f,Fe.PureComponent=_e,Fe.StrictMode=u,Fe.Suspense=E,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=oe,Fe.__COMPILER_RUNTIME={__proto__:null,c:function(g){return oe.H.useMemoCache(g)}},Fe.cache=function(g){return function(){return g.apply(null,arguments)}},Fe.cacheSignal=function(){return null},Fe.cloneElement=function(g,T,A){if(g==null)throw Error("The argument must be a React element, but you passed "+g+".");var X=ie({},g.props),me=g.key;if(T!=null)for(we in T.key!==void 0&&(me=""+T.key),T)!Ce.call(T,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&T.ref===void 0||(X[we]=T[we]);var we=arguments.length-2;if(we===1)X.children=A;else if(1<we){for(var qe=Array(we),te=0;te<we;te++)qe[te]=arguments[te+2];X.children=qe}return Re(g.type,me,X)},Fe.createContext=function(g){return g={$$typeof:x,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null},g.Provider=g,g.Consumer={$$typeof:h,_context:g},g},Fe.createElement=function(g,T,A){var X,me={},we=null;if(T!=null)for(X in T.key!==void 0&&(we=""+T.key),T)Ce.call(T,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(me[X]=T[X]);var qe=arguments.length-2;if(qe===1)me.children=A;else if(1<qe){for(var te=Array(qe),de=0;de<qe;de++)te[de]=arguments[de+2];me.children=te}if(g&&g.defaultProps)for(X in qe=g.defaultProps,qe)me[X]===void 0&&(me[X]=qe[X]);return Re(g,we,me)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(g){return{$$typeof:w,render:g}},Fe.isValidElement=$,Fe.lazy=function(g){return{$$typeof:S,_payload:{_status:-1,_result:g},_init:Z}},Fe.memo=function(g,T){return{$$typeof:y,type:g,compare:T===void 0?null:T}},Fe.startTransition=function(g){var T=oe.T,A={};oe.T=A;try{var X=g(),me=oe.S;me!==null&&me(A,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(fe,j)}catch(we){j(we)}finally{T!==null&&A.types!==null&&(T.types=A.types),oe.T=T}},Fe.unstable_useCacheRefresh=function(){return oe.H.useCacheRefresh()},Fe.use=function(g){return oe.H.use(g)},Fe.useActionState=function(g,T,A){return oe.H.useActionState(g,T,A)},Fe.useCallback=function(g,T){return oe.H.useCallback(g,T)},Fe.useContext=function(g){return oe.H.useContext(g)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(g,T){return oe.H.useDeferredValue(g,T)},Fe.useEffect=function(g,T){return oe.H.useEffect(g,T)},Fe.useEffectEvent=function(g){return oe.H.useEffectEvent(g)},Fe.useId=function(){return oe.H.useId()},Fe.useImperativeHandle=function(g,T,A){return oe.H.useImperativeHandle(g,T,A)},Fe.useInsertionEffect=function(g,T){return oe.H.useInsertionEffect(g,T)},Fe.useLayoutEffect=function(g,T){return oe.H.useLayoutEffect(g,T)},Fe.useMemo=function(g,T){return oe.H.useMemo(g,T)},Fe.useOptimistic=function(g,T){return oe.H.useOptimistic(g,T)},Fe.useReducer=function(g,T,A){return oe.H.useReducer(g,T,A)},Fe.useRef=function(g){return oe.H.useRef(g)},Fe.useState=function(g){return oe.H.useState(g)},Fe.useSyncExternalStore=function(g,T,A){return oe.H.useSyncExternalStore(g,T,A)},Fe.useTransition=function(){return oe.H.useTransition()},Fe.version="19.2.4",Fe}var wm;function Tu(){return wm||(wm=1,su.exports=Ry()),su.exports}var m=Tu();const Nl=Oy(m);var lu={exports:{}},ji={},iu={exports:{}},ru={};var Sm;function Uy(){return Sm||(Sm=1,(function(o){function s(v,M){var Z=v.length;v.push(M);e:for(;0<Z;){var j=Z-1>>>1,se=v[j];if(0<f(se,M))v[j]=M,v[Z]=se,Z=j;else break e}}function i(v){return v.length===0?null:v[0]}function u(v){if(v.length===0)return null;var M=v[0],Z=v.pop();if(Z!==M){v[0]=Z;e:for(var j=0,se=v.length,g=se>>>1;j<g;){var T=2*(j+1)-1,A=v[T],X=T+1,me=v[X];if(0>f(A,Z))X<se&&0>f(me,A)?(v[j]=me,v[X]=Z,j=X):(v[j]=A,v[T]=Z,j=T);else if(X<se&&0>f(me,Z))v[j]=me,v[X]=Z,j=X;else break e}}return M}function f(v,M){var Z=v.sortIndex-M.sortIndex;return Z!==0?Z:v.id-M.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;o.unstable_now=function(){return h.now()}}else{var x=Date,w=x.now();o.unstable_now=function(){return x.now()-w}}var E=[],y=[],S=1,b=null,G=3,L=!1,ce=!1,ie=!1,ve=!1,ge=typeof setTimeout=="function"?setTimeout:null,Ee=typeof clearTimeout=="function"?clearTimeout:null,_e=typeof setImmediate<"u"?setImmediate:null;function W(v){for(var M=i(y);M!==null;){if(M.callback===null)u(y);else if(M.startTime<=v)u(y),M.sortIndex=M.expirationTime,s(E,M);else break;M=i(y)}}function Te(v){if(ie=!1,W(v),!ce)if(i(E)!==null)ce=!0,fe||(fe=!0,ye());else{var M=i(y);M!==null&&B(Te,M.startTime-v)}}var fe=!1,oe=-1,Ce=5,Re=-1;function Oe(){return ve?!0:!(o.unstable_now()-Re<Ce)}function $(){if(ve=!1,fe){var v=o.unstable_now();Re=v;var M=!0;try{e:{ce=!1,ie&&(ie=!1,Ee(oe),oe=-1),L=!0;var Z=G;try{t:{for(W(v),b=i(E);b!==null&&!(b.expirationTime>v&&Oe());){var j=b.callback;if(typeof j=="function"){b.callback=null,G=b.priorityLevel;var se=j(b.expirationTime<=v);if(v=o.unstable_now(),typeof se=="function"){b.callback=se,W(v),M=!0;break t}b===i(E)&&u(E),W(v)}else u(E);b=i(E)}if(b!==null)M=!0;else{var g=i(y);g!==null&&B(Te,g.startTime-v),M=!1}}break e}finally{b=null,G=Z,L=!1}M=void 0}}finally{M?ye():fe=!1}}}var ye;if(typeof _e=="function")ye=function(){_e($)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Se=ee.port2;ee.port1.onmessage=$,ye=function(){Se.postMessage(null)}}else ye=function(){ge($,0)};function B(v,M){oe=ge(function(){v(o.unstable_now())},M)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(v){v.callback=null},o.unstable_forceFrameRate=function(v){0>v||125<v?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<v?Math.floor(1e3/v):5},o.unstable_getCurrentPriorityLevel=function(){return G},o.unstable_next=function(v){switch(G){case 1:case 2:case 3:var M=3;break;default:M=G}var Z=G;G=M;try{return v()}finally{G=Z}},o.unstable_requestPaint=function(){ve=!0},o.unstable_runWithPriority=function(v,M){switch(v){case 1:case 2:case 3:case 4:case 5:break;default:v=3}var Z=G;G=v;try{return M()}finally{G=Z}},o.unstable_scheduleCallback=function(v,M,Z){var j=o.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?j+Z:j):Z=j,v){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Z+se,v={id:S++,callback:M,priorityLevel:v,startTime:Z,expirationTime:se,sortIndex:-1},Z>j?(v.sortIndex=Z,s(y,v),i(E)===null&&v===i(y)&&(ie?(Ee(oe),oe=-1):ie=!0,B(Te,Z-j))):(v.sortIndex=se,s(E,v),ce||L||(ce=!0,fe||(fe=!0,ye()))),v},o.unstable_shouldYield=Oe,o.unstable_wrapCallback=function(v){var M=G;return function(){var Z=G;G=M;try{return v.apply(this,arguments)}finally{G=Z}}}})(ru)),ru}var jm;function Ly(){return jm||(jm=1,iu.exports=Uy()),iu.exports}var ou={exports:{}},fn={};var Nm;function By(){if(Nm)return fn;Nm=1;var o=Tu();function s(E){var y="https://react.dev/errors/"+E;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)y+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+E+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var u={d:{f:i,r:function(){throw Error(s(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},f=Symbol.for("react.portal");function h(E,y,S){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:b==null?null:""+b,children:E,containerInfo:y,implementation:S}}var x=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function w(E,y){if(E==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return fn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=u,fn.createPortal=function(E,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(s(299));return h(E,y,null,S)},fn.flushSync=function(E){var y=x.T,S=u.p;try{if(x.T=null,u.p=2,E)return E()}finally{x.T=y,u.p=S,u.d.f()}},fn.preconnect=function(E,y){typeof E=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,u.d.C(E,y))},fn.prefetchDNS=function(E){typeof E=="string"&&u.d.D(E)},fn.preinit=function(E,y){if(typeof E=="string"&&y&&typeof y.as=="string"){var S=y.as,b=w(S,y.crossOrigin),G=typeof y.integrity=="string"?y.integrity:void 0,L=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;S==="style"?u.d.S(E,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:b,integrity:G,fetchPriority:L}):S==="script"&&u.d.X(E,{crossOrigin:b,integrity:G,fetchPriority:L,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},fn.preinitModule=function(E,y){if(typeof E=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var S=w(y.as,y.crossOrigin);u.d.M(E,{crossOrigin:S,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&u.d.M(E)},fn.preload=function(E,y){if(typeof E=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var S=y.as,b=w(S,y.crossOrigin);u.d.L(E,S,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},fn.preloadModule=function(E,y){if(typeof E=="string")if(y){var S=w(y.as,y.crossOrigin);u.d.m(E,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:S,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else u.d.m(E)},fn.requestFormReset=function(E){u.d.r(E)},fn.unstable_batchedUpdates=function(E,y){return E(y)},fn.useFormState=function(E,y,S){return x.H.useFormState(E,y,S)},fn.useFormStatus=function(){return x.H.useHostTransitionStatus()},fn.version="19.2.4",fn}var _m;function qy(){if(_m)return ou.exports;_m=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(s){console.error(s)}}return o(),ou.exports=By(),ou.exports}var Em;function $y(){if(Em)return ji;Em=1;var o=Ly(),s=Tu(),i=qy();function u(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function x(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function w(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function E(e){if(h(e)!==e)throw Error(u(188))}function y(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(u(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(a=r.return,a!==null){n=a;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return E(r),e;if(c===a)return E(r),t;c=c.sibling}throw Error(u(188))}if(n.return!==a.return)n=r,a=c;else{for(var d=!1,p=r.child;p;){if(p===n){d=!0,n=r,a=c;break}if(p===a){d=!0,a=r,n=c;break}p=p.sibling}if(!d){for(p=c.child;p;){if(p===n){d=!0,n=c,a=r;break}if(p===a){d=!0,a=c,n=r;break}p=p.sibling}if(!d)throw Error(u(189))}}if(n.alternate!==a)throw Error(u(190))}if(n.tag!==3)throw Error(u(188));return n.stateNode.current===n?e:t}function S(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=S(e),t!==null)return t;e=e.sibling}return null}var b=Object.assign,G=Symbol.for("react.element"),L=Symbol.for("react.transitional.element"),ce=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),ve=Symbol.for("react.strict_mode"),ge=Symbol.for("react.profiler"),Ee=Symbol.for("react.consumer"),_e=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Re=Symbol.for("react.activity"),Oe=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function ye(e){return e===null||typeof e!="object"?null:(e=$&&e[$]||e["@@iterator"],typeof e=="function"?e:null)}var ee=Symbol.for("react.client.reference");function Se(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ee?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ie:return"Fragment";case ge:return"Profiler";case ve:return"StrictMode";case Te:return"Suspense";case fe:return"SuspenseList";case Re:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case ce:return"Portal";case _e:return e.displayName||"Context";case Ee:return(e._context.displayName||"Context")+".Consumer";case W:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oe:return t=e.displayName||null,t!==null?t:Se(e.type)||"Memo";case Ce:t=e._payload,e=e._init;try{return Se(e(t))}catch{}}return null}var B=Array.isArray,v=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},j=[],se=-1;function g(e){return{current:e}}function T(e){0>se||(e.current=j[se],j[se]=null,se--)}function A(e,t){se++,j[se]=e.current,e.current=t}var X=g(null),me=g(null),we=g(null),qe=g(null);function te(e,t){switch(A(we,t),A(me,e),A(X,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Hh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Hh(t),e=Vh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}T(X),A(X,e)}function de(){T(X),T(me),T(we)}function Xe(e){e.memoizedState!==null&&A(qe,e);var t=X.current,n=Vh(t,e.type);t!==n&&(A(me,e),A(X,n))}function Je(e){me.current===e&&(T(X),T(me)),qe.current===e&&(T(qe),bi._currentValue=Z)}var Ie,vt;function Ot(e){if(Ie===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ie=t&&t[1]||"",vt=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ie+e+vt}var zt=!1;function wt(e,t){if(!e||zt)return"";zt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(K){var F=K}Reflect.construct(e,[],le)}else{try{le.call()}catch(K){F=K}e.call(le.prototype)}}else{try{throw Error()}catch(K){F=K}(le=e())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(K){if(K&&F&&typeof K.stack=="string")return[K.stack,F.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=a.DetermineComponentFrameRoot(),d=c[0],p=c[1];if(d&&p){var N=d.split(`
`),Y=p.split(`
`);for(r=a=0;a<N.length&&!N[a].includes("DetermineComponentFrameRoot");)a++;for(;r<Y.length&&!Y[r].includes("DetermineComponentFrameRoot");)r++;if(a===N.length||r===Y.length)for(a=N.length-1,r=Y.length-1;1<=a&&0<=r&&N[a]!==Y[r];)r--;for(;1<=a&&0<=r;a--,r--)if(N[a]!==Y[r]){if(a!==1||r!==1)do if(a--,r--,0>r||N[a]!==Y[r]){var P=`
`+N[a].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),P}while(1<=a&&0<=r);break}}}finally{zt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Ot(n):""}function Mt(e,t){switch(e.tag){case 26:case 27:case 5:return Ot(e.type);case 16:return Ot("Lazy");case 13:return e.child!==t&&t!==null?Ot("Suspense Fallback"):Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return wt(e.type,!1);case 11:return wt(e.type.render,!1);case 1:return wt(e.type,!0);case 31:return Ot("Activity");default:return""}}function Xt(e){try{var t="",n=null;do t+=Mt(e,n),n=e,e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}var Qt=Object.prototype.hasOwnProperty,Ut=o.unstable_scheduleCallback,un=o.unstable_cancelCallback,On=o.unstable_shouldYield,zn=o.unstable_requestPaint,Ht=o.unstable_now,Qe=o.unstable_getCurrentPriorityLevel,Ft=o.unstable_ImmediatePriority,J=o.unstable_UserBlockingPriority,he=o.unstable_NormalPriority,ke=o.unstable_LowPriority,De=o.unstable_IdlePriority,Me=o.log,Ge=o.unstable_setDisableYieldValue,z=null,U=null;function C(e){if(typeof Me=="function"&&Ge(e),U&&typeof U.setStrictMode=="function")try{U.setStrictMode(z,e)}catch{}}var D=Math.clz32?Math.clz32:be,Q=Math.log,ue=Math.LN2;function be(e){return e>>>=0,e===0?32:31-(Q(e)/ue|0)|0}var je=256,Ne=262144,Le=4194304;function He(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function lt(e,t,n){var a=e.pendingLanes;if(a===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var p=a&134217727;return p!==0?(a=p&~c,a!==0?r=He(a):(d&=p,d!==0?r=He(d):n||(n=p&~e,n!==0&&(r=He(n))))):(p=a&~c,p!==0?r=He(p):d!==0?r=He(d):n||(n=a&~e,n!==0&&(r=He(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function ct(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ye(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tt(){var e=Le;return Le<<=1,(Le&62914560)===0&&(Le=4194304),e}function jt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Lt(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function hn(e,t,n,a,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var p=e.entanglements,N=e.expirationTimes,Y=e.hiddenUpdates;for(n=d&~n;0<n;){var P=31-D(n),le=1<<P;p[P]=0,N[P]=-1;var F=Y[P];if(F!==null)for(Y[P]=null,P=0;P<F.length;P++){var K=F[P];K!==null&&(K.lane&=-536870913)}n&=~le}a!==0&&ha(e,a,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function ha(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-D(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|n&261930}function $a(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-D(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function bn(e,t){var n=t&-t;return n=(n&42)!==0?1:Mn(n),(n&(e.suspendedLanes|t))!==0?0:n}function Mn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Vn(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Gn(){var e=M.p;return e!==0?e:(e=window.event,e===void 0?32:dm(e.type))}function xn(e,t){var n=M.p;try{return M.p=e,t()}finally{M.p=n}}var ut=Math.random().toString(36).slice(2),St="__reactFiber$"+ut,Vt="__reactProps$"+ut,vn="__reactContainer$"+ut,aa="__reactEvents$"+ut,Tl="__reactListeners$"+ut,kl="__reactHandles$"+ut,We="__reactResources$"+ut,Pt="__reactMarker$"+ut;function it(e){delete e[St],delete e[Vt],delete e[aa],delete e[Tl],delete e[kl]}function Yn(e){var t=e[St];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vn]||n[St]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Kh(e);e!==null;){if(n=e[St])return n;e=Kh(e)}return t}e=n,n=e.parentNode}return null}function nn(e){if(e=e[St]||e[vn]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Xn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(u(33))}function sa(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function kt(e){e[Pt]=!0}var la=new Set,Bt={};function ia(e,t){ma(e,t),ma(e+"Capture",t)}function ma(e,t){for(Bt[e]=t,e=0;e<t.length;e++)la.add(t[e])}var ja=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ha={},an={};function ps(e){return Qt.call(an,e)?!0:Qt.call(Ha,e)?!1:ja.test(e)?an[e]=!0:(Ha[e]=!0,!1)}function gs(e,t,n){if(ps(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function pa(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function mn(e,t,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+a)}}function dn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qs(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function eo(e,t,n){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var r=a.get,c=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){n=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(d){n=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ys(e){if(!e._valueTracker){var t=qs(e)?"checked":"value";e._valueTracker=eo(e,t,""+e[t])}}function $s(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=qs(e)?e.checked?"true":"false":e.value),e=a,e!==n?(t.setValue(e),!0):!1}function Va(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var to=/[\n"\\]/g;function wn(e){return e.replace(to,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Al(e,t,n,a,r,c,d,p){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+dn(t)):e.value!==""+dn(t)&&(e.value=""+dn(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?Dl(e,d,dn(t)):n!=null?Dl(e,d,dn(n)):a!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?e.name=""+dn(p):e.removeAttribute("name")}function Ci(e,t,n,a,r,c,d,p){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null)){ys(e);return}n=n!=null?""+dn(n):"",t=t!=null?""+dn(t):n,p||t===e.value||(e.value=t),e.defaultValue=t}a=a??r,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=p?e.checked:!!a,e.defaultChecked=!!a,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d),ys(e)}function Dl(e,t,n){t==="number"&&Va(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ga(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+dn(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,a&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Ol(e,t,n){if(t!=null&&(t=""+dn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+dn(n):""}function Hs(e,t,n,a){if(t==null){if(a!=null){if(n!=null)throw Error(u(92));if(B(a)){if(1<a.length)throw Error(u(93));a=a[0]}n=a}n==null&&(n=""),t=n}n=dn(t),e.defaultValue=n,a=e.textContent,a===n&&a!==""&&a!==null&&(e.value=a),ys(e)}function Ya(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ti(e,t,n){var a=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,n):typeof n!="number"||n===0||zl.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function ki(e,t,n){if(t!=null&&typeof t!="object")throw Error(u(62));if(e=e.style,n!=null){for(var a in n)!n.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var r in t)a=t[r],t.hasOwnProperty(r)&&n[r]!==a&&Ti(e,r,a)}else for(var c in t)t.hasOwnProperty(c)&&Ti(e,c,t[c])}function Ml(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var no=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ao=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vs(e){return ao.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ra(){}var Rl=null;function Ul(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _=null,R=null;function O(e){var t=nn(e);if(t&&(e=t.stateNode)){var n=e[Vt]||null;e:switch(e=t.stateNode,t.type){case"input":if(Al(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+wn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=a[Vt]||null;if(!r)throw Error(u(90));Al(a,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)a=n[t],a.form===e.form&&$s(a)}break e;case"textarea":Ol(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ga(e,!!n.multiple,t,!1)}}}var H=!1;function I(e,t,n){if(H)return e(t,n);H=!0;try{var a=e(t);return a}finally{if(H=!1,(_!==null||R!==null)&&(fr(),_&&(t=_,e=R,R=_=null,O(t),e)))for(t=0;t<e.length;t++)O(e[t])}}function re(e,t){var n=e.stateNode;if(n===null)return null;var a=n[Vt]||null;if(a===null)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(u(231,t,typeof n));return n}var ne=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xe=!1;if(ne)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){xe=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch{xe=!1}var ft=null,ga=null,Sn=null;function jn(){if(Sn)return Sn;var e,t=ga,n=t.length,a,r="value"in ft?ft.value:ft.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(a=1;a<=d&&t[n-a]===r[c-a];a++);return Sn=r.slice(e,1<a?1-a:void 0)}function Nn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function bt(){return!1}function At(e){function t(n,a,r,c,d){this._reactName=n,this._targetInst=r,this.type=a,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(n=e[p],this[p]=n?n(c):c[p]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?bs:bt,this.isPropagationStopped=bt,this}return b(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gs=At(pn),Ll=b({},pn,{view:0,detail:0}),Ap=At(Ll),so,lo,Bl,Ai=b({},Ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ro,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bl&&(Bl&&e.type==="mousemove"?(so=e.screenX-Bl.screenX,lo=e.screenY-Bl.screenY):lo=so=0,Bl=e),so)},movementY:function(e){return"movementY"in e?e.movementY:lo}}),Gu=At(Ai),Dp=b({},Ai,{dataTransfer:0}),Op=At(Dp),zp=b({},Ll,{relatedTarget:0}),io=At(zp),Mp=b({},pn,{animationName:0,elapsedTime:0,pseudoElement:0}),Rp=At(Mp),Up=b({},pn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Lp=At(Up),Bp=b({},pn,{data:0}),Yu=At(Bp),qp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$p={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hp[e])?!!t[e]:!1}function ro(){return Vp}var Gp=b({},Ll,{key:function(e){if(e.key){var t=qp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?$p[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ro,charCode:function(e){return e.type==="keypress"?Nn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Yp=At(Gp),Xp=b({},Ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xu=At(Xp),Qp=b({},Ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ro}),Fp=At(Qp),Zp=b({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kp=At(Zp),Jp=b({},Ai,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ip=At(Jp),Wp=b({},pn,{newState:0,oldState:0}),Pp=At(Wp),eg=[9,13,27,32],oo=ne&&"CompositionEvent"in window,ql=null;ne&&"documentMode"in document&&(ql=document.documentMode);var tg=ne&&"TextEvent"in window&&!ql,Qu=ne&&(!oo||ql&&8<ql&&11>=ql),Fu=" ",Zu=!1;function Ku(e,t){switch(e){case"keyup":return eg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ju(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ys=!1;function ng(e,t){switch(e){case"compositionend":return Ju(t);case"keypress":return t.which!==32?null:(Zu=!0,Fu);case"textInput":return e=t.data,e===Fu&&Zu?null:e;default:return null}}function ag(e,t){if(Ys)return e==="compositionend"||!oo&&Ku(e,t)?(e=jn(),Sn=ga=ft=null,Ys=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qu&&t.locale!=="ko"?null:t.data;default:return null}}var sg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sg[e.type]:t==="textarea"}function Wu(e,t,n,a){_?R?R.push(a):R=[a]:_=a,t=xr(t,"onChange"),0<t.length&&(n=new Gs("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var $l=null,Hl=null;function lg(e){Rh(e,0)}function Di(e){var t=Xn(e);if($s(t))return e}function Pu(e,t){if(e==="change")return t}var ed=!1;if(ne){var co;if(ne){var uo="oninput"in document;if(!uo){var td=document.createElement("div");td.setAttribute("oninput","return;"),uo=typeof td.oninput=="function"}co=uo}else co=!1;ed=co&&(!document.documentMode||9<document.documentMode)}function nd(){$l&&($l.detachEvent("onpropertychange",ad),Hl=$l=null)}function ad(e){if(e.propertyName==="value"&&Di(Hl)){var t=[];Wu(t,Hl,e,Ul(e)),I(lg,t)}}function ig(e,t,n){e==="focusin"?(nd(),$l=t,Hl=n,$l.attachEvent("onpropertychange",ad)):e==="focusout"&&nd()}function rg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Di(Hl)}function og(e,t){if(e==="click")return Di(t)}function cg(e,t){if(e==="input"||e==="change")return Di(t)}function ug(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rn=typeof Object.is=="function"?Object.is:ug;function Vl(e,t){if(Rn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!Qt.call(t,r)||!Rn(e[r],t[r]))return!1}return!0}function sd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ld(e,t){var n=sd(e);e=0;for(var a;n;){if(n.nodeType===3){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sd(n)}}function id(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?id(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Va(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Va(e.document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var dg=ne&&"documentMode"in document&&11>=document.documentMode,Xs=null,ho=null,Gl=null,mo=!1;function od(e,t,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mo||Xs==null||Xs!==Va(a)||(a=Xs,"selectionStart"in a&&fo(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Gl&&Vl(Gl,a)||(Gl=a,a=xr(ho,"onSelect"),0<a.length&&(t=new Gs("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=Xs)))}function xs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Qs={animationend:xs("Animation","AnimationEnd"),animationiteration:xs("Animation","AnimationIteration"),animationstart:xs("Animation","AnimationStart"),transitionrun:xs("Transition","TransitionRun"),transitionstart:xs("Transition","TransitionStart"),transitioncancel:xs("Transition","TransitionCancel"),transitionend:xs("Transition","TransitionEnd")},po={},cd={};ne&&(cd=document.createElement("div").style,"AnimationEvent"in window||(delete Qs.animationend.animation,delete Qs.animationiteration.animation,delete Qs.animationstart.animation),"TransitionEvent"in window||delete Qs.transitionend.transition);function vs(e){if(po[e])return po[e];if(!Qs[e])return e;var t=Qs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in cd)return po[e]=t[n];return e}var ud=vs("animationend"),dd=vs("animationiteration"),fd=vs("animationstart"),fg=vs("transitionrun"),hg=vs("transitionstart"),mg=vs("transitioncancel"),hd=vs("transitionend"),md=new Map,go="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");go.push("scrollEnd");function oa(e,t){md.set(e,t),ia(t,[e])}var Oi=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Qn=[],Fs=0,yo=0;function zi(){for(var e=Fs,t=yo=Fs=0;t<e;){var n=Qn[t];Qn[t++]=null;var a=Qn[t];Qn[t++]=null;var r=Qn[t];Qn[t++]=null;var c=Qn[t];if(Qn[t++]=null,a!==null&&r!==null){var d=a.pending;d===null?r.next=r:(r.next=d.next,d.next=r),a.pending=r}c!==0&&pd(n,r,c)}}function Mi(e,t,n,a){Qn[Fs++]=e,Qn[Fs++]=t,Qn[Fs++]=n,Qn[Fs++]=a,yo|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function bo(e,t,n,a){return Mi(e,t,n,a),Ri(e)}function ws(e,t){return Mi(e,null,null,t),Ri(e)}function pd(e,t,n){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,a=c.alternate,a!==null&&(a.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-D(n),e=c.hiddenUpdates,a=e[r],a===null?e[r]=[t]:a.push(t),t.lane=n|536870912),c):null}function Ri(e){if(50<di)throw di=0,Cc=null,Error(u(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Zs={};function pg(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(e,t,n,a){return new pg(e,t,n,a)}function xo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Na(e,t){var n=e.alternate;return n===null?(n=Un(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function gd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ui(e,t,n,a,r,c){var d=0;if(a=e,typeof e=="function")xo(e)&&(d=1);else if(typeof e=="string")d=vy(e,n,X.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Re:return e=Un(31,n,t,r),e.elementType=Re,e.lanes=c,e;case ie:return Ss(n.children,r,c,t);case ve:d=8,r|=24;break;case ge:return e=Un(12,n,t,r|2),e.elementType=ge,e.lanes=c,e;case Te:return e=Un(13,n,t,r),e.elementType=Te,e.lanes=c,e;case fe:return e=Un(19,n,t,r),e.elementType=fe,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _e:d=10;break e;case Ee:d=9;break e;case W:d=11;break e;case oe:d=14;break e;case Ce:d=16,a=null;break e}d=29,n=Error(u(130,e===null?"null":typeof e,"")),a=null}return t=Un(d,n,t,r),t.elementType=e,t.type=a,t.lanes=c,t}function Ss(e,t,n,a){return e=Un(7,e,a,t),e.lanes=n,e}function vo(e,t,n){return e=Un(6,e,null,t),e.lanes=n,e}function yd(e){var t=Un(18,null,null,0);return t.stateNode=e,t}function wo(e,t,n){return t=Un(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var bd=new WeakMap;function Fn(e,t){if(typeof e=="object"&&e!==null){var n=bd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Xt(t)},bd.set(e,t),t)}return{value:e,source:t,stack:Xt(t)}}var Ks=[],Js=0,Li=null,Yl=0,Zn=[],Kn=0,Xa=null,ya=1,ba="";function _a(e,t){Ks[Js++]=Yl,Ks[Js++]=Li,Li=e,Yl=t}function xd(e,t,n){Zn[Kn++]=ya,Zn[Kn++]=ba,Zn[Kn++]=Xa,Xa=e;var a=ya;e=ba;var r=32-D(a)-1;a&=~(1<<r),n+=1;var c=32-D(t)+r;if(30<c){var d=r-r%5;c=(a&(1<<d)-1).toString(32),a>>=d,r-=d,ya=1<<32-D(t)+r|n<<r|a,ba=c+e}else ya=1<<c|n<<r|a,ba=e}function So(e){e.return!==null&&(_a(e,1),xd(e,1,0))}function jo(e){for(;e===Li;)Li=Ks[--Js],Ks[Js]=null,Yl=Ks[--Js],Ks[Js]=null;for(;e===Xa;)Xa=Zn[--Kn],Zn[Kn]=null,ba=Zn[--Kn],Zn[Kn]=null,ya=Zn[--Kn],Zn[Kn]=null}function vd(e,t){Zn[Kn++]=ya,Zn[Kn++]=ba,Zn[Kn++]=Xa,ya=t.id,ba=t.overflow,Xa=e}var sn=null,Nt=null,at=!1,Qa=null,Jn=!1,No=Error(u(519));function Fa(e){var t=Error(u(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Xl(Fn(t,e)),No}function wd(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[St]=e,t[Vt]=a,n){case"dialog":et("cancel",t),et("close",t);break;case"iframe":case"object":case"embed":et("load",t);break;case"video":case"audio":for(n=0;n<hi.length;n++)et(hi[n],t);break;case"source":et("error",t);break;case"img":case"image":case"link":et("error",t),et("load",t);break;case"details":et("toggle",t);break;case"input":et("invalid",t),Ci(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":et("invalid",t);break;case"textarea":et("invalid",t),Hs(t,a.value,a.defaultValue,a.children)}n=a.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||a.suppressHydrationWarning===!0||qh(t.textContent,n)?(a.popover!=null&&(et("beforetoggle",t),et("toggle",t)),a.onScroll!=null&&et("scroll",t),a.onScrollEnd!=null&&et("scrollend",t),a.onClick!=null&&(t.onclick=ra),t=!0):t=!1,t||Fa(e,!0)}function Sd(e){for(sn=e.return;sn;)switch(sn.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:sn=sn.return}}function Is(e){if(e!==sn)return!1;if(!at)return Sd(e),at=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Vc(e.type,e.memoizedProps)),n=!n),n&&Nt&&Fa(e),Sd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(317));Nt=Zh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(317));Nt=Zh(e)}else t===27?(t=Nt,rs(e.type)?(e=Fc,Fc=null,Nt=e):Nt=t):Nt=sn?Wn(e.stateNode.nextSibling):null;return!0}function js(){Nt=sn=null,at=!1}function _o(){var e=Qa;return e!==null&&(Tn===null?Tn=e:Tn.push.apply(Tn,e),Qa=null),e}function Xl(e){Qa===null?Qa=[e]:Qa.push(e)}var Eo=g(null),Ns=null,Ea=null;function Za(e,t,n){A(Eo,t._currentValue),t._currentValue=n}function Ca(e){e._currentValue=Eo.current,T(Eo)}function Co(e,t,n){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function To(e,t,n,a){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var p=c;c=r;for(var N=0;N<t.length;N++)if(p.context===t[N]){c.lanes|=n,p=c.alternate,p!==null&&(p.lanes|=n),Co(c.return,n,e),a||(d=null);break e}c=p.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(u(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),Co(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function Ws(e,t,n,a){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(u(387));if(d=d.memoizedProps,d!==null){var p=r.type;Rn(r.pendingProps.value,d.value)||(e!==null?e.push(p):e=[p])}}else if(r===qe.current){if(d=r.alternate,d===null)throw Error(u(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(bi):e=[bi])}r=r.return}e!==null&&To(t,e,n,a),t.flags|=262144}function Bi(e){for(e=e.firstContext;e!==null;){if(!Rn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _s(e){Ns=e,Ea=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ln(e){return jd(Ns,e)}function qi(e,t){return Ns===null&&_s(e),jd(e,t)}function jd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ea===null){if(e===null)throw Error(u(308));Ea=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ea=Ea.next=t;return n}var gg=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},yg=o.unstable_scheduleCallback,bg=o.unstable_NormalPriority,Zt={$$typeof:_e,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ko(){return{controller:new gg,data:new Map,refCount:0}}function Ql(e){e.refCount--,e.refCount===0&&yg(bg,function(){e.controller.abort()})}var Fl=null,Ao=0,Ps=0,el=null;function xg(e,t){if(Fl===null){var n=Fl=[];Ao=0,Ps=zc(),el={status:"pending",value:void 0,then:function(a){n.push(a)}}}return Ao++,t.then(Nd,Nd),t}function Nd(){if(--Ao===0&&Fl!==null){el!==null&&(el.status="fulfilled");var e=Fl;Fl=null,Ps=0,el=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function vg(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(a.status="rejected",a.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),a}var _d=v.S;v.S=function(e,t){ch=Ht(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&xg(e,t),_d!==null&&_d(e,t)};var Es=g(null);function Do(){var e=Es.current;return e!==null?e:xt.pooledCache}function $i(e,t){t===null?A(Es,Es.current):A(Es,t.pool)}function Ed(){var e=Do();return e===null?null:{parent:Zt._currentValue,pool:e}}var tl=Error(u(460)),Oo=Error(u(474)),Hi=Error(u(542)),Vi={then:function(){}};function Cd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Td(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(ra,ra),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ad(e),e;default:if(typeof t.status=="string")t.then(ra,ra);else{if(e=xt,e!==null&&100<e.shellSuspendCounter)throw Error(u(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=a}},function(a){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ad(e),e}throw Ts=t,tl}}function Cs(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Ts=n,tl):n}}var Ts=null;function kd(){if(Ts===null)throw Error(u(459));var e=Ts;return Ts=null,e}function Ad(e){if(e===tl||e===Hi)throw Error(u(483))}var nl=null,Zl=0;function Gi(e){var t=Zl;return Zl+=1,nl===null&&(nl=[]),Td(nl,e,t)}function Kl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Yi(e,t){throw t.$$typeof===G?Error(u(525)):(e=Object.prototype.toString.call(t),Error(u(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Dd(e){function t(q,k){if(e){var V=q.deletions;V===null?(q.deletions=[k],q.flags|=16):V.push(k)}}function n(q,k){if(!e)return null;for(;k!==null;)t(q,k),k=k.sibling;return null}function a(q){for(var k=new Map;q!==null;)q.key!==null?k.set(q.key,q):k.set(q.index,q),q=q.sibling;return k}function r(q,k){return q=Na(q,k),q.index=0,q.sibling=null,q}function c(q,k,V){return q.index=V,e?(V=q.alternate,V!==null?(V=V.index,V<k?(q.flags|=67108866,k):V):(q.flags|=67108866,k)):(q.flags|=1048576,k)}function d(q){return e&&q.alternate===null&&(q.flags|=67108866),q}function p(q,k,V,ae){return k===null||k.tag!==6?(k=vo(V,q.mode,ae),k.return=q,k):(k=r(k,V),k.return=q,k)}function N(q,k,V,ae){var $e=V.type;return $e===ie?P(q,k,V.props.children,ae,V.key):k!==null&&(k.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Ce&&Cs($e)===k.type)?(k=r(k,V.props),Kl(k,V),k.return=q,k):(k=Ui(V.type,V.key,V.props,null,q.mode,ae),Kl(k,V),k.return=q,k)}function Y(q,k,V,ae){return k===null||k.tag!==4||k.stateNode.containerInfo!==V.containerInfo||k.stateNode.implementation!==V.implementation?(k=wo(V,q.mode,ae),k.return=q,k):(k=r(k,V.children||[]),k.return=q,k)}function P(q,k,V,ae,$e){return k===null||k.tag!==7?(k=Ss(V,q.mode,ae,$e),k.return=q,k):(k=r(k,V),k.return=q,k)}function le(q,k,V){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return k=vo(""+k,q.mode,V),k.return=q,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case L:return V=Ui(k.type,k.key,k.props,null,q.mode,V),Kl(V,k),V.return=q,V;case ce:return k=wo(k,q.mode,V),k.return=q,k;case Ce:return k=Cs(k),le(q,k,V)}if(B(k)||ye(k))return k=Ss(k,q.mode,V,null),k.return=q,k;if(typeof k.then=="function")return le(q,Gi(k),V);if(k.$$typeof===_e)return le(q,qi(q,k),V);Yi(q,k)}return null}function F(q,k,V,ae){var $e=k!==null?k.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return $e!==null?null:p(q,k,""+V,ae);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case L:return V.key===$e?N(q,k,V,ae):null;case ce:return V.key===$e?Y(q,k,V,ae):null;case Ce:return V=Cs(V),F(q,k,V,ae)}if(B(V)||ye(V))return $e!==null?null:P(q,k,V,ae,null);if(typeof V.then=="function")return F(q,k,Gi(V),ae);if(V.$$typeof===_e)return F(q,k,qi(q,V),ae);Yi(q,V)}return null}function K(q,k,V,ae,$e){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return q=q.get(V)||null,p(k,q,""+ae,$e);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case L:return q=q.get(ae.key===null?V:ae.key)||null,N(k,q,ae,$e);case ce:return q=q.get(ae.key===null?V:ae.key)||null,Y(k,q,ae,$e);case Ce:return ae=Cs(ae),K(q,k,V,ae,$e)}if(B(ae)||ye(ae))return q=q.get(V)||null,P(k,q,ae,$e,null);if(typeof ae.then=="function")return K(q,k,V,Gi(ae),$e);if(ae.$$typeof===_e)return K(q,k,V,qi(k,ae),$e);Yi(k,ae)}return null}function ze(q,k,V,ae){for(var $e=null,rt=null,Ue=k,Ke=k=0,nt=null;Ue!==null&&Ke<V.length;Ke++){Ue.index>Ke?(nt=Ue,Ue=null):nt=Ue.sibling;var ot=F(q,Ue,V[Ke],ae);if(ot===null){Ue===null&&(Ue=nt);break}e&&Ue&&ot.alternate===null&&t(q,Ue),k=c(ot,k,Ke),rt===null?$e=ot:rt.sibling=ot,rt=ot,Ue=nt}if(Ke===V.length)return n(q,Ue),at&&_a(q,Ke),$e;if(Ue===null){for(;Ke<V.length;Ke++)Ue=le(q,V[Ke],ae),Ue!==null&&(k=c(Ue,k,Ke),rt===null?$e=Ue:rt.sibling=Ue,rt=Ue);return at&&_a(q,Ke),$e}for(Ue=a(Ue);Ke<V.length;Ke++)nt=K(Ue,q,Ke,V[Ke],ae),nt!==null&&(e&&nt.alternate!==null&&Ue.delete(nt.key===null?Ke:nt.key),k=c(nt,k,Ke),rt===null?$e=nt:rt.sibling=nt,rt=nt);return e&&Ue.forEach(function(fs){return t(q,fs)}),at&&_a(q,Ke),$e}function Ve(q,k,V,ae){if(V==null)throw Error(u(151));for(var $e=null,rt=null,Ue=k,Ke=k=0,nt=null,ot=V.next();Ue!==null&&!ot.done;Ke++,ot=V.next()){Ue.index>Ke?(nt=Ue,Ue=null):nt=Ue.sibling;var fs=F(q,Ue,ot.value,ae);if(fs===null){Ue===null&&(Ue=nt);break}e&&Ue&&fs.alternate===null&&t(q,Ue),k=c(fs,k,Ke),rt===null?$e=fs:rt.sibling=fs,rt=fs,Ue=nt}if(ot.done)return n(q,Ue),at&&_a(q,Ke),$e;if(Ue===null){for(;!ot.done;Ke++,ot=V.next())ot=le(q,ot.value,ae),ot!==null&&(k=c(ot,k,Ke),rt===null?$e=ot:rt.sibling=ot,rt=ot);return at&&_a(q,Ke),$e}for(Ue=a(Ue);!ot.done;Ke++,ot=V.next())ot=K(Ue,q,Ke,ot.value,ae),ot!==null&&(e&&ot.alternate!==null&&Ue.delete(ot.key===null?Ke:ot.key),k=c(ot,k,Ke),rt===null?$e=ot:rt.sibling=ot,rt=ot);return e&&Ue.forEach(function(Dy){return t(q,Dy)}),at&&_a(q,Ke),$e}function yt(q,k,V,ae){if(typeof V=="object"&&V!==null&&V.type===ie&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case L:e:{for(var $e=V.key;k!==null;){if(k.key===$e){if($e=V.type,$e===ie){if(k.tag===7){n(q,k.sibling),ae=r(k,V.props.children),ae.return=q,q=ae;break e}}else if(k.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Ce&&Cs($e)===k.type){n(q,k.sibling),ae=r(k,V.props),Kl(ae,V),ae.return=q,q=ae;break e}n(q,k);break}else t(q,k);k=k.sibling}V.type===ie?(ae=Ss(V.props.children,q.mode,ae,V.key),ae.return=q,q=ae):(ae=Ui(V.type,V.key,V.props,null,q.mode,ae),Kl(ae,V),ae.return=q,q=ae)}return d(q);case ce:e:{for($e=V.key;k!==null;){if(k.key===$e)if(k.tag===4&&k.stateNode.containerInfo===V.containerInfo&&k.stateNode.implementation===V.implementation){n(q,k.sibling),ae=r(k,V.children||[]),ae.return=q,q=ae;break e}else{n(q,k);break}else t(q,k);k=k.sibling}ae=wo(V,q.mode,ae),ae.return=q,q=ae}return d(q);case Ce:return V=Cs(V),yt(q,k,V,ae)}if(B(V))return ze(q,k,V,ae);if(ye(V)){if($e=ye(V),typeof $e!="function")throw Error(u(150));return V=$e.call(V),Ve(q,k,V,ae)}if(typeof V.then=="function")return yt(q,k,Gi(V),ae);if(V.$$typeof===_e)return yt(q,k,qi(q,V),ae);Yi(q,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,k!==null&&k.tag===6?(n(q,k.sibling),ae=r(k,V),ae.return=q,q=ae):(n(q,k),ae=vo(V,q.mode,ae),ae.return=q,q=ae),d(q)):n(q,k)}return function(q,k,V,ae){try{Zl=0;var $e=yt(q,k,V,ae);return nl=null,$e}catch(Ue){if(Ue===tl||Ue===Hi)throw Ue;var rt=Un(29,Ue,null,q.mode);return rt.lanes=ae,rt.return=q,rt}}}var ks=Dd(!0),Od=Dd(!1),Ka=!1;function zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Mo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ja(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ia(e,t,n){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(dt&2)!==0){var r=a.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=Ri(e),pd(e,null,n),t}return Mi(e,a,t,n),Ri(e)}function Jl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,$a(e,n)}}function Ro(e,t){var n=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:a.shared,callbacks:a.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Uo=!1;function Il(){if(Uo){var e=el;if(e!==null)throw e}}function Wl(e,t,n,a){Uo=!1;var r=e.updateQueue;Ka=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,p=r.shared.pending;if(p!==null){r.shared.pending=null;var N=p,Y=N.next;N.next=null,d===null?c=Y:d.next=Y,d=N;var P=e.alternate;P!==null&&(P=P.updateQueue,p=P.lastBaseUpdate,p!==d&&(p===null?P.firstBaseUpdate=Y:p.next=Y,P.lastBaseUpdate=N))}if(c!==null){var le=r.baseState;d=0,P=Y=N=null,p=c;do{var F=p.lane&-536870913,K=F!==p.lane;if(K?(tt&F)===F:(a&F)===F){F!==0&&F===Ps&&(Uo=!0),P!==null&&(P=P.next={lane:0,tag:p.tag,payload:p.payload,callback:null,next:null});e:{var ze=e,Ve=p;F=t;var yt=n;switch(Ve.tag){case 1:if(ze=Ve.payload,typeof ze=="function"){le=ze.call(yt,le,F);break e}le=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ve.payload,F=typeof ze=="function"?ze.call(yt,le,F):ze,F==null)break e;le=b({},le,F);break e;case 2:Ka=!0}}F=p.callback,F!==null&&(e.flags|=64,K&&(e.flags|=8192),K=r.callbacks,K===null?r.callbacks=[F]:K.push(F))}else K={lane:F,tag:p.tag,payload:p.payload,callback:p.callback,next:null},P===null?(Y=P=K,N=le):P=P.next=K,d|=F;if(p=p.next,p===null){if(p=r.shared.pending,p===null)break;K=p,p=K.next,K.next=null,r.lastBaseUpdate=K,r.shared.pending=null}}while(!0);P===null&&(N=le),r.baseState=N,r.firstBaseUpdate=Y,r.lastBaseUpdate=P,c===null&&(r.shared.lanes=0),ns|=d,e.lanes=d,e.memoizedState=le}}function zd(e,t){if(typeof e!="function")throw Error(u(191,e));e.call(t)}function Md(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)zd(n[e],t)}var al=g(null),Xi=g(0);function Rd(e,t){e=Ua,A(Xi,e),A(al,t),Ua=e|t.baseLanes}function Lo(){A(Xi,Ua),A(al,al.current)}function Bo(){Ua=Xi.current,T(al),T(Xi)}var Ln=g(null),In=null;function Wa(e){var t=e.alternate;A(Gt,Gt.current&1),A(Ln,e),In===null&&(t===null||al.current!==null||t.memoizedState!==null)&&(In=e)}function qo(e){A(Gt,Gt.current),A(Ln,e),In===null&&(In=e)}function Ud(e){e.tag===22?(A(Gt,Gt.current),A(Ln,e),In===null&&(In=e)):Pa()}function Pa(){A(Gt,Gt.current),A(Ln,Ln.current)}function Bn(e){T(Ln),In===e&&(In=null),T(Gt)}var Gt=g(0);function Qi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Xc(n)||Qc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ta=0,Ze=null,pt=null,Kt=null,Fi=!1,sl=!1,As=!1,Zi=0,Pl=0,ll=null,wg=0;function qt(){throw Error(u(321))}function $o(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Rn(e[n],t[n]))return!1;return!0}function Ho(e,t,n,a,r,c){return Ta=c,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,v.H=e===null||e.memoizedState===null?vf:nc,As=!1,c=n(a,r),As=!1,sl&&(c=Bd(t,n,a,r)),Ld(e),c}function Ld(e){v.H=ni;var t=pt!==null&&pt.next!==null;if(Ta=0,Kt=pt=Ze=null,Fi=!1,Pl=0,ll=null,t)throw Error(u(300));e===null||Jt||(e=e.dependencies,e!==null&&Bi(e)&&(Jt=!0))}function Bd(e,t,n,a){Ze=e;var r=0;do{if(sl&&(ll=null),Pl=0,sl=!1,25<=r)throw Error(u(301));if(r+=1,Kt=pt=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}v.H=wf,c=t(n,a)}while(sl);return c}function Sg(){var e=v.H,t=e.useState()[0];return t=typeof t.then=="function"?ei(t):t,e=e.useState()[0],(pt!==null?pt.memoizedState:null)!==e&&(Ze.flags|=1024),t}function Vo(){var e=Zi!==0;return Zi=0,e}function Go(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Yo(e){if(Fi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Fi=!1}Ta=0,Kt=pt=Ze=null,sl=!1,Pl=Zi=0,ll=null}function gn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?Ze.memoizedState=Kt=e:Kt=Kt.next=e,Kt}function Yt(){if(pt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var t=Kt===null?Ze.memoizedState:Kt.next;if(t!==null)Kt=t,pt=e;else{if(e===null)throw Ze.alternate===null?Error(u(467)):Error(u(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Kt===null?Ze.memoizedState=Kt=e:Kt=Kt.next=e}return Kt}function Ki(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ei(e){var t=Pl;return Pl+=1,ll===null&&(ll=[]),e=Td(ll,e,t),t=Ze,(Kt===null?t.memoizedState:Kt.next)===null&&(t=t.alternate,v.H=t===null||t.memoizedState===null?vf:nc),e}function Ji(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return ei(e);if(e.$$typeof===_e)return ln(e)}throw Error(u(438,String(e)))}function Xo(e){var t=null,n=Ze.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var a=Ze.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Ki(),Ze.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=Oe;return t.index++,n}function ka(e,t){return typeof t=="function"?t(e):t}function Ii(e){var t=Yt();return Qo(t,pt,e)}function Qo(e,t,n){var a=e.queue;if(a===null)throw Error(u(311));a.lastRenderedReducer=n;var r=e.baseQueue,c=a.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,a.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var p=d=null,N=null,Y=t,P=!1;do{var le=Y.lane&-536870913;if(le!==Y.lane?(tt&le)===le:(Ta&le)===le){var F=Y.revertLane;if(F===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),le===Ps&&(P=!0);else if((Ta&F)===F){Y=Y.next,F===Ps&&(P=!0);continue}else le={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},N===null?(p=N=le,d=c):N=N.next=le,Ze.lanes|=F,ns|=F;le=Y.action,As&&n(c,le),c=Y.hasEagerState?Y.eagerState:n(c,le)}else F={lane:le,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},N===null?(p=N=F,d=c):N=N.next=F,Ze.lanes|=le,ns|=le;Y=Y.next}while(Y!==null&&Y!==t);if(N===null?d=c:N.next=p,!Rn(c,e.memoizedState)&&(Jt=!0,P&&(n=el,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=N,a.lastRenderedState=c}return r===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Fo(e){var t=Yt(),n=t.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);Rn(c,t.memoizedState)||(Jt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,a]}function qd(e,t,n){var a=Ze,r=Yt(),c=at;if(c){if(n===void 0)throw Error(u(407));n=n()}else n=t();var d=!Rn((pt||r).memoizedState,n);if(d&&(r.memoizedState=n,Jt=!0),r=r.queue,Jo(Vd.bind(null,a,r,e),[e]),r.getSnapshot!==t||d||Kt!==null&&Kt.memoizedState.tag&1){if(a.flags|=2048,il(9,{destroy:void 0},Hd.bind(null,a,r,n,t),null),xt===null)throw Error(u(349));c||(Ta&127)!==0||$d(a,t,n)}return n}function $d(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ze.updateQueue,t===null?(t=Ki(),Ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Hd(e,t,n,a){t.value=n,t.getSnapshot=a,Gd(t)&&Yd(e)}function Vd(e,t,n){return n(function(){Gd(t)&&Yd(e)})}function Gd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Rn(e,n)}catch{return!0}}function Yd(e){var t=ws(e,2);t!==null&&kn(t,e,2)}function Zo(e){var t=gn();if(typeof e=="function"){var n=e;if(e=n(),As){C(!0);try{n()}finally{C(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},t}function Xd(e,t,n,a){return e.baseState=n,Qo(e,pt,typeof a=="function"?a:ka)}function jg(e,t,n,a,r){if(er(e))throw Error(u(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};v.T!==null?n(!0):c.isTransition=!1,a(c),n=t.pending,n===null?(c.next=t.pending=c,Qd(t,c)):(c.next=n.next,t.pending=n.next=c)}}function Qd(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var c=v.T,d={};v.T=d;try{var p=n(r,a),N=v.S;N!==null&&N(d,p),Fd(e,t,p)}catch(Y){Ko(e,t,Y)}finally{c!==null&&d.types!==null&&(c.types=d.types),v.T=c}}else try{c=n(r,a),Fd(e,t,c)}catch(Y){Ko(e,t,Y)}}function Fd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(a){Zd(e,t,a)},function(a){return Ko(e,t,a)}):Zd(e,t,n)}function Zd(e,t,n){t.status="fulfilled",t.value=n,Kd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Qd(e,n)))}function Ko(e,t,n){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=n,Kd(t),t=t.next;while(t!==a)}e.action=null}function Kd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Jd(e,t){return t}function Id(e,t){if(at){var n=xt.formState;if(n!==null){e:{var a=Ze;if(at){if(Nt){t:{for(var r=Nt,c=Jn;r.nodeType!==8;){if(!c){r=null;break t}if(r=Wn(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){Nt=Wn(r.nextSibling),a=r.data==="F!";break e}}Fa(a)}a=!1}a&&(t=n[0])}}return n=gn(),n.memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jd,lastRenderedState:t},n.queue=a,n=yf.bind(null,Ze,a),a.dispatch=n,a=Zo(!1),c=tc.bind(null,Ze,!1,a.queue),a=gn(),r={state:t,dispatch:null,action:e,pending:null},a.queue=r,n=jg.bind(null,Ze,r,c,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function Wd(e){var t=Yt();return Pd(t,pt,e)}function Pd(e,t,n){if(t=Qo(e,t,Jd)[0],e=Ii(ka)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=ei(t)}catch(d){throw d===tl?Hi:d}else a=t;t=Yt();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(Ze.flags|=2048,il(9,{destroy:void 0},Ng.bind(null,r,n),null)),[a,c,e]}function Ng(e,t){e.action=t}function ef(e){var t=Yt(),n=pt;if(n!==null)return Pd(t,n,e);Yt(),t=t.memoizedState,n=Yt();var a=n.queue.dispatch;return n.memoizedState=e,[t,a,!1]}function il(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},t=Ze.updateQueue,t===null&&(t=Ki(),Ze.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function tf(){return Yt().memoizedState}function Wi(e,t,n,a){var r=gn();Ze.flags|=e,r.memoizedState=il(1|t,{destroy:void 0},n,a===void 0?null:a)}function Pi(e,t,n,a){var r=Yt();a=a===void 0?null:a;var c=r.memoizedState.inst;pt!==null&&a!==null&&$o(a,pt.memoizedState.deps)?r.memoizedState=il(t,c,n,a):(Ze.flags|=e,r.memoizedState=il(1|t,c,n,a))}function nf(e,t){Wi(8390656,8,e,t)}function Jo(e,t){Pi(2048,8,e,t)}function _g(e){Ze.flags|=4;var t=Ze.updateQueue;if(t===null)t=Ki(),Ze.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function af(e){var t=Yt().memoizedState;return _g({ref:t,nextImpl:e}),function(){if((dt&2)!==0)throw Error(u(440));return t.impl.apply(void 0,arguments)}}function sf(e,t){return Pi(4,2,e,t)}function lf(e,t){return Pi(4,4,e,t)}function rf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function of(e,t,n){n=n!=null?n.concat([e]):null,Pi(4,4,rf.bind(null,t,e),n)}function Io(){}function cf(e,t){var n=Yt();t=t===void 0?null:t;var a=n.memoizedState;return t!==null&&$o(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function uf(e,t){var n=Yt();t=t===void 0?null:t;var a=n.memoizedState;if(t!==null&&$o(t,a[1]))return a[0];if(a=e(),As){C(!0);try{e()}finally{C(!1)}}return n.memoizedState=[a,t],a}function Wo(e,t,n){return n===void 0||(Ta&1073741824)!==0&&(tt&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=dh(),Ze.lanes|=e,ns|=e,n)}function df(e,t,n,a){return Rn(n,t)?n:al.current!==null?(e=Wo(e,n,a),Rn(e,t)||(Jt=!0),e):(Ta&42)===0||(Ta&1073741824)!==0&&(tt&261930)===0?(Jt=!0,e.memoizedState=n):(e=dh(),Ze.lanes|=e,ns|=e,t)}function ff(e,t,n,a,r){var c=M.p;M.p=c!==0&&8>c?c:8;var d=v.T,p={};v.T=p,tc(e,!1,t,n);try{var N=r(),Y=v.S;if(Y!==null&&Y(p,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var P=vg(N,a);ti(e,t,P,Hn(e))}else ti(e,t,a,Hn(e))}catch(le){ti(e,t,{then:function(){},status:"rejected",reason:le},Hn())}finally{M.p=c,d!==null&&p.types!==null&&(d.types=p.types),v.T=d}}function Eg(){}function Po(e,t,n,a){if(e.tag!==5)throw Error(u(476));var r=hf(e).queue;ff(e,r,t,Z,n===null?Eg:function(){return mf(e),n(a)})}function hf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:Z},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function mf(e){var t=hf(e);t.next===null&&(t=e.alternate.memoizedState),ti(e,t.next.queue,{},Hn())}function ec(){return ln(bi)}function pf(){return Yt().memoizedState}function gf(){return Yt().memoizedState}function Cg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Hn();e=Ja(n);var a=Ia(t,e,n);a!==null&&(kn(a,t,n),Jl(a,t,n)),t={cache:ko()},e.payload=t;return}t=t.return}}function Tg(e,t,n){var a=Hn();n={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},er(e)?bf(t,n):(n=bo(e,t,n,a),n!==null&&(kn(n,e,a),xf(n,t,a)))}function yf(e,t,n){var a=Hn();ti(e,t,n,a)}function ti(e,t,n,a){var r={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(er(e))bf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,p=c(d,n);if(r.hasEagerState=!0,r.eagerState=p,Rn(p,d))return Mi(e,t,r,0),xt===null&&zi(),!1}catch{}if(n=bo(e,t,r,a),n!==null)return kn(n,e,a),xf(n,t,a),!0}return!1}function tc(e,t,n,a){if(a={lane:2,revertLane:zc(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},er(e)){if(t)throw Error(u(479))}else t=bo(e,n,a,2),t!==null&&kn(t,e,2)}function er(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function bf(e,t){sl=Fi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xf(e,t,n){if((n&4194048)!==0){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,$a(e,n)}}var ni={readContext:ln,use:Ji,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useLayoutEffect:qt,useInsertionEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useSyncExternalStore:qt,useId:qt,useHostTransitionStatus:qt,useFormState:qt,useActionState:qt,useOptimistic:qt,useMemoCache:qt,useCacheRefresh:qt};ni.useEffectEvent=qt;var vf={readContext:ln,use:Ji,useCallback:function(e,t){return gn().memoizedState=[e,t===void 0?null:t],e},useContext:ln,useEffect:nf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Wi(4194308,4,rf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wi(4194308,4,e,t)},useInsertionEffect:function(e,t){Wi(4,2,e,t)},useMemo:function(e,t){var n=gn();t=t===void 0?null:t;var a=e();if(As){C(!0);try{e()}finally{C(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=gn();if(n!==void 0){var r=n(t);if(As){C(!0);try{n(t)}finally{C(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=Tg.bind(null,Ze,e),[a.memoizedState,e]},useRef:function(e){var t=gn();return e={current:e},t.memoizedState=e},useState:function(e){e=Zo(e);var t=e.queue,n=yf.bind(null,Ze,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Io,useDeferredValue:function(e,t){var n=gn();return Wo(n,e,t)},useTransition:function(){var e=Zo(!1);return e=ff.bind(null,Ze,e.queue,!0,!1),gn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Ze,r=gn();if(at){if(n===void 0)throw Error(u(407));n=n()}else{if(n=t(),xt===null)throw Error(u(349));(tt&127)!==0||$d(a,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,nf(Vd.bind(null,a,c,e),[e]),a.flags|=2048,il(9,{destroy:void 0},Hd.bind(null,a,c,n,t),null),n},useId:function(){var e=gn(),t=xt.identifierPrefix;if(at){var n=ba,a=ya;n=(a&~(1<<32-D(a)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Zi++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=wg++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ec,useFormState:Id,useActionState:Id,useOptimistic:function(e){var t=gn();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=tc.bind(null,Ze,!0,n),n.dispatch=t,[e,t]},useMemoCache:Xo,useCacheRefresh:function(){return gn().memoizedState=Cg.bind(null,Ze)},useEffectEvent:function(e){var t=gn(),n={impl:e};return t.memoizedState=n,function(){if((dt&2)!==0)throw Error(u(440));return n.impl.apply(void 0,arguments)}}},nc={readContext:ln,use:Ji,useCallback:cf,useContext:ln,useEffect:Jo,useImperativeHandle:of,useInsertionEffect:sf,useLayoutEffect:lf,useMemo:uf,useReducer:Ii,useRef:tf,useState:function(){return Ii(ka)},useDebugValue:Io,useDeferredValue:function(e,t){var n=Yt();return df(n,pt.memoizedState,e,t)},useTransition:function(){var e=Ii(ka)[0],t=Yt().memoizedState;return[typeof e=="boolean"?e:ei(e),t]},useSyncExternalStore:qd,useId:pf,useHostTransitionStatus:ec,useFormState:Wd,useActionState:Wd,useOptimistic:function(e,t){var n=Yt();return Xd(n,pt,e,t)},useMemoCache:Xo,useCacheRefresh:gf};nc.useEffectEvent=af;var wf={readContext:ln,use:Ji,useCallback:cf,useContext:ln,useEffect:Jo,useImperativeHandle:of,useInsertionEffect:sf,useLayoutEffect:lf,useMemo:uf,useReducer:Fo,useRef:tf,useState:function(){return Fo(ka)},useDebugValue:Io,useDeferredValue:function(e,t){var n=Yt();return pt===null?Wo(n,e,t):df(n,pt.memoizedState,e,t)},useTransition:function(){var e=Fo(ka)[0],t=Yt().memoizedState;return[typeof e=="boolean"?e:ei(e),t]},useSyncExternalStore:qd,useId:pf,useHostTransitionStatus:ec,useFormState:ef,useActionState:ef,useOptimistic:function(e,t){var n=Yt();return pt!==null?Xd(n,pt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Xo,useCacheRefresh:gf};wf.useEffectEvent=af;function ac(e,t,n,a){t=e.memoizedState,n=n(a,t),n=n==null?t:b({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var sc={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Hn(),r=Ja(a);r.payload=t,n!=null&&(r.callback=n),t=Ia(e,r,a),t!==null&&(kn(t,e,a),Jl(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Hn(),r=Ja(a);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=Ia(e,r,a),t!==null&&(kn(t,e,a),Jl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Hn(),a=Ja(n);a.tag=2,t!=null&&(a.callback=t),t=Ia(e,a,n),t!==null&&(kn(t,e,n),Jl(t,e,n))}};function Sf(e,t,n,a,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,c,d):t.prototype&&t.prototype.isPureReactComponent?!Vl(n,a)||!Vl(r,c):!0}function jf(e,t,n,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&sc.enqueueReplaceState(t,t.state,null)}function Ds(e,t){var n=t;if("ref"in t){n={};for(var a in t)a!=="ref"&&(n[a]=t[a])}if(e=e.defaultProps){n===t&&(n=b({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}function Nf(e){Oi(e)}function _f(e){console.error(e)}function Ef(e){Oi(e)}function tr(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function Cf(e,t,n){try{var a=e.onCaughtError;a(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function lc(e,t,n){return n=Ja(n),n.tag=3,n.payload={element:null},n.callback=function(){tr(e,t)},n}function Tf(e){return e=Ja(e),e.tag=3,e}function kf(e,t,n,a){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=a.value;e.payload=function(){return r(c)},e.callback=function(){Cf(t,n,a)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Cf(t,n,a),typeof r!="function"&&(as===null?as=new Set([this]):as.add(this));var p=a.stack;this.componentDidCatch(a.value,{componentStack:p!==null?p:""})})}function kg(e,t,n,a,r){if(n.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=n.alternate,t!==null&&Ws(t,n,r,!0),n=Ln.current,n!==null){switch(n.tag){case 31:case 13:return In===null?hr():n.alternate===null&&$t===0&&($t=3),n.flags&=-257,n.flags|=65536,n.lanes=r,a===Vi?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([a]):t.add(a),Ac(e,a,r)),!1;case 22:return n.flags|=65536,a===Vi?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([a]):n.add(a)),Ac(e,a,r)),!1}throw Error(u(435,n.tag))}return Ac(e,a,r),hr(),!1}if(at)return t=Ln.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,a!==No&&(e=Error(u(422),{cause:a}),Xl(Fn(e,n)))):(a!==No&&(t=Error(u(423),{cause:a}),Xl(Fn(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,a=Fn(a,n),r=lc(e.stateNode,a,r),Ro(e,r),$t!==4&&($t=2)),!1;var c=Error(u(520),{cause:a});if(c=Fn(c,n),ui===null?ui=[c]:ui.push(c),$t!==4&&($t=2),t===null)return!0;a=Fn(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=lc(n.stateNode,a,e),Ro(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(as===null||!as.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Tf(r),kf(r,e,n,a),Ro(n,r),!1}n=n.return}while(n!==null);return!1}var ic=Error(u(461)),Jt=!1;function rn(e,t,n,a){t.child=e===null?Od(t,null,n,a):ks(t,e.child,n,a)}function Af(e,t,n,a,r){n=n.render;var c=t.ref;if("ref"in a){var d={};for(var p in a)p!=="ref"&&(d[p]=a[p])}else d=a;return _s(t),a=Ho(e,t,n,d,c,r),p=Vo(),e!==null&&!Jt?(Go(e,t,r),Aa(e,t,r)):(at&&p&&So(t),t.flags|=1,rn(e,t,a,r),t.child)}function Df(e,t,n,a,r){if(e===null){var c=n.type;return typeof c=="function"&&!xo(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,Of(e,t,c,a,r)):(e=Ui(n.type,null,a,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!mc(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:Vl,n(d,a)&&e.ref===t.ref)return Aa(e,t,r)}return t.flags|=1,e=Na(c,a),e.ref=t.ref,e.return=t,t.child=e}function Of(e,t,n,a,r){if(e!==null){var c=e.memoizedProps;if(Vl(c,a)&&e.ref===t.ref)if(Jt=!1,t.pendingProps=a=c,mc(e,r))(e.flags&131072)!==0&&(Jt=!0);else return t.lanes=e.lanes,Aa(e,t,r)}return rc(e,t,n,a,r)}function zf(e,t,n,a){var r=a.children,c=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.mode==="hidden"){if((t.flags&128)!==0){if(c=c!==null?c.baseLanes|n:n,e!==null){for(a=t.child=e.child,r=0;a!==null;)r=r|a.lanes|a.childLanes,a=a.sibling;a=r&~c}else a=0,t.child=null;return Mf(e,t,c,n,a)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&$i(t,c!==null?c.cachePool:null),c!==null?Rd(t,c):Lo(),Ud(t);else return a=t.lanes=536870912,Mf(e,t,c!==null?c.baseLanes|n:n,n,a)}else c!==null?($i(t,c.cachePool),Rd(t,c),Pa(),t.memoizedState=null):(e!==null&&$i(t,null),Lo(),Pa());return rn(e,t,r,n),t.child}function ai(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Mf(e,t,n,a,r){var c=Do();return c=c===null?null:{parent:Zt._currentValue,pool:c},t.memoizedState={baseLanes:n,cachePool:c},e!==null&&$i(t,null),Lo(),Ud(t),e!==null&&Ws(e,t,a,!0),t.childLanes=r,null}function nr(e,t){return t=sr({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Rf(e,t,n){return ks(t,e.child,null,n),e=nr(t,t.pendingProps),e.flags|=2,Bn(t),t.memoizedState=null,e}function Ag(e,t,n){var a=t.pendingProps,r=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(at){if(a.mode==="hidden")return e=nr(t,a),t.lanes=536870912,ai(null,e);if(qo(t),(e=Nt)?(e=Fh(e,Jn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Xa!==null?{id:ya,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},n=yd(e),n.return=t,t.child=n,sn=t,Nt=null)):e=null,e===null)throw Fa(t);return t.lanes=536870912,null}return nr(t,a)}var c=e.memoizedState;if(c!==null){var d=c.dehydrated;if(qo(t),r)if(t.flags&256)t.flags&=-257,t=Rf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(u(558));else if(Jt||Ws(e,t,n,!1),r=(n&e.childLanes)!==0,Jt||r){if(a=xt,a!==null&&(d=bn(a,n),d!==0&&d!==c.retryLane))throw c.retryLane=d,ws(e,d),kn(a,e,d),ic;hr(),t=Rf(e,t,n)}else e=c.treeContext,Nt=Wn(d.nextSibling),sn=t,at=!0,Qa=null,Jn=!1,e!==null&&vd(t,e),t=nr(t,a),t.flags|=4096;return t}return e=Na(e.child,{mode:a.mode,children:a.children}),e.ref=t.ref,t.child=e,e.return=t,e}function ar(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(u(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function rc(e,t,n,a,r){return _s(t),n=Ho(e,t,n,a,void 0,r),a=Vo(),e!==null&&!Jt?(Go(e,t,r),Aa(e,t,r)):(at&&a&&So(t),t.flags|=1,rn(e,t,n,r),t.child)}function Uf(e,t,n,a,r,c){return _s(t),t.updateQueue=null,n=Bd(t,a,n,r),Ld(e),a=Vo(),e!==null&&!Jt?(Go(e,t,c),Aa(e,t,c)):(at&&a&&So(t),t.flags|=1,rn(e,t,n,c),t.child)}function Lf(e,t,n,a,r){if(_s(t),t.stateNode===null){var c=Zs,d=n.contextType;typeof d=="object"&&d!==null&&(c=ln(d)),c=new n(a,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=sc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=a,c.state=t.memoizedState,c.refs={},zo(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?ln(d):Zs,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(ac(t,n,d,a),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&sc.enqueueReplaceState(c,c.state,null),Wl(t,a,c,r),Il(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){c=t.stateNode;var p=t.memoizedProps,N=Ds(n,p);c.props=N;var Y=c.context,P=n.contextType;d=Zs,typeof P=="object"&&P!==null&&(d=ln(P));var le=n.getDerivedStateFromProps;P=typeof le=="function"||typeof c.getSnapshotBeforeUpdate=="function",p=t.pendingProps!==p,P||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(p||Y!==d)&&jf(t,c,a,d),Ka=!1;var F=t.memoizedState;c.state=F,Wl(t,a,c,r),Il(),Y=t.memoizedState,p||F!==Y||Ka?(typeof le=="function"&&(ac(t,n,le,a),Y=t.memoizedState),(N=Ka||Sf(t,n,N,a,F,Y,d))?(P||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=Y),c.props=a,c.state=Y,c.context=d,a=N):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{c=t.stateNode,Mo(e,t),d=t.memoizedProps,P=Ds(n,d),c.props=P,le=t.pendingProps,F=c.context,Y=n.contextType,N=Zs,typeof Y=="object"&&Y!==null&&(N=ln(Y)),p=n.getDerivedStateFromProps,(Y=typeof p=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==le||F!==N)&&jf(t,c,a,N),Ka=!1,F=t.memoizedState,c.state=F,Wl(t,a,c,r),Il();var K=t.memoizedState;d!==le||F!==K||Ka||e!==null&&e.dependencies!==null&&Bi(e.dependencies)?(typeof p=="function"&&(ac(t,n,p,a),K=t.memoizedState),(P=Ka||Sf(t,n,P,a,F,K,N)||e!==null&&e.dependencies!==null&&Bi(e.dependencies))?(Y||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(a,K,N),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(a,K,N)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=K),c.props=a,c.state=K,c.context=N,a=P):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),a=!1)}return c=a,ar(e,t),a=(t.flags&128)!==0,c||a?(c=t.stateNode,n=a&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&a?(t.child=ks(t,e.child,null,r),t.child=ks(t,null,n,r)):rn(e,t,n,r),t.memoizedState=c.state,e=t.child):e=Aa(e,t,r),e}function Bf(e,t,n,a){return js(),t.flags|=256,rn(e,t,n,a),t.child}var oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cc(e){return{baseLanes:e,cachePool:Ed()}}function uc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=$n),e}function qf(e,t,n){var a=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(Gt.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(at){if(r?Wa(t):Pa(),(e=Nt)?(e=Fh(e,Jn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Xa!==null?{id:ya,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},n=yd(e),n.return=t,t.child=n,sn=t,Nt=null)):e=null,e===null)throw Fa(t);return Qc(e)?t.lanes=32:t.lanes=536870912,null}var p=a.children;return a=a.fallback,r?(Pa(),r=t.mode,p=sr({mode:"hidden",children:p},r),a=Ss(a,r,n,null),p.return=t,a.return=t,p.sibling=a,t.child=p,a=t.child,a.memoizedState=cc(n),a.childLanes=uc(e,d,n),t.memoizedState=oc,ai(null,a)):(Wa(t),dc(t,p))}var N=e.memoizedState;if(N!==null&&(p=N.dehydrated,p!==null)){if(c)t.flags&256?(Wa(t),t.flags&=-257,t=fc(e,t,n)):t.memoizedState!==null?(Pa(),t.child=e.child,t.flags|=128,t=null):(Pa(),p=a.fallback,r=t.mode,a=sr({mode:"visible",children:a.children},r),p=Ss(p,r,n,null),p.flags|=2,a.return=t,p.return=t,a.sibling=p,t.child=a,ks(t,e.child,null,n),a=t.child,a.memoizedState=cc(n),a.childLanes=uc(e,d,n),t.memoizedState=oc,t=ai(null,a));else if(Wa(t),Qc(p)){if(d=p.nextSibling&&p.nextSibling.dataset,d)var Y=d.dgst;d=Y,a=Error(u(419)),a.stack="",a.digest=d,Xl({value:a,source:null,stack:null}),t=fc(e,t,n)}else if(Jt||Ws(e,t,n,!1),d=(n&e.childLanes)!==0,Jt||d){if(d=xt,d!==null&&(a=bn(d,n),a!==0&&a!==N.retryLane))throw N.retryLane=a,ws(e,a),kn(d,e,a),ic;Xc(p)||hr(),t=fc(e,t,n)}else Xc(p)?(t.flags|=192,t.child=e.child,t=null):(e=N.treeContext,Nt=Wn(p.nextSibling),sn=t,at=!0,Qa=null,Jn=!1,e!==null&&vd(t,e),t=dc(t,a.children),t.flags|=4096);return t}return r?(Pa(),p=a.fallback,r=t.mode,N=e.child,Y=N.sibling,a=Na(N,{mode:"hidden",children:a.children}),a.subtreeFlags=N.subtreeFlags&65011712,Y!==null?p=Na(Y,p):(p=Ss(p,r,n,null),p.flags|=2),p.return=t,a.return=t,a.sibling=p,t.child=a,ai(null,a),a=t.child,p=e.child.memoizedState,p===null?p=cc(n):(r=p.cachePool,r!==null?(N=Zt._currentValue,r=r.parent!==N?{parent:N,pool:N}:r):r=Ed(),p={baseLanes:p.baseLanes|n,cachePool:r}),a.memoizedState=p,a.childLanes=uc(e,d,n),t.memoizedState=oc,ai(e.child,a)):(Wa(t),n=e.child,e=n.sibling,n=Na(n,{mode:"visible",children:a.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function dc(e,t){return t=sr({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function sr(e,t){return e=Un(22,e,null,t),e.lanes=0,e}function fc(e,t,n){return ks(t,e.child,null,n),e=dc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $f(e,t,n){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Co(e.return,t,n)}function hc(e,t,n,a,r,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r,treeForkCount:c}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=a,d.tail=n,d.tailMode=r,d.treeForkCount=c)}function Hf(e,t,n){var a=t.pendingProps,r=a.revealOrder,c=a.tail;a=a.children;var d=Gt.current,p=(d&2)!==0;if(p?(d=d&1|2,t.flags|=128):d&=1,A(Gt,d),rn(e,t,a,n),a=at?Yl:0,!p&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$f(e,n,t);else if(e.tag===19)$f(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&Qi(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),hc(t,!1,r,n,c,a);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Qi(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}hc(t,!0,n,null,c,a);break;case"together":hc(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function Aa(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ns|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ws(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(u(153));if(t.child!==null){for(e=t.child,n=Na(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Na(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function mc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Bi(e)))}function Dg(e,t,n){switch(t.tag){case 3:te(t,t.stateNode.containerInfo),Za(t,Zt,e.memoizedState.cache),js();break;case 27:case 5:Xe(t);break;case 4:te(t,t.stateNode.containerInfo);break;case 10:Za(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,qo(t),null;break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(Wa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?qf(e,t,n):(Wa(t),e=Aa(e,t,n),e!==null?e.sibling:null);Wa(t);break;case 19:var r=(e.flags&128)!==0;if(a=(n&t.childLanes)!==0,a||(Ws(e,t,n,!1),a=(n&t.childLanes)!==0),r){if(a)return Hf(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),A(Gt,Gt.current),a)break;return null;case 22:return t.lanes=0,zf(e,t,n,t.pendingProps);case 24:Za(t,Zt,e.memoizedState.cache)}return Aa(e,t,n)}function Vf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Jt=!0;else{if(!mc(e,n)&&(t.flags&128)===0)return Jt=!1,Dg(e,t,n);Jt=(e.flags&131072)!==0}else Jt=!1,at&&(t.flags&1048576)!==0&&xd(t,Yl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=Cs(t.elementType),t.type=e,typeof e=="function")xo(e)?(a=Ds(e,a),t.tag=1,t=Lf(null,t,e,a,n)):(t.tag=0,t=rc(null,t,e,a,n));else{if(e!=null){var r=e.$$typeof;if(r===W){t.tag=11,t=Af(null,t,e,a,n);break e}else if(r===oe){t.tag=14,t=Df(null,t,e,a,n);break e}}throw t=Se(e)||e,Error(u(306,t,""))}}return t;case 0:return rc(e,t,t.type,t.pendingProps,n);case 1:return a=t.type,r=Ds(a,t.pendingProps),Lf(e,t,a,r,n);case 3:e:{if(te(t,t.stateNode.containerInfo),e===null)throw Error(u(387));a=t.pendingProps;var c=t.memoizedState;r=c.element,Mo(e,t),Wl(t,a,null,n);var d=t.memoizedState;if(a=d.cache,Za(t,Zt,a),a!==c.cache&&To(t,[Zt],n,!0),Il(),a=d.element,c.isDehydrated)if(c={element:a,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=Bf(e,t,a,n);break e}else if(a!==r){r=Fn(Error(u(424)),t),Xl(r),t=Bf(e,t,a,n);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Nt=Wn(e.firstChild),sn=t,at=!0,Qa=null,Jn=!0,n=Od(t,null,a,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(js(),a===r){t=Aa(e,t,n);break e}rn(e,t,a,n)}t=t.child}return t;case 26:return ar(e,t),e===null?(n=Ph(t.type,null,t.pendingProps,null))?t.memoizedState=n:at||(n=t.type,e=t.pendingProps,a=vr(we.current).createElement(n),a[St]=t,a[Vt]=e,on(a,n,e),kt(a),t.stateNode=a):t.memoizedState=Ph(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Xe(t),e===null&&at&&(a=t.stateNode=Jh(t.type,t.pendingProps,we.current),sn=t,Jn=!0,r=Nt,rs(t.type)?(Fc=r,Nt=Wn(a.firstChild)):Nt=r),rn(e,t,t.pendingProps.children,n),ar(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&at&&((r=a=Nt)&&(a=ry(a,t.type,t.pendingProps,Jn),a!==null?(t.stateNode=a,sn=t,Nt=Wn(a.firstChild),Jn=!1,r=!0):r=!1),r||Fa(t)),Xe(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,a=c.children,Vc(r,c)?a=null:d!==null&&Vc(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Ho(e,t,Sg,null,null,n),bi._currentValue=r),ar(e,t),rn(e,t,a,n),t.child;case 6:return e===null&&at&&((e=n=Nt)&&(n=oy(n,t.pendingProps,Jn),n!==null?(t.stateNode=n,sn=t,Nt=null,e=!0):e=!1),e||Fa(t)),null;case 13:return qf(e,t,n);case 4:return te(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=ks(t,null,a,n):rn(e,t,a,n),t.child;case 11:return Af(e,t,t.type,t.pendingProps,n);case 7:return rn(e,t,t.pendingProps,n),t.child;case 8:return rn(e,t,t.pendingProps.children,n),t.child;case 12:return rn(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,Za(t,t.type,a.value),rn(e,t,a.children,n),t.child;case 9:return r=t.type._context,a=t.pendingProps.children,_s(t),r=ln(r),a=a(r),t.flags|=1,rn(e,t,a,n),t.child;case 14:return Df(e,t,t.type,t.pendingProps,n);case 15:return Of(e,t,t.type,t.pendingProps,n);case 19:return Hf(e,t,n);case 31:return Ag(e,t,n);case 22:return zf(e,t,n,t.pendingProps);case 24:return _s(t),a=ln(Zt),e===null?(r=Do(),r===null&&(r=xt,c=ko(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:a,cache:r},zo(t),Za(t,Zt,r)):((e.lanes&n)!==0&&(Mo(e,t),Wl(t,null,null,n),Il()),r=e.memoizedState,c=t.memoizedState,r.parent!==a?(r={parent:a,cache:a},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),Za(t,Zt,a)):(a=c.cache,Za(t,Zt,a),a!==r.cache&&To(t,[Zt],n,!0))),rn(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(u(156,t.tag))}function Da(e){e.flags|=4}function pc(e,t,n,a,r){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(r&335544128)===r)if(e.stateNode.complete)e.flags|=8192;else if(ph())e.flags|=8192;else throw Ts=Vi,Oo}else e.flags&=-16777217}function Gf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!sm(t))if(ph())e.flags|=8192;else throw Ts=Vi,Oo}function lr(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Tt():536870912,e.lanes|=t,ul|=t)}function si(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function _t(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags&65011712,a|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Og(e,t,n){var a=t.pendingProps;switch(jo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(t),null;case 1:return _t(t),null;case 3:return n=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ca(Zt),de(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Is(t)?Da(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_o())),_t(t),null;case 26:var r=t.type,c=t.memoizedState;return e===null?(Da(t),c!==null?(_t(t),Gf(t,c)):(_t(t),pc(t,r,null,a,n))):c?c!==e.memoizedState?(Da(t),_t(t),Gf(t,c)):(_t(t),t.flags&=-16777217):(e=e.memoizedProps,e!==a&&Da(t),_t(t),pc(t,r,e,a,n)),null;case 27:if(Je(t),n=we.current,r=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&Da(t);else{if(!a){if(t.stateNode===null)throw Error(u(166));return _t(t),null}e=X.current,Is(t)?wd(t):(e=Jh(r,a,n),t.stateNode=e,Da(t))}return _t(t),null;case 5:if(Je(t),r=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&Da(t);else{if(!a){if(t.stateNode===null)throw Error(u(166));return _t(t),null}if(c=X.current,Is(t))wd(t);else{var d=vr(we.current);switch(c){case 1:c=d.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:c=d.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":c=d.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":c=d.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":c=d.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof a.is=="string"?d.createElement("select",{is:a.is}):d.createElement("select"),a.multiple?c.multiple=!0:a.size&&(c.size=a.size);break;default:c=typeof a.is=="string"?d.createElement(r,{is:a.is}):d.createElement(r)}}c[St]=t,c[Vt]=a;e:for(d=t.child;d!==null;){if(d.tag===5||d.tag===6)c.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}t.stateNode=c;e:switch(on(c,r,a),r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Da(t)}}return _t(t),pc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&Da(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(u(166));if(e=we.current,Is(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,r=sn,r!==null)switch(r.tag){case 27:case 5:a=r.memoizedProps}e[St]=t,e=!!(e.nodeValue===n||a!==null&&a.suppressHydrationWarning===!0||qh(e.nodeValue,n)),e||Fa(t,!0)}else e=vr(e).createTextNode(a),e[St]=t,t.stateNode=e}return _t(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(a=Is(t),n!==null){if(e===null){if(!a)throw Error(u(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(557));e[St]=t}else js(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;_t(t),e=!1}else n=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(Bn(t),t):(Bn(t),null);if((t.flags&128)!==0)throw Error(u(558))}return _t(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Is(t),a!==null&&a.dehydrated!==null){if(e===null){if(!r)throw Error(u(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(u(317));r[St]=t}else js(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;_t(t),r=!1}else r=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(Bn(t),t):(Bn(t),null)}return Bn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=a!==null,e=e!==null&&e.memoizedState!==null,n&&(a=t.child,r=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(r=a.alternate.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==r&&(a.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),lr(t,t.updateQueue),_t(t),null);case 4:return de(),e===null&&Lc(t.stateNode.containerInfo),_t(t),null;case 10:return Ca(t.type),_t(t),null;case 19:if(T(Gt),a=t.memoizedState,a===null)return _t(t),null;if(r=(t.flags&128)!==0,c=a.rendering,c===null)if(r)si(a,!1);else{if($t!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=Qi(e),c!==null){for(t.flags|=128,si(a,!1),e=c.updateQueue,t.updateQueue=e,lr(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)gd(n,e),n=n.sibling;return A(Gt,Gt.current&1|2),at&&_a(t,a.treeForkCount),t.child}e=e.sibling}a.tail!==null&&Ht()>ur&&(t.flags|=128,r=!0,si(a,!1),t.lanes=4194304)}else{if(!r)if(e=Qi(c),e!==null){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,lr(t,e),si(a,!0),a.tail===null&&a.tailMode==="hidden"&&!c.alternate&&!at)return _t(t),null}else 2*Ht()-a.renderingStartTime>ur&&n!==536870912&&(t.flags|=128,r=!0,si(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(e=a.last,e!==null?e.sibling=c:t.child=c,a.last=c)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ht(),e.sibling=null,n=Gt.current,A(Gt,r?n&1|2:n&1),at&&_a(t,a.treeForkCount),e):(_t(t),null);case 22:case 23:return Bn(t),Bo(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?(n&536870912)!==0&&(t.flags&128)===0&&(_t(t),t.subtreeFlags&6&&(t.flags|=8192)):_t(t),n=t.updateQueue,n!==null&&lr(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),e!==null&&T(Es),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ca(Zt),_t(t),null;case 25:return null;case 30:return null}throw Error(u(156,t.tag))}function zg(e,t){switch(jo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ca(Zt),de(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Je(t),null;case 31:if(t.memoizedState!==null){if(Bn(t),t.alternate===null)throw Error(u(340));js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Bn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(u(340));js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return T(Gt),null;case 4:return de(),null;case 10:return Ca(t.type),null;case 22:case 23:return Bn(t),Bo(),e!==null&&T(Es),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ca(Zt),null;case 25:return null;default:return null}}function Yf(e,t){switch(jo(t),t.tag){case 3:Ca(Zt),de();break;case 26:case 27:case 5:Je(t);break;case 4:de();break;case 31:t.memoizedState!==null&&Bn(t);break;case 13:Bn(t);break;case 19:T(Gt);break;case 10:Ca(t.type);break;case 22:case 23:Bn(t),Bo(),e!==null&&T(Es);break;case 24:Ca(Zt)}}function li(e,t){try{var n=t.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var c=n.create,d=n.inst;a=c(),d.destroy=a}n=n.next}while(n!==r)}}catch(p){mt(t,t.return,p)}}function es(e,t,n){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var c=r.next;a=c;do{if((a.tag&e)===e){var d=a.inst,p=d.destroy;if(p!==void 0){d.destroy=void 0,r=t;var N=n,Y=p;try{Y()}catch(P){mt(r,N,P)}}}a=a.next}while(a!==c)}}catch(P){mt(t,t.return,P)}}function Xf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Md(t,n)}catch(a){mt(e,e.return,a)}}}function Qf(e,t,n){n.props=Ds(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){mt(e,t,a)}}function ii(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof n=="function"?e.refCleanup=n(a):n.current=a}}catch(r){mt(e,t,r)}}function xa(e,t){var n=e.ref,a=e.refCleanup;if(n!==null)if(typeof a=="function")try{a()}catch(r){mt(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){mt(e,t,r)}else n.current=null}function Ff(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){mt(e,e.return,r)}}function gc(e,t,n){try{var a=e.stateNode;ty(a,e.type,n,t),a[Vt]=t}catch(r){mt(e,e.return,r)}}function Zf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&rs(e.type)||e.tag===4}function yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&rs(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bc(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ra));else if(a!==4&&(a===27&&rs(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(bc(e,t,n),e=e.sibling;e!==null;)bc(e,t,n),e=e.sibling}function ir(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(a!==4&&(a===27&&rs(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(ir(e,t,n),e=e.sibling;e!==null;)ir(e,t,n),e=e.sibling}function Kf(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);on(t,a,n),t[St]=e,t[Vt]=n}catch(c){mt(e,e.return,c)}}var Oa=!1,It=!1,xc=!1,Jf=typeof WeakSet=="function"?WeakSet:Set,tn=null;function Mg(e,t){if(e=e.containerInfo,$c=Cr,e=rd(e),fo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var r=a.anchorOffset,c=a.focusNode;a=a.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,p=-1,N=-1,Y=0,P=0,le=e,F=null;t:for(;;){for(var K;le!==n||r!==0&&le.nodeType!==3||(p=d+r),le!==c||a!==0&&le.nodeType!==3||(N=d+a),le.nodeType===3&&(d+=le.nodeValue.length),(K=le.firstChild)!==null;)F=le,le=K;for(;;){if(le===e)break t;if(F===n&&++Y===r&&(p=d),F===c&&++P===a&&(N=d),(K=le.nextSibling)!==null)break;le=F,F=le.parentNode}le=K}n=p===-1||N===-1?null:{start:p,end:N}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hc={focusedElem:e,selectionRange:n},Cr=!1,tn=t;tn!==null;)if(t=tn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,tn=e;else for(;tn!==null;){switch(t=tn,c=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)r=e[n],r.ref.impl=r.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,a=n.stateNode;try{var ze=Ds(n.type,r);e=a.getSnapshotBeforeUpdate(ze,c),a.__reactInternalSnapshotBeforeUpdate=e}catch(Ve){mt(n,n.return,Ve)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Yc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Yc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(u(163))}if(e=t.sibling,e!==null){e.return=t.return,tn=e;break}tn=t.return}}function If(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Ma(e,n),a&4&&li(5,n);break;case 1:if(Ma(e,n),a&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){mt(n,n.return,d)}else{var r=Ds(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){mt(n,n.return,d)}}a&64&&Xf(n),a&512&&ii(n,n.return);break;case 3:if(Ma(e,n),a&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Md(e,t)}catch(d){mt(n,n.return,d)}}break;case 27:t===null&&a&4&&Kf(n);case 26:case 5:Ma(e,n),t===null&&a&4&&Ff(n),a&512&&ii(n,n.return);break;case 12:Ma(e,n);break;case 31:Ma(e,n),a&4&&eh(e,n);break;case 13:Ma(e,n),a&4&&th(e,n),a&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Gg.bind(null,n),cy(e,n))));break;case 22:if(a=n.memoizedState!==null||Oa,!a){t=t!==null&&t.memoizedState!==null||It,r=Oa;var c=It;Oa=a,(It=t)&&!c?Ra(e,n,(n.subtreeFlags&8772)!==0):Ma(e,n),Oa=r,It=c}break;case 30:break;default:Ma(e,n)}}function Wf(e){var t=e.alternate;t!==null&&(e.alternate=null,Wf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&it(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Dt=null,_n=!1;function za(e,t,n){for(n=n.child;n!==null;)Pf(e,t,n),n=n.sibling}function Pf(e,t,n){if(U&&typeof U.onCommitFiberUnmount=="function")try{U.onCommitFiberUnmount(z,n)}catch{}switch(n.tag){case 26:It||xa(n,t),za(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:It||xa(n,t);var a=Dt,r=_n;rs(n.type)&&(Dt=n.stateNode,_n=!1),za(e,t,n),pi(n.stateNode),Dt=a,_n=r;break;case 5:It||xa(n,t);case 6:if(a=Dt,r=_n,Dt=null,za(e,t,n),Dt=a,_n=r,Dt!==null)if(_n)try{(Dt.nodeType===9?Dt.body:Dt.nodeName==="HTML"?Dt.ownerDocument.body:Dt).removeChild(n.stateNode)}catch(c){mt(n,t,c)}else try{Dt.removeChild(n.stateNode)}catch(c){mt(n,t,c)}break;case 18:Dt!==null&&(_n?(e=Dt,Xh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),bl(e)):Xh(Dt,n.stateNode));break;case 4:a=Dt,r=_n,Dt=n.stateNode.containerInfo,_n=!0,za(e,t,n),Dt=a,_n=r;break;case 0:case 11:case 14:case 15:es(2,n,t),It||es(4,n,t),za(e,t,n);break;case 1:It||(xa(n,t),a=n.stateNode,typeof a.componentWillUnmount=="function"&&Qf(n,t,a)),za(e,t,n);break;case 21:za(e,t,n);break;case 22:It=(a=It)||n.memoizedState!==null,za(e,t,n),It=a;break;default:za(e,t,n)}}function eh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{bl(e)}catch(n){mt(t,t.return,n)}}}function th(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{bl(e)}catch(n){mt(t,t.return,n)}}function Rg(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Jf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Jf),t;default:throw Error(u(435,e.tag))}}function rr(e,t){var n=Rg(e);t.forEach(function(a){if(!n.has(a)){n.add(a);var r=Yg.bind(null,e,a);a.then(r,r)}})}function En(e,t){var n=t.deletions;if(n!==null)for(var a=0;a<n.length;a++){var r=n[a],c=e,d=t,p=d;e:for(;p!==null;){switch(p.tag){case 27:if(rs(p.type)){Dt=p.stateNode,_n=!1;break e}break;case 5:Dt=p.stateNode,_n=!1;break e;case 3:case 4:Dt=p.stateNode.containerInfo,_n=!0;break e}p=p.return}if(Dt===null)throw Error(u(160));Pf(c,d,r),Dt=null,_n=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)nh(t,e),t=t.sibling}var ca=null;function nh(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:En(t,e),Cn(e),a&4&&(es(3,e,e.return),li(3,e),es(5,e,e.return));break;case 1:En(t,e),Cn(e),a&512&&(It||n===null||xa(n,n.return)),a&64&&Oa&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?a:n.concat(a))));break;case 26:var r=ca;if(En(t,e),Cn(e),a&512&&(It||n===null||xa(n,n.return)),a&4){var c=n!==null?n.memoizedState:null;if(a=e.memoizedState,n===null)if(a===null)if(e.stateNode===null){e:{a=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(a){case"title":c=r.getElementsByTagName("title")[0],(!c||c[Pt]||c[St]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(a),r.head.insertBefore(c,r.querySelector("head > title"))),on(c,a,n),c[St]=e,kt(c),a=c;break e;case"link":var d=nm("link","href",r).get(a+(n.href||""));if(d){for(var p=0;p<d.length;p++)if(c=d[p],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(p,1);break t}}c=r.createElement(a),on(c,a,n),r.head.appendChild(c);break;case"meta":if(d=nm("meta","content",r).get(a+(n.content||""))){for(p=0;p<d.length;p++)if(c=d[p],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(p,1);break t}}c=r.createElement(a),on(c,a,n),r.head.appendChild(c);break;default:throw Error(u(468,a))}c[St]=e,kt(c),a=c}e.stateNode=a}else am(r,e.type,e.stateNode);else e.stateNode=tm(r,a,e.memoizedProps);else c!==a?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,a===null?am(r,e.type,e.stateNode):tm(r,a,e.memoizedProps)):a===null&&e.stateNode!==null&&gc(e,e.memoizedProps,n.memoizedProps)}break;case 27:En(t,e),Cn(e),a&512&&(It||n===null||xa(n,n.return)),n!==null&&a&4&&gc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(En(t,e),Cn(e),a&512&&(It||n===null||xa(n,n.return)),e.flags&32){r=e.stateNode;try{Ya(r,"")}catch(ze){mt(e,e.return,ze)}}a&4&&e.stateNode!=null&&(r=e.memoizedProps,gc(e,r,n!==null?n.memoizedProps:r)),a&1024&&(xc=!0);break;case 6:if(En(t,e),Cn(e),a&4){if(e.stateNode===null)throw Error(u(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(ze){mt(e,e.return,ze)}}break;case 3:if(jr=null,r=ca,ca=wr(t.containerInfo),En(t,e),ca=r,Cn(e),a&4&&n!==null&&n.memoizedState.isDehydrated)try{bl(t.containerInfo)}catch(ze){mt(e,e.return,ze)}xc&&(xc=!1,ah(e));break;case 4:a=ca,ca=wr(e.stateNode.containerInfo),En(t,e),Cn(e),ca=a;break;case 12:En(t,e),Cn(e);break;case 31:En(t,e),Cn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,rr(e,a)));break;case 13:En(t,e),Cn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(cr=Ht()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,rr(e,a)));break;case 22:r=e.memoizedState!==null;var N=n!==null&&n.memoizedState!==null,Y=Oa,P=It;if(Oa=Y||r,It=P||N,En(t,e),It=P,Oa=Y,Cn(e),a&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||N||Oa||It||Os(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){N=n=t;try{if(c=N.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{p=N.stateNode;var le=N.memoizedProps.style,F=le!=null&&le.hasOwnProperty("display")?le.display:null;p.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(ze){mt(N,N.return,ze)}}}else if(t.tag===6){if(n===null){N=t;try{N.stateNode.nodeValue=r?"":N.memoizedProps}catch(ze){mt(N,N.return,ze)}}}else if(t.tag===18){if(n===null){N=t;try{var K=N.stateNode;r?Qh(K,!0):Qh(N.stateNode,!1)}catch(ze){mt(N,N.return,ze)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(n=a.retryQueue,n!==null&&(a.retryQueue=null,rr(e,n))));break;case 19:En(t,e),Cn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,rr(e,a)));break;case 30:break;case 21:break;default:En(t,e),Cn(e)}}function Cn(e){var t=e.flags;if(t&2){try{for(var n,a=e.return;a!==null;){if(Zf(a)){n=a;break}a=a.return}if(n==null)throw Error(u(160));switch(n.tag){case 27:var r=n.stateNode,c=yc(e);ir(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(Ya(d,""),n.flags&=-33);var p=yc(e);ir(e,p,d);break;case 3:case 4:var N=n.stateNode.containerInfo,Y=yc(e);bc(e,Y,N);break;default:throw Error(u(161))}}catch(P){mt(e,e.return,P)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ah(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;ah(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ma(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)If(e,t.alternate,t),t=t.sibling}function Os(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:es(4,t,t.return),Os(t);break;case 1:xa(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Qf(t,t.return,n),Os(t);break;case 27:pi(t.stateNode);case 26:case 5:xa(t,t.return),Os(t);break;case 22:t.memoizedState===null&&Os(t);break;case 30:Os(t);break;default:Os(t)}e=e.sibling}}function Ra(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:Ra(r,c,n),li(4,c);break;case 1:if(Ra(r,c,n),a=c,r=a.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(Y){mt(a,a.return,Y)}if(a=c,r=a.updateQueue,r!==null){var p=a.stateNode;try{var N=r.shared.hiddenCallbacks;if(N!==null)for(r.shared.hiddenCallbacks=null,r=0;r<N.length;r++)zd(N[r],p)}catch(Y){mt(a,a.return,Y)}}n&&d&64&&Xf(c),ii(c,c.return);break;case 27:Kf(c);case 26:case 5:Ra(r,c,n),n&&a===null&&d&4&&Ff(c),ii(c,c.return);break;case 12:Ra(r,c,n);break;case 31:Ra(r,c,n),n&&d&4&&eh(r,c);break;case 13:Ra(r,c,n),n&&d&4&&th(r,c);break;case 22:c.memoizedState===null&&Ra(r,c,n),ii(c,c.return);break;case 30:break;default:Ra(r,c,n)}t=t.sibling}}function vc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Ql(n))}function wc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ql(e))}function ua(e,t,n,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)sh(e,t,n,a),t=t.sibling}function sh(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:ua(e,t,n,a),r&2048&&li(9,t);break;case 1:ua(e,t,n,a);break;case 3:ua(e,t,n,a),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ql(e)));break;case 12:if(r&2048){ua(e,t,n,a),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,p=c.onPostCommit;typeof p=="function"&&p(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){mt(t,t.return,N)}}else ua(e,t,n,a);break;case 31:ua(e,t,n,a);break;case 13:ua(e,t,n,a);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?ua(e,t,n,a):ri(e,t):c._visibility&2?ua(e,t,n,a):(c._visibility|=2,rl(e,t,n,a,(t.subtreeFlags&10256)!==0||!1)),r&2048&&vc(d,t);break;case 24:ua(e,t,n,a),r&2048&&wc(t.alternate,t);break;default:ua(e,t,n,a)}}function rl(e,t,n,a,r){for(r=r&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var c=e,d=t,p=n,N=a,Y=d.flags;switch(d.tag){case 0:case 11:case 15:rl(c,d,p,N,r),li(8,d);break;case 23:break;case 22:var P=d.stateNode;d.memoizedState!==null?P._visibility&2?rl(c,d,p,N,r):ri(c,d):(P._visibility|=2,rl(c,d,p,N,r)),r&&Y&2048&&vc(d.alternate,d);break;case 24:rl(c,d,p,N,r),r&&Y&2048&&wc(d.alternate,d);break;default:rl(c,d,p,N,r)}t=t.sibling}}function ri(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:ri(n,a),r&2048&&vc(a.alternate,a);break;case 24:ri(n,a),r&2048&&wc(a.alternate,a);break;default:ri(n,a)}t=t.sibling}}var oi=8192;function ol(e,t,n){if(e.subtreeFlags&oi)for(e=e.child;e!==null;)lh(e,t,n),e=e.sibling}function lh(e,t,n){switch(e.tag){case 26:ol(e,t,n),e.flags&oi&&e.memoizedState!==null&&wy(n,ca,e.memoizedState,e.memoizedProps);break;case 5:ol(e,t,n);break;case 3:case 4:var a=ca;ca=wr(e.stateNode.containerInfo),ol(e,t,n),ca=a;break;case 22:e.memoizedState===null&&(a=e.alternate,a!==null&&a.memoizedState!==null?(a=oi,oi=16777216,ol(e,t,n),oi=a):ol(e,t,n));break;default:ol(e,t,n)}}function ih(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function ci(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];tn=a,oh(a,e)}ih(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)rh(e),e=e.sibling}function rh(e){switch(e.tag){case 0:case 11:case 15:ci(e),e.flags&2048&&es(9,e,e.return);break;case 3:ci(e);break;case 12:ci(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,or(e)):ci(e);break;default:ci(e)}}function or(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];tn=a,oh(a,e)}ih(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:es(8,t,t.return),or(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,or(t));break;default:or(t)}e=e.sibling}}function oh(e,t){for(;tn!==null;){var n=tn;switch(n.tag){case 0:case 11:case 15:es(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var a=n.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:Ql(n.memoizedState.cache)}if(a=n.child,a!==null)a.return=n,tn=a;else e:for(n=e;tn!==null;){a=tn;var r=a.sibling,c=a.return;if(Wf(a),a===n){tn=null;break e}if(r!==null){r.return=c,tn=r;break e}tn=c}}}var Ug={getCacheForType:function(e){var t=ln(Zt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ln(Zt).controller.signal}},Lg=typeof WeakMap=="function"?WeakMap:Map,dt=0,xt=null,Pe=null,tt=0,ht=0,qn=null,ts=!1,cl=!1,Sc=!1,Ua=0,$t=0,ns=0,zs=0,jc=0,$n=0,ul=0,ui=null,Tn=null,Nc=!1,cr=0,ch=0,ur=1/0,dr=null,as=null,en=0,ss=null,dl=null,La=0,_c=0,Ec=null,uh=null,di=0,Cc=null;function Hn(){return(dt&2)!==0&&tt!==0?tt&-tt:v.T!==null?zc():Gn()}function dh(){if($n===0)if((tt&536870912)===0||at){var e=Ne;Ne<<=1,(Ne&3932160)===0&&(Ne=262144),$n=e}else $n=536870912;return e=Ln.current,e!==null&&(e.flags|=32),$n}function kn(e,t,n){(e===xt&&(ht===2||ht===9)||e.cancelPendingCommit!==null)&&(fl(e,0),ls(e,tt,$n,!1)),Lt(e,n),((dt&2)===0||e!==xt)&&(e===xt&&((dt&2)===0&&(zs|=n),$t===4&&ls(e,tt,$n,!1)),va(e))}function fh(e,t,n){if((dt&6)!==0)throw Error(u(327));var a=!n&&(t&127)===0&&(t&e.expiredLanes)===0||ct(e,t),r=a?$g(e,t):kc(e,t,!0),c=a;do{if(r===0){cl&&!a&&ls(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!Bg(n)){r=kc(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var p=e;r=ui;var N=p.current.memoizedState.isDehydrated;if(N&&(fl(p,d).flags|=256),d=kc(p,d,!1),d!==2){if(Sc&&!N){p.errorRecoveryDisabledLanes|=c,zs|=c,r=4;break e}c=Tn,Tn=r,c!==null&&(Tn===null?Tn=c:Tn.push.apply(Tn,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){fl(e,0),ls(e,t,0,!0);break}e:{switch(a=e,c=r,c){case 0:case 1:throw Error(u(345));case 4:if((t&4194048)!==t)break;case 6:ls(a,t,$n,!ts);break e;case 2:Tn=null;break;case 3:case 5:break;default:throw Error(u(329))}if((t&62914560)===t&&(r=cr+300-Ht(),10<r)){if(ls(a,t,$n,!ts),lt(a,0,!0)!==0)break e;La=t,a.timeoutHandle=Gh(hh.bind(null,a,n,Tn,dr,Nc,t,$n,zs,ul,ts,c,"Throttled",-0,0),r);break e}hh(a,n,Tn,dr,Nc,t,$n,zs,ul,ts,c,null,-0,0)}}break}while(!0);va(e)}function hh(e,t,n,a,r,c,d,p,N,Y,P,le,F,K){if(e.timeoutHandle=-1,le=t.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ra},lh(t,c,le);var ze=(c&62914560)===c?cr-Ht():(c&4194048)===c?ch-Ht():0;if(ze=Sy(le,ze),ze!==null){La=c,e.cancelPendingCommit=ze(wh.bind(null,e,t,c,n,a,r,d,p,N,P,le,null,F,K)),ls(e,c,d,!Y);return}}wh(e,t,c,n,a,r,d,p,N)}function Bg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var a=0;a<n.length;a++){var r=n[a],c=r.getSnapshot;r=r.value;try{if(!Rn(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ls(e,t,n,a){t&=~jc,t&=~zs,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var c=31-D(r),d=1<<c;a[c]=-1,r&=~d}n!==0&&ha(e,n,t)}function fr(){return(dt&6)===0?(fi(0),!1):!0}function Tc(){if(Pe!==null){if(ht===0)var e=Pe.return;else e=Pe,Ea=Ns=null,Yo(e),nl=null,Zl=0,e=Pe;for(;e!==null;)Yf(e.alternate,e),e=e.return;Pe=null}}function fl(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,sy(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),La=0,Tc(),xt=e,Pe=n=Na(e.current,null),tt=t,ht=0,qn=null,ts=!1,cl=ct(e,t),Sc=!1,ul=$n=jc=zs=ns=$t=0,Tn=ui=null,Nc=!1,(t&8)!==0&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var r=31-D(a),c=1<<r;t|=e[r],a&=~c}return Ua=t,zi(),n}function mh(e,t){Ze=null,v.H=ni,t===tl||t===Hi?(t=kd(),ht=3):t===Oo?(t=kd(),ht=4):ht=t===ic?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,qn=t,Pe===null&&($t=1,tr(e,Fn(t,e.current)))}function ph(){var e=Ln.current;return e===null?!0:(tt&4194048)===tt?In===null:(tt&62914560)===tt||(tt&536870912)!==0?e===In:!1}function gh(){var e=v.H;return v.H=ni,e===null?ni:e}function yh(){var e=v.A;return v.A=Ug,e}function hr(){$t=4,ts||(tt&4194048)!==tt&&Ln.current!==null||(cl=!0),(ns&134217727)===0&&(zs&134217727)===0||xt===null||ls(xt,tt,$n,!1)}function kc(e,t,n){var a=dt;dt|=2;var r=gh(),c=yh();(xt!==e||tt!==t)&&(dr=null,fl(e,t)),t=!1;var d=$t;e:do try{if(ht!==0&&Pe!==null){var p=Pe,N=qn;switch(ht){case 8:Tc(),d=6;break e;case 3:case 2:case 9:case 6:Ln.current===null&&(t=!0);var Y=ht;if(ht=0,qn=null,hl(e,p,N,Y),n&&cl){d=0;break e}break;default:Y=ht,ht=0,qn=null,hl(e,p,N,Y)}}qg(),d=$t;break}catch(P){mh(e,P)}while(!0);return t&&e.shellSuspendCounter++,Ea=Ns=null,dt=a,v.H=r,v.A=c,Pe===null&&(xt=null,tt=0,zi()),d}function qg(){for(;Pe!==null;)bh(Pe)}function $g(e,t){var n=dt;dt|=2;var a=gh(),r=yh();xt!==e||tt!==t?(dr=null,ur=Ht()+500,fl(e,t)):cl=ct(e,t);e:do try{if(ht!==0&&Pe!==null){t=Pe;var c=qn;t:switch(ht){case 1:ht=0,qn=null,hl(e,t,c,1);break;case 2:case 9:if(Cd(c)){ht=0,qn=null,xh(t);break}t=function(){ht!==2&&ht!==9||xt!==e||(ht=7),va(e)},c.then(t,t);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Cd(c)?(ht=0,qn=null,xh(t)):(ht=0,qn=null,hl(e,t,c,7));break;case 5:var d=null;switch(Pe.tag){case 26:d=Pe.memoizedState;case 5:case 27:var p=Pe;if(d?sm(d):p.stateNode.complete){ht=0,qn=null;var N=p.sibling;if(N!==null)Pe=N;else{var Y=p.return;Y!==null?(Pe=Y,mr(Y)):Pe=null}break t}}ht=0,qn=null,hl(e,t,c,5);break;case 6:ht=0,qn=null,hl(e,t,c,6);break;case 8:Tc(),$t=6;break e;default:throw Error(u(462))}}Hg();break}catch(P){mh(e,P)}while(!0);return Ea=Ns=null,v.H=a,v.A=r,dt=n,Pe!==null?0:(xt=null,tt=0,zi(),$t)}function Hg(){for(;Pe!==null&&!On();)bh(Pe)}function bh(e){var t=Vf(e.alternate,e,Ua);e.memoizedProps=e.pendingProps,t===null?mr(e):Pe=t}function xh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Uf(n,t,t.pendingProps,t.type,void 0,tt);break;case 11:t=Uf(n,t,t.pendingProps,t.type.render,t.ref,tt);break;case 5:Yo(t);default:Yf(n,t),t=Pe=gd(t,Ua),t=Vf(n,t,Ua)}e.memoizedProps=e.pendingProps,t===null?mr(e):Pe=t}function hl(e,t,n,a){Ea=Ns=null,Yo(t),nl=null,Zl=0;var r=t.return;try{if(kg(e,r,t,n,tt)){$t=1,tr(e,Fn(n,e.current)),Pe=null;return}}catch(c){if(r!==null)throw Pe=r,c;$t=1,tr(e,Fn(n,e.current)),Pe=null;return}t.flags&32768?(at||a===1?e=!0:cl||(tt&536870912)!==0?e=!1:(ts=e=!0,(a===2||a===9||a===3||a===6)&&(a=Ln.current,a!==null&&a.tag===13&&(a.flags|=16384))),vh(t,e)):mr(t)}function mr(e){var t=e;do{if((t.flags&32768)!==0){vh(t,ts);return}e=t.return;var n=Og(t.alternate,t,Ua);if(n!==null){Pe=n;return}if(t=t.sibling,t!==null){Pe=t;return}Pe=t=e}while(t!==null);$t===0&&($t=5)}function vh(e,t){do{var n=zg(e.alternate,e);if(n!==null){n.flags&=32767,Pe=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Pe=e;return}Pe=e=n}while(e!==null);$t=6,Pe=null}function wh(e,t,n,a,r,c,d,p,N){e.cancelPendingCommit=null;do pr();while(en!==0);if((dt&6)!==0)throw Error(u(327));if(t!==null){if(t===e.current)throw Error(u(177));if(c=t.lanes|t.childLanes,c|=yo,hn(e,n,c,d,p,N),e===xt&&(Pe=xt=null,tt=0),dl=t,ss=e,La=n,_c=c,Ec=r,uh=a,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Xg(he,function(){return Eh(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||a){a=v.T,v.T=null,r=M.p,M.p=2,d=dt,dt|=4;try{Mg(e,t,n)}finally{dt=d,M.p=r,v.T=a}}en=1,Sh(),jh(),Nh()}}function Sh(){if(en===1){en=0;var e=ss,t=dl,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=v.T,v.T=null;var a=M.p;M.p=2;var r=dt;dt|=4;try{nh(t,e);var c=Hc,d=rd(e.containerInfo),p=c.focusedElem,N=c.selectionRange;if(d!==p&&p&&p.ownerDocument&&id(p.ownerDocument.documentElement,p)){if(N!==null&&fo(p)){var Y=N.start,P=N.end;if(P===void 0&&(P=Y),"selectionStart"in p)p.selectionStart=Y,p.selectionEnd=Math.min(P,p.value.length);else{var le=p.ownerDocument||document,F=le&&le.defaultView||window;if(F.getSelection){var K=F.getSelection(),ze=p.textContent.length,Ve=Math.min(N.start,ze),yt=N.end===void 0?Ve:Math.min(N.end,ze);!K.extend&&Ve>yt&&(d=yt,yt=Ve,Ve=d);var q=ld(p,Ve),k=ld(p,yt);if(q&&k&&(K.rangeCount!==1||K.anchorNode!==q.node||K.anchorOffset!==q.offset||K.focusNode!==k.node||K.focusOffset!==k.offset)){var V=le.createRange();V.setStart(q.node,q.offset),K.removeAllRanges(),Ve>yt?(K.addRange(V),K.extend(k.node,k.offset)):(V.setEnd(k.node,k.offset),K.addRange(V))}}}}for(le=[],K=p;K=K.parentNode;)K.nodeType===1&&le.push({element:K,left:K.scrollLeft,top:K.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<le.length;p++){var ae=le[p];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}Cr=!!$c,Hc=$c=null}finally{dt=r,M.p=a,v.T=n}}e.current=t,en=2}}function jh(){if(en===2){en=0;var e=ss,t=dl,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=v.T,v.T=null;var a=M.p;M.p=2;var r=dt;dt|=4;try{If(e,t.alternate,t)}finally{dt=r,M.p=a,v.T=n}}en=3}}function Nh(){if(en===4||en===3){en=0,zn();var e=ss,t=dl,n=La,a=uh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?en=5:(en=0,dl=ss=null,_h(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(as=null),Vn(n),t=t.stateNode,U&&typeof U.onCommitFiberRoot=="function")try{U.onCommitFiberRoot(z,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=v.T,r=M.p,M.p=2,v.T=null;try{for(var c=e.onRecoverableError,d=0;d<a.length;d++){var p=a[d];c(p.value,{componentStack:p.stack})}}finally{v.T=t,M.p=r}}(La&3)!==0&&pr(),va(e),r=e.pendingLanes,(n&261930)!==0&&(r&42)!==0?e===Cc?di++:(di=0,Cc=e):di=0,fi(0)}}function _h(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ql(t)))}function pr(){return Sh(),jh(),Nh(),Eh()}function Eh(){if(en!==5)return!1;var e=ss,t=_c;_c=0;var n=Vn(La),a=v.T,r=M.p;try{M.p=32>n?32:n,v.T=null,n=Ec,Ec=null;var c=ss,d=La;if(en=0,dl=ss=null,La=0,(dt&6)!==0)throw Error(u(331));var p=dt;if(dt|=4,rh(c.current),sh(c,c.current,d,n),dt=p,fi(0,!1),U&&typeof U.onPostCommitFiberRoot=="function")try{U.onPostCommitFiberRoot(z,c)}catch{}return!0}finally{M.p=r,v.T=a,_h(e,t)}}function Ch(e,t,n){t=Fn(n,t),t=lc(e.stateNode,t,2),e=Ia(e,t,2),e!==null&&(Lt(e,2),va(e))}function mt(e,t,n){if(e.tag===3)Ch(e,e,n);else for(;t!==null;){if(t.tag===3){Ch(t,e,n);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(as===null||!as.has(a))){e=Fn(n,e),n=Tf(2),a=Ia(t,n,2),a!==null&&(kf(n,a,t,e),Lt(a,2),va(a));break}}t=t.return}}function Ac(e,t,n){var a=e.pingCache;if(a===null){a=e.pingCache=new Lg;var r=new Set;a.set(t,r)}else r=a.get(t),r===void 0&&(r=new Set,a.set(t,r));r.has(n)||(Sc=!0,r.add(n),e=Vg.bind(null,e,t,n),t.then(e,e))}function Vg(e,t,n){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,xt===e&&(tt&n)===n&&($t===4||$t===3&&(tt&62914560)===tt&&300>Ht()-cr?(dt&2)===0&&fl(e,0):jc|=n,ul===tt&&(ul=0)),va(e)}function Th(e,t){t===0&&(t=Tt()),e=ws(e,t),e!==null&&(Lt(e,t),va(e))}function Gg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Th(e,n)}function Yg(e,t){var n=0;switch(e.tag){case 31:case 13:var a=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(u(314))}a!==null&&a.delete(t),Th(e,n)}function Xg(e,t){return Ut(e,t)}var gr=null,ml=null,Dc=!1,yr=!1,Oc=!1,is=0;function va(e){e!==ml&&e.next===null&&(ml===null?gr=ml=e:ml=ml.next=e),yr=!0,Dc||(Dc=!0,Fg())}function fi(e,t){if(!Oc&&yr){Oc=!0;do for(var n=!1,a=gr;a!==null;){if(e!==0){var r=a.pendingLanes;if(r===0)var c=0;else{var d=a.suspendedLanes,p=a.pingedLanes;c=(1<<31-D(42|e)+1)-1,c&=r&~(d&~p),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,Oh(a,c))}else c=tt,c=lt(a,a===xt?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),(c&3)===0||ct(a,c)||(n=!0,Oh(a,c));a=a.next}while(n);Oc=!1}}function Qg(){kh()}function kh(){yr=Dc=!1;var e=0;is!==0&&ay()&&(e=is);for(var t=Ht(),n=null,a=gr;a!==null;){var r=a.next,c=Ah(a,t);c===0?(a.next=null,n===null?gr=r:n.next=r,r===null&&(ml=n)):(n=a,(e!==0||(c&3)!==0)&&(yr=!0)),a=r}en!==0&&en!==5||fi(e),is!==0&&(is=0)}function Ah(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-D(c),p=1<<d,N=r[d];N===-1?((p&n)===0||(p&a)!==0)&&(r[d]=Ye(p,t)):N<=t&&(e.expiredLanes|=p),c&=~p}if(t=xt,n=tt,n=lt(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,n===0||e===t&&(ht===2||ht===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&un(a),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||ct(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(a!==null&&un(a),Vn(n)){case 2:case 8:n=J;break;case 32:n=he;break;case 268435456:n=De;break;default:n=he}return a=Dh.bind(null,e),n=Ut(n,a),e.callbackPriority=t,e.callbackNode=n,t}return a!==null&&a!==null&&un(a),e.callbackPriority=2,e.callbackNode=null,2}function Dh(e,t){if(en!==0&&en!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(pr()&&e.callbackNode!==n)return null;var a=tt;return a=lt(e,e===xt?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(fh(e,a,t),Ah(e,Ht()),e.callbackNode!=null&&e.callbackNode===n?Dh.bind(null,e):null)}function Oh(e,t){if(pr())return null;fh(e,t,!0)}function Fg(){ly(function(){(dt&6)!==0?Ut(Ft,Qg):kh()})}function zc(){if(is===0){var e=Ps;e===0&&(e=je,je<<=1,(je&261888)===0&&(je=256)),is=e}return is}function zh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Vs(""+e)}function Mh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Zg(e,t,n,a,r){if(t==="submit"&&n&&n.stateNode===r){var c=zh((r[Vt]||null).action),d=a.submitter;d&&(t=(t=d[Vt]||null)?zh(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var p=new Gs("action","action",null,a,r);e.push({event:p,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(is!==0){var N=d?Mh(r,d):new FormData(r);Po(n,{pending:!0,data:N,method:r.method,action:c},null,N)}}else typeof c=="function"&&(p.preventDefault(),N=d?Mh(r,d):new FormData(r),Po(n,{pending:!0,data:N,method:r.method,action:c},c,N))},currentTarget:r}]})}}for(var Mc=0;Mc<go.length;Mc++){var Rc=go[Mc],Kg=Rc.toLowerCase(),Jg=Rc[0].toUpperCase()+Rc.slice(1);oa(Kg,"on"+Jg)}oa(ud,"onAnimationEnd"),oa(dd,"onAnimationIteration"),oa(fd,"onAnimationStart"),oa("dblclick","onDoubleClick"),oa("focusin","onFocus"),oa("focusout","onBlur"),oa(fg,"onTransitionRun"),oa(hg,"onTransitionStart"),oa(mg,"onTransitionCancel"),oa(hd,"onTransitionEnd"),ma("onMouseEnter",["mouseout","mouseover"]),ma("onMouseLeave",["mouseout","mouseover"]),ma("onPointerEnter",["pointerout","pointerover"]),ma("onPointerLeave",["pointerout","pointerover"]),ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ig=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hi));function Rh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var c=void 0;if(t)for(var d=a.length-1;0<=d;d--){var p=a[d],N=p.instance,Y=p.currentTarget;if(p=p.listener,N!==c&&r.isPropagationStopped())break e;c=p,r.currentTarget=Y;try{c(r)}catch(P){Oi(P)}r.currentTarget=null,c=N}else for(d=0;d<a.length;d++){if(p=a[d],N=p.instance,Y=p.currentTarget,p=p.listener,N!==c&&r.isPropagationStopped())break e;c=p,r.currentTarget=Y;try{c(r)}catch(P){Oi(P)}r.currentTarget=null,c=N}}}}function et(e,t){var n=t[aa];n===void 0&&(n=t[aa]=new Set);var a=e+"__bubble";n.has(a)||(Uh(t,e,2,!1),n.add(a))}function Uc(e,t,n){var a=0;t&&(a|=4),Uh(n,e,a,t)}var br="_reactListening"+Math.random().toString(36).slice(2);function Lc(e){if(!e[br]){e[br]=!0,la.forEach(function(n){n!=="selectionchange"&&(Ig.has(n)||Uc(n,!1,e),Uc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[br]||(t[br]=!0,Uc("selectionchange",!1,t))}}function Uh(e,t,n,a){switch(dm(t)){case 2:var r=_y;break;case 8:r=Ey;break;default:r=Wc}n=r.bind(null,t,n,e),r=void 0,!xe||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),a?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Bc(e,t,n,a,r){var c=a;if((t&1)===0&&(t&2)===0&&a!==null)e:for(;;){if(a===null)return;var d=a.tag;if(d===3||d===4){var p=a.stateNode.containerInfo;if(p===r)break;if(d===4)for(d=a.return;d!==null;){var N=d.tag;if((N===3||N===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;p!==null;){if(d=Yn(p),d===null)return;if(N=d.tag,N===5||N===6||N===26||N===27){a=c=d;continue e}p=p.parentNode}}a=a.return}I(function(){var Y=c,P=Ul(n),le=[];e:{var F=md.get(e);if(F!==void 0){var K=Gs,ze=e;switch(e){case"keypress":if(Nn(n)===0)break e;case"keydown":case"keyup":K=Yp;break;case"focusin":ze="focus",K=io;break;case"focusout":ze="blur",K=io;break;case"beforeblur":case"afterblur":K=io;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=Gu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=Op;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=Fp;break;case ud:case dd:case fd:K=Rp;break;case hd:K=Kp;break;case"scroll":case"scrollend":K=Ap;break;case"wheel":K=Ip;break;case"copy":case"cut":case"paste":K=Lp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=Xu;break;case"toggle":case"beforetoggle":K=Pp}var Ve=(t&4)!==0,yt=!Ve&&(e==="scroll"||e==="scrollend"),q=Ve?F!==null?F+"Capture":null:F;Ve=[];for(var k=Y,V;k!==null;){var ae=k;if(V=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||V===null||q===null||(ae=re(k,q),ae!=null&&Ve.push(mi(k,ae,V))),yt)break;k=k.return}0<Ve.length&&(F=new K(F,ze,null,n,P),le.push({event:F,listeners:Ve}))}}if((t&7)===0){e:{if(F=e==="mouseover"||e==="pointerover",K=e==="mouseout"||e==="pointerout",F&&n!==Rl&&(ze=n.relatedTarget||n.fromElement)&&(Yn(ze)||ze[vn]))break e;if((K||F)&&(F=P.window===P?P:(F=P.ownerDocument)?F.defaultView||F.parentWindow:window,K?(ze=n.relatedTarget||n.toElement,K=Y,ze=ze?Yn(ze):null,ze!==null&&(yt=h(ze),Ve=ze.tag,ze!==yt||Ve!==5&&Ve!==27&&Ve!==6)&&(ze=null)):(K=null,ze=Y),K!==ze)){if(Ve=Gu,ae="onMouseLeave",q="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(Ve=Xu,ae="onPointerLeave",q="onPointerEnter",k="pointer"),yt=K==null?F:Xn(K),V=ze==null?F:Xn(ze),F=new Ve(ae,k+"leave",K,n,P),F.target=yt,F.relatedTarget=V,ae=null,Yn(P)===Y&&(Ve=new Ve(q,k+"enter",ze,n,P),Ve.target=V,Ve.relatedTarget=yt,ae=Ve),yt=ae,K&&ze)t:{for(Ve=Wg,q=K,k=ze,V=0,ae=q;ae;ae=Ve(ae))V++;ae=0;for(var $e=k;$e;$e=Ve($e))ae++;for(;0<V-ae;)q=Ve(q),V--;for(;0<ae-V;)k=Ve(k),ae--;for(;V--;){if(q===k||k!==null&&q===k.alternate){Ve=q;break t}q=Ve(q),k=Ve(k)}Ve=null}else Ve=null;K!==null&&Lh(le,F,K,Ve,!1),ze!==null&&yt!==null&&Lh(le,yt,ze,Ve,!0)}}e:{if(F=Y?Xn(Y):window,K=F.nodeName&&F.nodeName.toLowerCase(),K==="select"||K==="input"&&F.type==="file")var rt=Pu;else if(Iu(F))if(ed)rt=cg;else{rt=rg;var Ue=ig}else K=F.nodeName,!K||K.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?Y&&Ml(Y.elementType)&&(rt=Pu):rt=og;if(rt&&(rt=rt(e,Y))){Wu(le,rt,n,P);break e}Ue&&Ue(e,F,Y),e==="focusout"&&Y&&F.type==="number"&&Y.memoizedProps.value!=null&&Dl(F,"number",F.value)}switch(Ue=Y?Xn(Y):window,e){case"focusin":(Iu(Ue)||Ue.contentEditable==="true")&&(Xs=Ue,ho=Y,Gl=null);break;case"focusout":Gl=ho=Xs=null;break;case"mousedown":mo=!0;break;case"contextmenu":case"mouseup":case"dragend":mo=!1,od(le,n,P);break;case"selectionchange":if(dg)break;case"keydown":case"keyup":od(le,n,P)}var Ke;if(oo)e:{switch(e){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Ys?Ku(e,n)&&(nt="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(nt="onCompositionStart");nt&&(Qu&&n.locale!=="ko"&&(Ys||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Ys&&(Ke=jn()):(ft=P,ga="value"in ft?ft.value:ft.textContent,Ys=!0)),Ue=xr(Y,nt),0<Ue.length&&(nt=new Yu(nt,e,null,n,P),le.push({event:nt,listeners:Ue}),Ke?nt.data=Ke:(Ke=Ju(n),Ke!==null&&(nt.data=Ke)))),(Ke=tg?ng(e,n):ag(e,n))&&(nt=xr(Y,"onBeforeInput"),0<nt.length&&(Ue=new Yu("onBeforeInput","beforeinput",null,n,P),le.push({event:Ue,listeners:nt}),Ue.data=Ke)),Zg(le,e,Y,n,P)}Rh(le,t)})}function mi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function xr(e,t){for(var n=t+"Capture",a=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=re(e,n),r!=null&&a.unshift(mi(e,r,c)),r=re(e,t),r!=null&&a.push(mi(e,r,c))),e.tag===3)return a;e=e.return}return[]}function Wg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Lh(e,t,n,a,r){for(var c=t._reactName,d=[];n!==null&&n!==a;){var p=n,N=p.alternate,Y=p.stateNode;if(p=p.tag,N!==null&&N===a)break;p!==5&&p!==26&&p!==27||Y===null||(N=Y,r?(Y=re(n,c),Y!=null&&d.unshift(mi(n,Y,N))):r||(Y=re(n,c),Y!=null&&d.push(mi(n,Y,N)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var Pg=/\r\n?/g,ey=/\u0000|\uFFFD/g;function Bh(e){return(typeof e=="string"?e:""+e).replace(Pg,`
`).replace(ey,"")}function qh(e,t){return t=Bh(t),Bh(e)===t}function gt(e,t,n,a,r,c){switch(n){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||Ya(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&Ya(e,""+a);break;case"className":pa(e,"class",a);break;case"tabIndex":pa(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":pa(e,n,a);break;case"style":ki(e,a,c);break;case"data":if(t!=="object"){pa(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=Vs(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&gt(e,t,"name",r.name,r,null),gt(e,t,"formEncType",r.formEncType,r,null),gt(e,t,"formMethod",r.formMethod,r,null),gt(e,t,"formTarget",r.formTarget,r,null)):(gt(e,t,"encType",r.encType,r,null),gt(e,t,"method",r.method,r,null),gt(e,t,"target",r.target,r,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=Vs(""+a),e.setAttribute(n,a);break;case"onClick":a!=null&&(e.onclick=ra);break;case"onScroll":a!=null&&et("scroll",e);break;case"onScrollEnd":a!=null&&et("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(u(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(u(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}n=Vs(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":a===!0?e.setAttribute(n,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":et("beforetoggle",e),et("toggle",e),gs(e,"popover",a);break;case"xlinkActuate":mn(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":mn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":mn(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":mn(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":mn(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":mn(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":mn(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":mn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":mn(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":gs(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=no.get(n)||n,gs(e,n,a))}}function qc(e,t,n,a,r,c){switch(n){case"style":ki(e,a,c);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(u(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(u(60));e.innerHTML=n}}break;case"children":typeof a=="string"?Ya(e,a):(typeof a=="number"||typeof a=="bigint")&&Ya(e,""+a);break;case"onScroll":a!=null&&et("scroll",e);break;case"onScrollEnd":a!=null&&et("scrollend",e);break;case"onClick":a!=null&&(e.onclick=ra);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bt.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[Vt]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof a=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,r);break e}n in e?e[n]=a:a===!0?e.setAttribute(n,""):gs(e,n,a)}}}function on(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":et("error",e),et("load",e);var a=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":a=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(u(137,t));default:gt(e,t,c,d,n,null)}}r&&gt(e,t,"srcSet",n.srcSet,n,null),a&&gt(e,t,"src",n.src,n,null);return;case"input":et("invalid",e);var p=c=d=r=null,N=null,Y=null;for(a in n)if(n.hasOwnProperty(a)){var P=n[a];if(P!=null)switch(a){case"name":r=P;break;case"type":d=P;break;case"checked":N=P;break;case"defaultChecked":Y=P;break;case"value":c=P;break;case"defaultValue":p=P;break;case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(u(137,t));break;default:gt(e,t,a,P,n,null)}}Ci(e,c,p,N,Y,d,r,!1);return;case"select":et("invalid",e),a=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(p=n[r],p!=null))switch(r){case"value":c=p;break;case"defaultValue":d=p;break;case"multiple":a=p;default:gt(e,t,r,p,n,null)}t=c,n=d,e.multiple=!!a,t!=null?Ga(e,!!a,t,!1):n!=null&&Ga(e,!!a,n,!0);return;case"textarea":et("invalid",e),c=r=a=null;for(d in n)if(n.hasOwnProperty(d)&&(p=n[d],p!=null))switch(d){case"value":a=p;break;case"defaultValue":r=p;break;case"children":c=p;break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(u(91));break;default:gt(e,t,d,p,n,null)}Hs(e,a,r,c);return;case"option":for(N in n)n.hasOwnProperty(N)&&(a=n[N],a!=null)&&(N==="selected"?e.selected=a&&typeof a!="function"&&typeof a!="symbol":gt(e,t,N,a,n,null));return;case"dialog":et("beforetoggle",e),et("toggle",e),et("cancel",e),et("close",e);break;case"iframe":case"object":et("load",e);break;case"video":case"audio":for(a=0;a<hi.length;a++)et(hi[a],e);break;case"image":et("error",e),et("load",e);break;case"details":et("toggle",e);break;case"embed":case"source":case"link":et("error",e),et("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in n)if(n.hasOwnProperty(Y)&&(a=n[Y],a!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(u(137,t));default:gt(e,t,Y,a,n,null)}return;default:if(Ml(t)){for(P in n)n.hasOwnProperty(P)&&(a=n[P],a!==void 0&&qc(e,t,P,a,n,void 0));return}}for(p in n)n.hasOwnProperty(p)&&(a=n[p],a!=null&&gt(e,t,p,a,n,null))}function ty(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,p=null,N=null,Y=null,P=null;for(K in n){var le=n[K];if(n.hasOwnProperty(K)&&le!=null)switch(K){case"checked":break;case"value":break;case"defaultValue":N=le;default:a.hasOwnProperty(K)||gt(e,t,K,null,a,le)}}for(var F in a){var K=a[F];if(le=n[F],a.hasOwnProperty(F)&&(K!=null||le!=null))switch(F){case"type":c=K;break;case"name":r=K;break;case"checked":Y=K;break;case"defaultChecked":P=K;break;case"value":d=K;break;case"defaultValue":p=K;break;case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(u(137,t));break;default:K!==le&&gt(e,t,F,K,a,le)}}Al(e,d,p,N,Y,P,c,r);return;case"select":K=d=p=F=null;for(c in n)if(N=n[c],n.hasOwnProperty(c)&&N!=null)switch(c){case"value":break;case"multiple":K=N;default:a.hasOwnProperty(c)||gt(e,t,c,null,a,N)}for(r in a)if(c=a[r],N=n[r],a.hasOwnProperty(r)&&(c!=null||N!=null))switch(r){case"value":F=c;break;case"defaultValue":p=c;break;case"multiple":d=c;default:c!==N&&gt(e,t,r,c,a,N)}t=p,n=d,a=K,F!=null?Ga(e,!!n,F,!1):!!a!=!!n&&(t!=null?Ga(e,!!n,t,!0):Ga(e,!!n,n?[]:"",!1));return;case"textarea":K=F=null;for(p in n)if(r=n[p],n.hasOwnProperty(p)&&r!=null&&!a.hasOwnProperty(p))switch(p){case"value":break;case"children":break;default:gt(e,t,p,null,a,r)}for(d in a)if(r=a[d],c=n[d],a.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":F=r;break;case"defaultValue":K=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(u(91));break;default:r!==c&&gt(e,t,d,r,a,c)}Ol(e,F,K);return;case"option":for(var ze in n)F=n[ze],n.hasOwnProperty(ze)&&F!=null&&!a.hasOwnProperty(ze)&&(ze==="selected"?e.selected=!1:gt(e,t,ze,null,a,F));for(N in a)F=a[N],K=n[N],a.hasOwnProperty(N)&&F!==K&&(F!=null||K!=null)&&(N==="selected"?e.selected=F&&typeof F!="function"&&typeof F!="symbol":gt(e,t,N,F,a,K));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in n)F=n[Ve],n.hasOwnProperty(Ve)&&F!=null&&!a.hasOwnProperty(Ve)&&gt(e,t,Ve,null,a,F);for(Y in a)if(F=a[Y],K=n[Y],a.hasOwnProperty(Y)&&F!==K&&(F!=null||K!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(u(137,t));break;default:gt(e,t,Y,F,a,K)}return;default:if(Ml(t)){for(var yt in n)F=n[yt],n.hasOwnProperty(yt)&&F!==void 0&&!a.hasOwnProperty(yt)&&qc(e,t,yt,void 0,a,F);for(P in a)F=a[P],K=n[P],!a.hasOwnProperty(P)||F===K||F===void 0&&K===void 0||qc(e,t,P,F,a,K);return}}for(var q in n)F=n[q],n.hasOwnProperty(q)&&F!=null&&!a.hasOwnProperty(q)&&gt(e,t,q,null,a,F);for(le in a)F=a[le],K=n[le],!a.hasOwnProperty(le)||F===K||F==null&&K==null||gt(e,t,le,F,a,K)}function $h(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ny(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),a=0;a<n.length;a++){var r=n[a],c=r.transferSize,d=r.initiatorType,p=r.duration;if(c&&p&&$h(d)){for(d=0,p=r.responseEnd,a+=1;a<n.length;a++){var N=n[a],Y=N.startTime;if(Y>p)break;var P=N.transferSize,le=N.initiatorType;P&&$h(le)&&(N=N.responseEnd,d+=P*(N<p?1:(p-Y)/(N-Y)))}if(--a,t+=8*(c+d)/(r.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $c=null,Hc=null;function vr(e){return e.nodeType===9?e:e.ownerDocument}function Hh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Vc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gc=null;function ay(){var e=window.event;return e&&e.type==="popstate"?e===Gc?!1:(Gc=e,!0):(Gc=null,!1)}var Gh=typeof setTimeout=="function"?setTimeout:void 0,sy=typeof clearTimeout=="function"?clearTimeout:void 0,Yh=typeof Promise=="function"?Promise:void 0,ly=typeof queueMicrotask=="function"?queueMicrotask:typeof Yh<"u"?function(e){return Yh.resolve(null).then(e).catch(iy)}:Gh;function iy(e){setTimeout(function(){throw e})}function rs(e){return e==="head"}function Xh(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"||n==="/&"){if(a===0){e.removeChild(r),bl(t);return}a--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")a++;else if(n==="html")pi(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,pi(n);for(var c=n.firstChild;c;){var d=c.nextSibling,p=c.nodeName;c[Pt]||p==="SCRIPT"||p==="STYLE"||p==="LINK"&&c.rel.toLowerCase()==="stylesheet"||n.removeChild(c),c=d}}else n==="body"&&pi(e.ownerDocument.body);n=r}while(n);bl(t)}function Qh(e,t){var n=e;e=0;do{var a=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=a}while(n)}function Yc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Yc(n),it(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function ry(e,t,n,a){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[Pt])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=Wn(e.nextSibling),e===null)break}return null}function oy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Wn(e.nextSibling),e===null))return null;return e}function Fh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Wn(e.nextSibling),e===null))return null;return e}function Xc(e){return e.data==="$?"||e.data==="$~"}function Qc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function cy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function Wn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Fc=null;function Zh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return Wn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Kh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Jh(e,t,n){switch(t=vr(n),e){case"html":if(e=t.documentElement,!e)throw Error(u(452));return e;case"head":if(e=t.head,!e)throw Error(u(453));return e;case"body":if(e=t.body,!e)throw Error(u(454));return e;default:throw Error(u(451))}}function pi(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);it(e)}var Pn=new Map,Ih=new Set;function wr(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ba=M.d;M.d={f:uy,r:dy,D:fy,C:hy,L:my,m:py,X:yy,S:gy,M:by};function uy(){var e=Ba.f(),t=fr();return e||t}function dy(e){var t=nn(e);t!==null&&t.tag===5&&t.type==="form"?mf(t):Ba.r(e)}var pl=typeof document>"u"?null:document;function Wh(e,t,n){var a=pl;if(a&&typeof t=="string"&&t){var r=wn(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),Ih.has(r)||(Ih.add(r),e={rel:e,crossOrigin:n,href:t},a.querySelector(r)===null&&(t=a.createElement("link"),on(t,"link",e),kt(t),a.head.appendChild(t)))}}function fy(e){Ba.D(e),Wh("dns-prefetch",e,null)}function hy(e,t){Ba.C(e,t),Wh("preconnect",e,t)}function my(e,t,n){Ba.L(e,t,n);var a=pl;if(a&&e&&t){var r='link[rel="preload"][as="'+wn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+wn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+wn(n.imageSizes)+'"]')):r+='[href="'+wn(e)+'"]';var c=r;switch(t){case"style":c=gl(e);break;case"script":c=yl(e)}Pn.has(c)||(e=b({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Pn.set(c,e),a.querySelector(r)!==null||t==="style"&&a.querySelector(gi(c))||t==="script"&&a.querySelector(yi(c))||(t=a.createElement("link"),on(t,"link",e),kt(t),a.head.appendChild(t)))}}function py(e,t){Ba.m(e,t);var n=pl;if(n&&e){var a=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+wn(a)+'"][href="'+wn(e)+'"]',c=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=yl(e)}if(!Pn.has(c)&&(e=b({rel:"modulepreload",href:e},t),Pn.set(c,e),n.querySelector(r)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(yi(c)))return}a=n.createElement("link"),on(a,"link",e),kt(a),n.head.appendChild(a)}}}function gy(e,t,n){Ba.S(e,t,n);var a=pl;if(a&&e){var r=sa(a).hoistableStyles,c=gl(e);t=t||"default";var d=r.get(c);if(!d){var p={loading:0,preload:null};if(d=a.querySelector(gi(c)))p.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Pn.get(c))&&Zc(e,n);var N=d=a.createElement("link");kt(N),on(N,"link",e),N._p=new Promise(function(Y,P){N.onload=Y,N.onerror=P}),N.addEventListener("load",function(){p.loading|=1}),N.addEventListener("error",function(){p.loading|=2}),p.loading|=4,Sr(d,t,a)}d={type:"stylesheet",instance:d,count:1,state:p},r.set(c,d)}}}function yy(e,t){Ba.X(e,t);var n=pl;if(n&&e){var a=sa(n).hoistableScripts,r=yl(e),c=a.get(r);c||(c=n.querySelector(yi(r)),c||(e=b({src:e,async:!0},t),(t=Pn.get(r))&&Kc(e,t),c=n.createElement("script"),kt(c),on(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},a.set(r,c))}}function by(e,t){Ba.M(e,t);var n=pl;if(n&&e){var a=sa(n).hoistableScripts,r=yl(e),c=a.get(r);c||(c=n.querySelector(yi(r)),c||(e=b({src:e,async:!0,type:"module"},t),(t=Pn.get(r))&&Kc(e,t),c=n.createElement("script"),kt(c),on(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},a.set(r,c))}}function Ph(e,t,n,a){var r=(r=we.current)?wr(r):null;if(!r)throw Error(u(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=gl(n.href),n=sa(r).hoistableStyles,a=n.get(t),a||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=gl(n.href);var c=sa(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(gi(e)))&&!c._p&&(d.instance=c,d.state.loading=5),Pn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Pn.set(e,n),c||xy(r,e,n,d.state))),t&&a===null)throw Error(u(528,""));return d}if(t&&a!==null)throw Error(u(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=yl(n),n=sa(r).hoistableScripts,a=n.get(t),a||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(u(444,e))}}function gl(e){return'href="'+wn(e)+'"'}function gi(e){return'link[rel="stylesheet"]['+e+"]"}function em(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function xy(e,t,n,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),on(t,"link",n),kt(t),e.head.appendChild(t))}function yl(e){return'[src="'+wn(e)+'"]'}function yi(e){return"script[async]"+e}function tm(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+wn(n.href)+'"]');if(a)return t.instance=a,kt(a),a;var r=b({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),kt(a),on(a,"style",r),Sr(a,n.precedence,e),t.instance=a;case"stylesheet":r=gl(n.href);var c=e.querySelector(gi(r));if(c)return t.state.loading|=4,t.instance=c,kt(c),c;a=em(n),(r=Pn.get(r))&&Zc(a,r),c=(e.ownerDocument||e).createElement("link"),kt(c);var d=c;return d._p=new Promise(function(p,N){d.onload=p,d.onerror=N}),on(c,"link",a),t.state.loading|=4,Sr(c,n.precedence,e),t.instance=c;case"script":return c=yl(n.src),(r=e.querySelector(yi(c)))?(t.instance=r,kt(r),r):(a=n,(r=Pn.get(c))&&(a=b({},n),Kc(a,r)),e=e.ownerDocument||e,r=e.createElement("script"),kt(r),on(r,"link",a),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(u(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(a=t.instance,t.state.loading|=4,Sr(a,n.precedence,e));return t.instance}function Sr(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,c=r,d=0;d<a.length;d++){var p=a[d];if(p.dataset.precedence===t)c=p;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Zc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Kc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var jr=null;function nm(e,t,n){if(jr===null){var a=new Map,r=jr=new Map;r.set(n,a)}else r=jr,a=r.get(n),a||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[Pt]||c[St]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var p=a.get(d);p?p.push(c):a.set(d,[c])}}return a}function am(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function vy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function sm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function wy(e,t,n,a){if(n.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var r=gl(a.href),c=t.querySelector(gi(r));if(c){t=c._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Nr.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=c,kt(c);return}c=t.ownerDocument||t,a=em(a),(r=Pn.get(r))&&Zc(a,r),c=c.createElement("link"),kt(c);var d=c;d._p=new Promise(function(p,N){d.onload=p,d.onerror=N}),on(c,"link",a),n.instance=c}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=Nr.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Jc=0;function Sy(e,t){return e.stylesheets&&e.count===0&&Er(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var a=setTimeout(function(){if(e.stylesheets&&Er(e,e.stylesheets),e.unsuspend){var c=e.unsuspend;e.unsuspend=null,c()}},6e4+t);0<e.imgBytes&&Jc===0&&(Jc=62500*ny());var r=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Er(e,e.stylesheets),e.unsuspend)){var c=e.unsuspend;e.unsuspend=null,c()}},(e.imgBytes>Jc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(r)}}:null}function Nr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Er(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var _r=null;function Er(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,_r=new Map,t.forEach(jy,e),_r=null,Nr.call(e))}function jy(e,t){if(!(t.state.loading&4)){var n=_r.get(e);if(n)var a=n.get(null);else{n=new Map,_r.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),a=d)}a&&n.set(null,a)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||a,c===a&&n.set(null,r),n.set(d,r),this.count++,a=Nr.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var bi={$$typeof:_e,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function Ny(e,t,n,a,r,c,d,p,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.hiddenUpdates=jt(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function lm(e,t,n,a,r,c,d,p,N,Y,P,le){return e=new Ny(e,t,n,d,N,Y,P,le,p),t=1,c===!0&&(t|=24),c=Un(3,null,null,t),e.current=c,c.stateNode=e,t=ko(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:a,isDehydrated:n,cache:t},zo(c),e}function im(e){return e?(e=Zs,e):Zs}function rm(e,t,n,a,r,c){r=im(r),a.context===null?a.context=r:a.pendingContext=r,a=Ja(t),a.payload={element:n},c=c===void 0?null:c,c!==null&&(a.callback=c),n=Ia(e,a,t),n!==null&&(kn(n,e,t),Jl(n,e,t))}function om(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ic(e,t){om(e,t),(e=e.alternate)&&om(e,t)}function cm(e){if(e.tag===13||e.tag===31){var t=ws(e,67108864);t!==null&&kn(t,e,67108864),Ic(e,67108864)}}function um(e){if(e.tag===13||e.tag===31){var t=Hn();t=Mn(t);var n=ws(e,t);n!==null&&kn(n,e,t),Ic(e,t)}}var Cr=!0;function _y(e,t,n,a){var r=v.T;v.T=null;var c=M.p;try{M.p=2,Wc(e,t,n,a)}finally{M.p=c,v.T=r}}function Ey(e,t,n,a){var r=v.T;v.T=null;var c=M.p;try{M.p=8,Wc(e,t,n,a)}finally{M.p=c,v.T=r}}function Wc(e,t,n,a){if(Cr){var r=Pc(a);if(r===null)Bc(e,t,a,Tr,n),fm(e,a);else if(Ty(r,e,t,n,a))a.stopPropagation();else if(fm(e,a),t&4&&-1<Cy.indexOf(e)){for(;r!==null;){var c=nn(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=He(c.pendingLanes);if(d!==0){var p=c;for(p.pendingLanes|=2,p.entangledLanes|=2;d;){var N=1<<31-D(d);p.entanglements[1]|=N,d&=~N}va(c),(dt&6)===0&&(ur=Ht()+500,fi(0))}}break;case 31:case 13:p=ws(c,2),p!==null&&kn(p,c,2),fr(),Ic(c,2)}if(c=Pc(a),c===null&&Bc(e,t,a,Tr,n),c===r)break;r=c}r!==null&&a.stopPropagation()}else Bc(e,t,a,null,n)}}function Pc(e){return e=Ul(e),eu(e)}var Tr=null;function eu(e){if(Tr=null,e=Yn(e),e!==null){var t=h(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=x(t),e!==null)return e;e=null}else if(n===31){if(e=w(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Tr=e,null}function dm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qe()){case Ft:return 2;case J:return 8;case he:case ke:return 32;case De:return 268435456;default:return 32}default:return 32}}var tu=!1,os=null,cs=null,us=null,xi=new Map,vi=new Map,ds=[],Cy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fm(e,t){switch(e){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":xi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vi.delete(t.pointerId)}}function wi(e,t,n,a,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:c,targetContainers:[r]},t!==null&&(t=nn(t),t!==null&&cm(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function Ty(e,t,n,a,r){switch(t){case"focusin":return os=wi(os,e,t,n,a,r),!0;case"dragenter":return cs=wi(cs,e,t,n,a,r),!0;case"mouseover":return us=wi(us,e,t,n,a,r),!0;case"pointerover":var c=r.pointerId;return xi.set(c,wi(xi.get(c)||null,e,t,n,a,r)),!0;case"gotpointercapture":return c=r.pointerId,vi.set(c,wi(vi.get(c)||null,e,t,n,a,r)),!0}return!1}function hm(e){var t=Yn(e.target);if(t!==null){var n=h(t);if(n!==null){if(t=n.tag,t===13){if(t=x(n),t!==null){e.blockedOn=t,xn(e.priority,function(){um(n)});return}}else if(t===31){if(t=w(n),t!==null){e.blockedOn=t,xn(e.priority,function(){um(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kr(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Pc(e.nativeEvent);if(n===null){n=e.nativeEvent;var a=new n.constructor(n.type,n);Rl=a,n.target.dispatchEvent(a),Rl=null}else return t=nn(n),t!==null&&cm(t),e.blockedOn=n,!1;t.shift()}return!0}function mm(e,t,n){kr(e)&&n.delete(t)}function ky(){tu=!1,os!==null&&kr(os)&&(os=null),cs!==null&&kr(cs)&&(cs=null),us!==null&&kr(us)&&(us=null),xi.forEach(mm),vi.forEach(mm)}function Ar(e,t){e.blockedOn===t&&(e.blockedOn=null,tu||(tu=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,ky)))}var Dr=null;function pm(e){Dr!==e&&(Dr=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Dr===e&&(Dr=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],r=e[t+2];if(typeof a!="function"){if(eu(a||n)===null)continue;break}var c=nn(n);c!==null&&(e.splice(t,3),t-=3,Po(c,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function bl(e){function t(N){return Ar(N,e)}os!==null&&Ar(os,e),cs!==null&&Ar(cs,e),us!==null&&Ar(us,e),xi.forEach(t),vi.forEach(t);for(var n=0;n<ds.length;n++){var a=ds[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<ds.length&&(n=ds[0],n.blockedOn===null);)hm(n),n.blockedOn===null&&ds.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(a=0;a<n.length;a+=3){var r=n[a],c=n[a+1],d=r[Vt]||null;if(typeof c=="function")d||pm(n);else if(d){var p=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[Vt]||null)p=d.formAction;else if(eu(r)!==null)continue}else p=d.action;typeof p=="function"?n[a+1]=p:(n.splice(a,3),a-=3),pm(n)}}}function gm(){function e(c){c.canIntercept&&c.info==="react-transition"&&c.intercept({handler:function(){return new Promise(function(d){return r=d})},focusReset:"manual",scroll:"manual"})}function t(){r!==null&&(r(),r=null),a||setTimeout(n,20)}function n(){if(!a&&!navigation.transition){var c=navigation.currentEntry;c&&c.url!=null&&navigation.navigate(c.url,{state:c.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var a=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),r!==null&&(r(),r=null)}}}function nu(e){this._internalRoot=e}Or.prototype.render=nu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(u(409));var n=t.current,a=Hn();rm(n,a,e,t,null,null)},Or.prototype.unmount=nu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rm(e.current,2,null,e,null,null),fr(),t[vn]=null}};function Or(e){this._internalRoot=e}Or.prototype.unstable_scheduleHydration=function(e){if(e){var t=Gn();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ds.length&&t!==0&&t<ds[n].priority;n++);ds.splice(n,0,e),n===0&&hm(e)}};var ym=s.version;if(ym!=="19.2.4")throw Error(u(527,ym,"19.2.4"));M.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(u(188)):(e=Object.keys(e).join(","),Error(u(268,e)));return e=y(t),e=e!==null?S(e):null,e=e===null?null:e.stateNode,e};var Ay={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:v,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zr.isDisabled&&zr.supportsFiber)try{z=zr.inject(Ay),U=zr}catch{}}return ji.createRoot=function(e,t){if(!f(e))throw Error(u(299));var n=!1,a="",r=Nf,c=_f,d=Ef;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError)),t=lm(e,1,!1,null,null,n,a,null,r,c,d,gm),e[vn]=t.current,Lc(e),new nu(t)},ji.hydrateRoot=function(e,t,n){if(!f(e))throw Error(u(299));var a=!1,r="",c=Nf,d=_f,p=Ef,N=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(p=n.onRecoverableError),n.formState!==void 0&&(N=n.formState)),t=lm(e,1,!0,t,n??null,a,r,N,c,d,p,gm),t.context=im(null),n=t.current,a=Hn(),a=Mn(a),r=Ja(a),r.callback=null,Ia(n,r,a),n=a,t.current.lanes=n,Lt(t,n),va(t),e[vn]=t.current,Lc(e),new Or(t)},ji.version="19.2.4",ji}var Cm;function Hy(){if(Cm)return lu.exports;Cm=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(s){console.error(s)}}return o(),lu.exports=$y(),lu.exports}var Vy=Hy();const Gy="modulepreload",Yy=function(o){return"/"+o},Tm={},Rt=function(s,i,u){let f=Promise.resolve();if(i&&i.length>0){let E=function(y){return Promise.all(y.map(S=>Promise.resolve(S).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const x=document.querySelector("meta[property=csp-nonce]"),w=x?.nonce||x?.getAttribute("nonce");f=E(i.map(y=>{if(y=Yy(y),y in Tm)return;Tm[y]=!0;const S=y.endsWith(".css"),b=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${b}`))return;const G=document.createElement("link");if(G.rel=S?"stylesheet":Gy,S||(G.as="script"),G.crossOrigin="",G.href=y,w&&G.setAttribute("nonce",w),document.head.appendChild(G),S)return new Promise((L,ce)=>{G.addEventListener("load",L),G.addEventListener("error",()=>ce(new Error(`Unable to preload CSS for ${y}`)))})}))}function h(x){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=x,window.dispatchEvent(w),!w.defaultPrevented)throw x}return f.then(x=>{for(const w of x||[])w.status==="rejected"&&h(w.reason);return s().catch(h)})};const Jm=(...o)=>o.filter((s,i,u)=>!!s&&s.trim()!==""&&u.indexOf(s)===i).join(" ").trim();const Xy=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const Qy=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,i,u)=>u?u.toUpperCase():i.toLowerCase());const km=o=>{const s=Qy(o);return s.charAt(0).toUpperCase()+s.slice(1)};var Fy={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Zy=o=>{for(const s in o)if(s.startsWith("aria-")||s==="role"||s==="title")return!0;return!1};const Ky=m.forwardRef(({color:o="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:u,className:f="",children:h,iconNode:x,...w},E)=>m.createElement("svg",{ref:E,...Fy,width:s,height:s,stroke:o,strokeWidth:u?Number(i)*24/Number(s):i,className:Jm("lucide",f),...!h&&!Zy(w)&&{"aria-hidden":"true"},...w},[...x.map(([y,S])=>m.createElement(y,S)),...Array.isArray(h)?h:[h]]));const Ct=(o,s)=>{const i=m.forwardRef(({className:u,...f},h)=>m.createElement(Ky,{ref:h,iconNode:s,className:Jm(`lucide-${Xy(km(o))}`,`lucide-${o}`,u),...f}));return i.displayName=km(o),i};const Jy=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Iy=Ct("bold",Jy);const Wy=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kr=Ct("chevron-down",Wy);const Py=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],_l=Ct("chevron-left",Py);const eb=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ku=Ct("chevron-right",eb);const tb=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Im=Ct("chevron-up",tb);const nb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],fa=Ct("circle-alert",nb);const ab=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Wm=Ct("circle-check-big",ab);const sb=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],lb=Ct("download",sb);const ib=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Am=Ct("file-text",ib);const rb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],cu=Ct("info",rb);const ob=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],cb=Ct("italic",ob);const ub=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],db=Ct("list-ordered",ub);const fb=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],hb=Ct("list",fb);const mb=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],pb=Ct("lock",mb);const gb=[["path",{d:"M5 12h14",key:"1ays0h"}]],yb=Ct("minus",gb);const bb=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Bs=Ct("plus",bb);const xb=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],vb=Ct("redo-2",xb);const wb=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Pm=Ct("save",wb);const Sb=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],jb=Ct("square",Sb);const Nb=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ls=Ct("trash-2",Nb);const _b=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ep=Ct("trending-up",_b);const Eb=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],Cb=Ct("underline",Eb);const Tb=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],kb=Ct("undo-2",Tb);const Ab=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Jr=Ct("x",Ab);const Db=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],tp=Ct("zap",Db);function cn(o,s,i,u){if(typeof s=="function"?o!==s||!u:!s.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?u:i==="a"?u.call(o):u?u.value:s.get(o)}function jl(o,s,i,u,f){if(typeof s=="function"?o!==s||!0:!s.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s.set(o,i),i}var Ms,ea,xl,Mr,$r;const yn="__TAURI_TO_IPC_KEY__";function Au(o,s=!1){return window.__TAURI_INTERNALS__.transformCallback(o,s)}class np{constructor(s){Ms.set(this,void 0),ea.set(this,0),xl.set(this,[]),Mr.set(this,void 0),jl(this,Ms,s||(()=>{})),this.id=Au(i=>{const u=i.index;if("end"in i){u==cn(this,ea,"f")?this.cleanupCallback():jl(this,Mr,u);return}const f=i.message;if(u==cn(this,ea,"f")){for(cn(this,Ms,"f").call(this,f),jl(this,ea,cn(this,ea,"f")+1);cn(this,ea,"f")in cn(this,xl,"f");){const h=cn(this,xl,"f")[cn(this,ea,"f")];cn(this,Ms,"f").call(this,h),delete cn(this,xl,"f")[cn(this,ea,"f")],jl(this,ea,cn(this,ea,"f")+1)}cn(this,ea,"f")===cn(this,Mr,"f")&&this.cleanupCallback()}else cn(this,xl,"f")[u]=f})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(s){jl(this,Ms,s)}get onmessage(){return cn(this,Ms,"f")}[(Ms=new WeakMap,ea=new WeakMap,xl=new WeakMap,Mr=new WeakMap,yn)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[yn]()}}class pu{constructor(s,i,u){this.plugin=s,this.event=i,this.channelId=u}async unregister(){return pe(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function Ob(o,s,i){const u=new np(i);try{return await pe(`plugin:${o}|register_listener`,{event:s,handler:u}),new pu(o,s,u.id)}catch{return await pe(`plugin:${o}|registerListener`,{event:s,handler:u}),new pu(o,s,u.id)}}async function zb(o){return pe(`plugin:${o}|check_permissions`)}async function Mb(o){return pe(`plugin:${o}|request_permissions`)}async function pe(o,s={},i){return window.__TAURI_INTERNALS__.invoke(o,s,i)}function Rb(o,s="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(o,s)}class ap{get rid(){return cn(this,$r,"f")}constructor(s){$r.set(this,void 0),jl(this,$r,s)}async close(){return pe("plugin:resources|close",{rid:this.rid})}}$r=new WeakMap;function Ub(){return!!(globalThis||window).isTauri}const qa=Object.freeze(Object.defineProperty({__proto__:null,Channel:np,PluginListener:pu,Resource:ap,SERIALIZE_TO_IPC_FN:yn,addPluginListener:Ob,checkPermissions:zb,convertFileSrc:Rb,invoke:pe,isTauri:Ub,requestPermissions:Mb,transformCallback:Au},Symbol.toStringTag,{value:"Module"}));class Du{constructor(...s){this.type="Logical",s.length===1?"Logical"in s[0]?(this.width=s[0].Logical.width,this.height=s[0].Logical.height):(this.width=s[0].width,this.height=s[0].height):(this.width=s[0],this.height=s[1])}toPhysical(s){return new hs(this.width*s,this.height*s)}[yn](){return{width:this.width,height:this.height}}toJSON(){return this[yn]()}}class hs{constructor(...s){this.type="Physical",s.length===1?"Physical"in s[0]?(this.width=s[0].Physical.width,this.height=s[0].Physical.height):(this.width=s[0].width,this.height=s[0].height):(this.width=s[0],this.height=s[1])}toLogical(s){return new Du(this.width/s,this.height/s)}[yn](){return{width:this.width,height:this.height}}toJSON(){return this[yn]()}}class vl{constructor(s){this.size=s}toLogical(s){return this.size instanceof Du?this.size:this.size.toLogical(s)}toPhysical(s){return this.size instanceof hs?this.size:this.size.toPhysical(s)}[yn](){return{[`${this.size.type}`]:{width:this.size.width,height:this.size.height}}}toJSON(){return this[yn]()}}class Ou{constructor(...s){this.type="Logical",s.length===1?"Logical"in s[0]?(this.x=s[0].Logical.x,this.y=s[0].Logical.y):(this.x=s[0].x,this.y=s[0].y):(this.x=s[0],this.y=s[1])}toPhysical(s){return new ta(this.x*s,this.y*s)}[yn](){return{x:this.x,y:this.y}}toJSON(){return this[yn]()}}class ta{constructor(...s){this.type="Physical",s.length===1?"Physical"in s[0]?(this.x=s[0].Physical.x,this.y=s[0].Physical.y):(this.x=s[0].x,this.y=s[0].y):(this.x=s[0],this.y=s[1])}toLogical(s){return new Ou(this.x/s,this.y/s)}[yn](){return{x:this.x,y:this.y}}toJSON(){return this[yn]()}}class Rr{constructor(s){this.position=s}toLogical(s){return this.position instanceof Ou?this.position:this.position.toLogical(s)}toPhysical(s){return this.position instanceof ta?this.position:this.position.toPhysical(s)}[yn](){return{[`${this.position.type}`]:{x:this.position.x,y:this.position.y}}}toJSON(){return this[yn]()}}var An;(function(o){o.WINDOW_RESIZED="tauri://resize",o.WINDOW_MOVED="tauri://move",o.WINDOW_CLOSE_REQUESTED="tauri://close-requested",o.WINDOW_DESTROYED="tauri://destroyed",o.WINDOW_FOCUS="tauri://focus",o.WINDOW_BLUR="tauri://blur",o.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",o.WINDOW_THEME_CHANGED="tauri://theme-changed",o.WINDOW_CREATED="tauri://window-created",o.WEBVIEW_CREATED="tauri://webview-created",o.DRAG_ENTER="tauri://drag-enter",o.DRAG_OVER="tauri://drag-over",o.DRAG_DROP="tauri://drag-drop",o.DRAG_LEAVE="tauri://drag-leave"})(An||(An={}));async function sp(o,s){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(o,s),await pe("plugin:event|unlisten",{event:o,eventId:s})}async function zu(o,s,i){var u;const f=typeof i?.target=="string"?{kind:"AnyLabel",label:i.target}:(u=i?.target)!==null&&u!==void 0?u:{kind:"Any"};return pe("plugin:event|listen",{event:o,target:f,handler:Au(s)}).then(h=>async()=>sp(o,h))}async function lp(o,s,i){return zu(o,u=>{sp(o,u.id),s(u)},i)}async function ip(o,s){await pe("plugin:event|emit",{event:o,payload:s})}async function rp(o,s,i){await pe("plugin:event|emit_to",{target:typeof o=="string"?{kind:"AnyLabel",label:o}:o,event:s,payload:i})}const Lb=Object.freeze(Object.defineProperty({__proto__:null,get TauriEvent(){return An},emit:ip,emitTo:rp,listen:zu,once:lp},Symbol.toStringTag,{value:"Module"}));class Ei extends ap{constructor(s){super(s)}static async new(s,i,u){return pe("plugin:image|new",{rgba:Qr(s),width:i,height:u}).then(f=>new Ei(f))}static async fromBytes(s){return pe("plugin:image|from_bytes",{bytes:Qr(s)}).then(i=>new Ei(i))}static async fromPath(s){return pe("plugin:image|from_path",{path:s}).then(i=>new Ei(i))}async rgba(){return pe("plugin:image|rgba",{rid:this.rid}).then(s=>new Uint8Array(s))}async size(){return pe("plugin:image|size",{rid:this.rid})}}function Qr(o){return o==null?null:typeof o=="string"?o:o instanceof Ei?o.rid:o}var Fr;(function(o){o[o.Critical=1]="Critical",o[o.Informational=2]="Informational"})(Fr||(Fr={}));class op{constructor(s){this._preventDefault=!1,this.event=s.event,this.id=s.id}preventDefault(){this._preventDefault=!0}isPreventDefault(){return this._preventDefault}}var gu;(function(o){o.None="none",o.Normal="normal",o.Indeterminate="indeterminate",o.Paused="paused",o.Error="error"})(gu||(gu={}));function Mu(){return new Ru(window.__TAURI_INTERNALS__.metadata.currentWindow.label,{skip:!0})}async function Hr(){return pe("plugin:window|get_all_windows").then(o=>o.map(s=>new Ru(s,{skip:!0})))}const uu=["tauri://created","tauri://error"];class Ru{constructor(s,i={}){var u;this.label=s,this.listeners=Object.create(null),i?.skip||pe("plugin:window|create",{options:{...i,parent:typeof i.parent=="string"?i.parent:(u=i.parent)===null||u===void 0?void 0:u.label,label:s}}).then(async()=>this.emit("tauri://created")).catch(async f=>this.emit("tauri://error",f))}static async getByLabel(s){var i;return(i=(await Hr()).find(u=>u.label===s))!==null&&i!==void 0?i:null}static getCurrent(){return Mu()}static async getAll(){return Hr()}static async getFocusedWindow(){for(const s of await Hr())if(await s.isFocused())return s;return null}async listen(s,i){return this._handleTauriEvent(s,i)?()=>{const u=this.listeners[s];u.splice(u.indexOf(i),1)}:zu(s,i,{target:{kind:"Window",label:this.label}})}async once(s,i){return this._handleTauriEvent(s,i)?()=>{const u=this.listeners[s];u.splice(u.indexOf(i),1)}:lp(s,i,{target:{kind:"Window",label:this.label}})}async emit(s,i){if(uu.includes(s)){for(const u of this.listeners[s]||[])u({event:s,id:-1,payload:i});return}return ip(s,i)}async emitTo(s,i,u){if(uu.includes(i)){for(const f of this.listeners[i]||[])f({event:i,id:-1,payload:u});return}return rp(s,i,u)}_handleTauriEvent(s,i){return uu.includes(s)?(s in this.listeners?this.listeners[s].push(i):this.listeners[s]=[i],!0):!1}async scaleFactor(){return pe("plugin:window|scale_factor",{label:this.label})}async innerPosition(){return pe("plugin:window|inner_position",{label:this.label}).then(s=>new ta(s))}async outerPosition(){return pe("plugin:window|outer_position",{label:this.label}).then(s=>new ta(s))}async innerSize(){return pe("plugin:window|inner_size",{label:this.label}).then(s=>new hs(s))}async outerSize(){return pe("plugin:window|outer_size",{label:this.label}).then(s=>new hs(s))}async isFullscreen(){return pe("plugin:window|is_fullscreen",{label:this.label})}async isMinimized(){return pe("plugin:window|is_minimized",{label:this.label})}async isMaximized(){return pe("plugin:window|is_maximized",{label:this.label})}async isFocused(){return pe("plugin:window|is_focused",{label:this.label})}async isDecorated(){return pe("plugin:window|is_decorated",{label:this.label})}async isResizable(){return pe("plugin:window|is_resizable",{label:this.label})}async isMaximizable(){return pe("plugin:window|is_maximizable",{label:this.label})}async isMinimizable(){return pe("plugin:window|is_minimizable",{label:this.label})}async isClosable(){return pe("plugin:window|is_closable",{label:this.label})}async isVisible(){return pe("plugin:window|is_visible",{label:this.label})}async title(){return pe("plugin:window|title",{label:this.label})}async theme(){return pe("plugin:window|theme",{label:this.label})}async isAlwaysOnTop(){return pe("plugin:window|is_always_on_top",{label:this.label})}async center(){return pe("plugin:window|center",{label:this.label})}async requestUserAttention(s){let i=null;return s&&(s===Fr.Critical?i={type:"Critical"}:i={type:"Informational"}),pe("plugin:window|request_user_attention",{label:this.label,value:i})}async setResizable(s){return pe("plugin:window|set_resizable",{label:this.label,value:s})}async setEnabled(s){return pe("plugin:window|set_enabled",{label:this.label,value:s})}async isEnabled(){return pe("plugin:window|is_enabled",{label:this.label})}async setMaximizable(s){return pe("plugin:window|set_maximizable",{label:this.label,value:s})}async setMinimizable(s){return pe("plugin:window|set_minimizable",{label:this.label,value:s})}async setClosable(s){return pe("plugin:window|set_closable",{label:this.label,value:s})}async setTitle(s){return pe("plugin:window|set_title",{label:this.label,value:s})}async maximize(){return pe("plugin:window|maximize",{label:this.label})}async unmaximize(){return pe("plugin:window|unmaximize",{label:this.label})}async toggleMaximize(){return pe("plugin:window|toggle_maximize",{label:this.label})}async minimize(){return pe("plugin:window|minimize",{label:this.label})}async unminimize(){return pe("plugin:window|unminimize",{label:this.label})}async show(){return pe("plugin:window|show",{label:this.label})}async hide(){return pe("plugin:window|hide",{label:this.label})}async close(){return pe("plugin:window|close",{label:this.label})}async destroy(){return pe("plugin:window|destroy",{label:this.label})}async setDecorations(s){return pe("plugin:window|set_decorations",{label:this.label,value:s})}async setShadow(s){return pe("plugin:window|set_shadow",{label:this.label,value:s})}async setEffects(s){return pe("plugin:window|set_effects",{label:this.label,value:s})}async clearEffects(){return pe("plugin:window|set_effects",{label:this.label,value:null})}async setAlwaysOnTop(s){return pe("plugin:window|set_always_on_top",{label:this.label,value:s})}async setAlwaysOnBottom(s){return pe("plugin:window|set_always_on_bottom",{label:this.label,value:s})}async setContentProtected(s){return pe("plugin:window|set_content_protected",{label:this.label,value:s})}async setSize(s){return pe("plugin:window|set_size",{label:this.label,value:s instanceof vl?s:new vl(s)})}async setMinSize(s){return pe("plugin:window|set_min_size",{label:this.label,value:s instanceof vl?s:s?new vl(s):null})}async setMaxSize(s){return pe("plugin:window|set_max_size",{label:this.label,value:s instanceof vl?s:s?new vl(s):null})}async setSizeConstraints(s){function i(u){return u?{Logical:u}:null}return pe("plugin:window|set_size_constraints",{label:this.label,value:{minWidth:i(s?.minWidth),minHeight:i(s?.minHeight),maxWidth:i(s?.maxWidth),maxHeight:i(s?.maxHeight)}})}async setPosition(s){return pe("plugin:window|set_position",{label:this.label,value:s instanceof Rr?s:new Rr(s)})}async setFullscreen(s){return pe("plugin:window|set_fullscreen",{label:this.label,value:s})}async setSimpleFullscreen(s){return pe("plugin:window|set_simple_fullscreen",{label:this.label,value:s})}async setFocus(){return pe("plugin:window|set_focus",{label:this.label})}async setFocusable(s){return pe("plugin:window|set_focusable",{label:this.label,value:s})}async setIcon(s){return pe("plugin:window|set_icon",{label:this.label,value:Qr(s)})}async setSkipTaskbar(s){return pe("plugin:window|set_skip_taskbar",{label:this.label,value:s})}async setCursorGrab(s){return pe("plugin:window|set_cursor_grab",{label:this.label,value:s})}async setCursorVisible(s){return pe("plugin:window|set_cursor_visible",{label:this.label,value:s})}async setCursorIcon(s){return pe("plugin:window|set_cursor_icon",{label:this.label,value:s})}async setBackgroundColor(s){return pe("plugin:window|set_background_color",{color:s})}async setCursorPosition(s){return pe("plugin:window|set_cursor_position",{label:this.label,value:s instanceof Rr?s:new Rr(s)})}async setIgnoreCursorEvents(s){return pe("plugin:window|set_ignore_cursor_events",{label:this.label,value:s})}async startDragging(){return pe("plugin:window|start_dragging",{label:this.label})}async startResizeDragging(s){return pe("plugin:window|start_resize_dragging",{label:this.label,value:s})}async setBadgeCount(s){return pe("plugin:window|set_badge_count",{label:this.label,value:s})}async setBadgeLabel(s){return pe("plugin:window|set_badge_label",{label:this.label,value:s})}async setOverlayIcon(s){return pe("plugin:window|set_overlay_icon",{label:this.label,value:s?Qr(s):void 0})}async setProgressBar(s){return pe("plugin:window|set_progress_bar",{label:this.label,value:s})}async setVisibleOnAllWorkspaces(s){return pe("plugin:window|set_visible_on_all_workspaces",{label:this.label,value:s})}async setTitleBarStyle(s){return pe("plugin:window|set_title_bar_style",{label:this.label,value:s})}async setTheme(s){return pe("plugin:window|set_theme",{label:this.label,value:s})}async onResized(s){return this.listen(An.WINDOW_RESIZED,i=>{i.payload=new hs(i.payload),s(i)})}async onMoved(s){return this.listen(An.WINDOW_MOVED,i=>{i.payload=new ta(i.payload),s(i)})}async onCloseRequested(s){return this.listen(An.WINDOW_CLOSE_REQUESTED,async i=>{const u=new op(i);await s(u),u.isPreventDefault()||await this.destroy()})}async onDragDropEvent(s){const i=await this.listen(An.DRAG_ENTER,x=>{s({...x,payload:{type:"enter",paths:x.payload.paths,position:new ta(x.payload.position)}})}),u=await this.listen(An.DRAG_OVER,x=>{s({...x,payload:{type:"over",position:new ta(x.payload.position)}})}),f=await this.listen(An.DRAG_DROP,x=>{s({...x,payload:{type:"drop",paths:x.payload.paths,position:new ta(x.payload.position)}})}),h=await this.listen(An.DRAG_LEAVE,x=>{s({...x,payload:{type:"leave"}})});return()=>{i(),f(),u(),h()}}async onFocusChanged(s){const i=await this.listen(An.WINDOW_FOCUS,f=>{s({...f,payload:!0})}),u=await this.listen(An.WINDOW_BLUR,f=>{s({...f,payload:!1})});return()=>{i(),u()}}async onScaleChanged(s){return this.listen(An.WINDOW_SCALE_FACTOR_CHANGED,s)}async onThemeChanged(s){return this.listen(An.WINDOW_THEME_CHANGED,s)}}var Dm;(function(o){o.Disabled="disabled",o.Throttle="throttle",o.Suspend="suspend"})(Dm||(Dm={}));var Om;(function(o){o.Default="default",o.FluentOverlay="fluentOverlay"})(Om||(Om={}));var yu;(function(o){o.AppearanceBased="appearanceBased",o.Light="light",o.Dark="dark",o.MediumLight="mediumLight",o.UltraDark="ultraDark",o.Titlebar="titlebar",o.Selection="selection",o.Menu="menu",o.Popover="popover",o.Sidebar="sidebar",o.HeaderView="headerView",o.Sheet="sheet",o.WindowBackground="windowBackground",o.HudWindow="hudWindow",o.FullScreenUI="fullScreenUI",o.Tooltip="tooltip",o.ContentBackground="contentBackground",o.UnderWindowBackground="underWindowBackground",o.UnderPageBackground="underPageBackground",o.Mica="mica",o.Blur="blur",o.Acrylic="acrylic",o.Tabbed="tabbed",o.TabbedDark="tabbedDark",o.TabbedLight="tabbedLight"})(yu||(yu={}));var bu;(function(o){o.FollowsWindowActiveState="followsWindowActiveState",o.Active="active",o.Inactive="inactive"})(bu||(bu={}));function Ir(o){return o===null?null:{name:o.name,scaleFactor:o.scaleFactor,position:new ta(o.position),size:new hs(o.size),workArea:{position:new ta(o.workArea.position),size:new hs(o.workArea.size)}}}async function Bb(){return pe("plugin:window|current_monitor").then(Ir)}async function qb(){return pe("plugin:window|primary_monitor").then(Ir)}async function $b(o,s){return pe("plugin:window|monitor_from_point",{x:o,y:s}).then(Ir)}async function Hb(){return pe("plugin:window|available_monitors").then(o=>o.map(Ir))}async function Vb(){return pe("plugin:window|cursor_position").then(o=>new ta(o))}const zm=Object.freeze(Object.defineProperty({__proto__:null,CloseRequestedEvent:op,get Effect(){return yu},get EffectState(){return bu},LogicalPosition:Ou,LogicalSize:Du,PhysicalPosition:ta,PhysicalSize:hs,get ProgressBarStatus(){return gu},get UserAttentionType(){return Fr},Window:Ru,availableMonitors:Hb,currentMonitor:Bb,cursorPosition:Vb,getAllWindows:Hr,getCurrentWindow:Mu,monitorFromPoint:$b,primaryMonitor:qb},Symbol.toStringTag,{value:"Module"}));function El({title:o="TALUS TALLY",isDirty:s=!1,onClose:i}){const u=async()=>{try{await pe("minimize_window")}catch(w){console.error("Failed to minimize:",w)}},f=async()=>{try{await pe("maximize_window")}catch(w){console.error("Failed to maximize:",w)}},h=async()=>{if(console.log("TitleBar handleClose called, onClose exists:",!!i),i){i();return}console.log("Using default close behavior");try{await pe("exit_app")}catch(w){console.error("Failed to close:",w)}},x=async w=>{if(w.button!==0)return;const E=w.target;if(!(E&&E.closest("button")))try{await Mu().startDragging()}catch(y){console.warn("Failed to start dragging:",y)}};return l.jsxs("header",{className:"h-titlebar bg-bg-light border-b-2 border-accent-primary px-3 flex items-center justify-between select-none cursor-move","data-tauri-drag-region":!0,onMouseDown:x,children:[l.jsx("div",{className:"flex-1"}),l.jsx("h1",{className:"font-display text-lg font-bold tracking-wide text-fg-primary",children:o}),l.jsxs("div",{className:"flex-1 flex justify-end gap-0",style:{cursor:"pointer"},children:[l.jsx("button",{"data-tauri-drag-region":"false",onClick:u,className:"w-10 h-10 flex items-center justify-center hover:bg-bg-selection transition-colors","aria-label":"Minimize",title:"Minimize",children:l.jsx(yb,{size:16,className:"text-fg-primary"})}),l.jsx("button",{"data-tauri-drag-region":"false",onClick:f,className:"w-10 h-10 flex items-center justify-center hover:bg-bg-selection transition-colors","aria-label":"Maximize",title:"Maximize",children:l.jsx(jb,{size:16,className:"text-fg-primary"})}),l.jsx("button",{"data-tauri-drag-region":"false",onClick:h,className:"w-10 h-10 flex items-center justify-center hover:bg-status-danger transition-colors","aria-label":"Close",title:"Close",children:l.jsx(Jr,{size:16,className:"text-fg-primary"})})]})]})}function cp({item:o,onItemClick:s,depth:i=0}){const[u,f]=m.useState(!1),h=o.submenu&&o.submenu.length>0;return o.label==="---"?l.jsx("div",{className:"border-t border-border my-1"}):l.jsxs("div",{className:"relative group",children:[l.jsxs("button",{onClick:()=>{h?f(!u):(o.onClick?.(),s())},onMouseEnter:()=>h&&f(!0),onMouseLeave:()=>h&&f(!1),className:"w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-bg-selection hover:text-accent-hover transition-colors flex items-center justify-between whitespace-nowrap",children:[l.jsx("span",{children:o.label}),h&&l.jsx(ku,{size:14,className:"ml-2 opacity-50"})]}),h&&u&&l.jsx("div",{className:"absolute top-0 left-full bg-bg-light border border-border rounded-sm ml-0.5 min-w-max z-50 shadow-lg",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:o.submenu.map((w,E)=>l.jsx(cp,{item:w,onItemClick:s,depth:i+1},E))})]})}function Gb({menus:o}){const[s,i]=m.useState(null),u=m.useRef(null);return m.useEffect(()=>{const f=h=>{u.current&&!u.current.contains(h.target)&&i(null)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),l.jsx("nav",{className:"h-menubar bg-bg-light border-b border-border flex items-center",ref:u,children:l.jsx("div",{className:"flex h-full",children:Object.entries(o).map(([f,h])=>l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>i(s===f?null:f),className:"h-full px-3 font-display text-sm text-fg-primary hover:text-accent-hover hover:bg-bg-selection transition-colors flex items-center gap-1",children:[f,h.length>0&&l.jsx(Kr,{size:12,className:"opacity-50"})]}),s===f&&l.jsx("div",{className:"absolute top-full left-0 bg-bg-light border border-border rounded-sm mt-0.5 min-w-max z-50 shadow-lg",children:h.map((x,w)=>l.jsx(cp,{item:x,onItemClick:()=>i(null)},w))})]},f))})})}const Yb=[];function Xb({buttons:o=Yb,activeView:s="graph",onViewChange:i,activeToolsTab:u="velocity",onToolsTabChange:f,blockingNodeCount:h=0,blockingEdgeCount:x=0,onBlockingFitToView:w}){return l.jsxs("div",{className:"h-toolbar bg-bg-light border-b border-border px-2 flex items-center gap-4",children:[s==="tools"&&f&&l.jsxs("div",{className:"flex items-center bg-bg-dark border border-border rounded p-1",children:[l.jsxs("button",{onClick:()=>f("velocity"),className:`px-3 py-1.5 rounded text-sm font-semibold transition-colors flex items-center gap-2 ${u==="velocity"?"bg-accent-primary text-fg-primary":"text-fg-secondary hover:text-fg-primary"}`,title:"Switch to velocity view",children:[l.jsx(ep,{size:16}),"Velocity"]}),l.jsxs("button",{onClick:()=>f("blocking"),className:`px-3 py-1.5 rounded text-sm font-semibold transition-colors flex items-center gap-2 ${u==="blocking"?"bg-accent-primary text-fg-primary":"text-fg-secondary hover:text-fg-primary"}`,title:"Switch to blocking view",children:[l.jsx(tp,{size:16}),"Blocking"]})]}),s==="tools"&&u==="blocking"&&l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>w?.(),disabled:!w,className:"px-3 py-1.5 bg-accent-primary text-fg-primary text-xs font-semibold rounded hover:bg-accent-hover transition-colors",title:"Fit graph to view",children:"Fit to View"}),l.jsxs("div",{className:"text-xs text-fg-secondary",children:[h," nodes  ",x," relationships"]})]}),l.jsx("div",{className:"flex-1"}),i&&l.jsxs("div",{className:"flex items-center bg-bg-dark border border-border rounded p-1",children:[l.jsx("button",{onClick:()=>i("graph"),className:`px-3 py-1.5 rounded text-sm font-semibold transition-colors ${s==="graph"?"bg-accent-primary text-fg-primary":"text-fg-secondary hover:text-fg-primary hover:bg-bg-selection"}`,title:"Switch to tree view",children:"Tree"}),l.jsx("button",{onClick:()=>i("tools"),className:`px-3 py-1.5 rounded text-sm font-semibold transition-colors ${s==="tools"?"bg-accent-primary text-fg-primary":"text-fg-secondary hover:text-fg-primary hover:bg-bg-selection"}`,title:"Switch to tools view",children:"Tools"})]})]})}const Sa=Object.create(null);Sa.open="0";Sa.close="1";Sa.ping="2";Sa.pong="3";Sa.message="4";Sa.upgrade="5";Sa.noop="6";const Vr=Object.create(null);Object.keys(Sa).forEach(o=>{Vr[Sa[o]]=o});const xu={type:"error",data:"parser error"},up=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",dp=typeof ArrayBuffer=="function",fp=o=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer,Uu=({type:o,data:s},i,u)=>up&&s instanceof Blob?i?u(s):Mm(s,u):dp&&(s instanceof ArrayBuffer||fp(s))?i?u(s):Mm(new Blob([s]),u):u(Sa[o]+(s||"")),Mm=(o,s)=>{const i=new FileReader;return i.onload=function(){const u=i.result.split(",")[1];s("b"+(u||""))},i.readAsDataURL(o)};function Rm(o){return o instanceof Uint8Array?o:o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o.buffer,o.byteOffset,o.byteLength)}let du;function Qb(o,s){if(up&&o.data instanceof Blob)return o.data.arrayBuffer().then(Rm).then(s);if(dp&&(o.data instanceof ArrayBuffer||fp(o.data)))return s(Rm(o.data));Uu(o,!1,i=>{du||(du=new TextEncoder),s(du.encode(i))})}const Um="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_i=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let o=0;o<Um.length;o++)_i[Um.charCodeAt(o)]=o;const Fb=o=>{let s=o.length*.75,i=o.length,u,f=0,h,x,w,E;o[o.length-1]==="="&&(s--,o[o.length-2]==="="&&s--);const y=new ArrayBuffer(s),S=new Uint8Array(y);for(u=0;u<i;u+=4)h=_i[o.charCodeAt(u)],x=_i[o.charCodeAt(u+1)],w=_i[o.charCodeAt(u+2)],E=_i[o.charCodeAt(u+3)],S[f++]=h<<2|x>>4,S[f++]=(x&15)<<4|w>>2,S[f++]=(w&3)<<6|E&63;return y},Zb=typeof ArrayBuffer=="function",Lu=(o,s)=>{if(typeof o!="string")return{type:"message",data:hp(o,s)};const i=o.charAt(0);return i==="b"?{type:"message",data:Kb(o.substring(1),s)}:Vr[i]?o.length>1?{type:Vr[i],data:o.substring(1)}:{type:Vr[i]}:xu},Kb=(o,s)=>{if(Zb){const i=Fb(o);return hp(i,s)}else return{base64:!0,data:o}},hp=(o,s)=>s==="blob"?o instanceof Blob?o:new Blob([o]):o instanceof ArrayBuffer?o:o.buffer,mp="",Jb=(o,s)=>{const i=o.length,u=new Array(i);let f=0;o.forEach((h,x)=>{Uu(h,!1,w=>{u[x]=w,++f===i&&s(u.join(mp))})})},Ib=(o,s)=>{const i=o.split(mp),u=[];for(let f=0;f<i.length;f++){const h=Lu(i[f],s);if(u.push(h),h.type==="error")break}return u};function Wb(){return new TransformStream({transform(o,s){Qb(o,i=>{const u=i.length;let f;if(u<126)f=new Uint8Array(1),new DataView(f.buffer).setUint8(0,u);else if(u<65536){f=new Uint8Array(3);const h=new DataView(f.buffer);h.setUint8(0,126),h.setUint16(1,u)}else{f=new Uint8Array(9);const h=new DataView(f.buffer);h.setUint8(0,127),h.setBigUint64(1,BigInt(u))}o.data&&typeof o.data!="string"&&(f[0]|=128),s.enqueue(f),s.enqueue(i)})}})}let fu;function Ur(o){return o.reduce((s,i)=>s+i.length,0)}function Lr(o,s){if(o[0].length===s)return o.shift();const i=new Uint8Array(s);let u=0;for(let f=0;f<s;f++)i[f]=o[0][u++],u===o[0].length&&(o.shift(),u=0);return o.length&&u<o[0].length&&(o[0]=o[0].slice(u)),i}function Pb(o,s){fu||(fu=new TextDecoder);const i=[];let u=0,f=-1,h=!1;return new TransformStream({transform(x,w){for(i.push(x);;){if(u===0){if(Ur(i)<1)break;const E=Lr(i,1);h=(E[0]&128)===128,f=E[0]&127,f<126?u=3:f===126?u=1:u=2}else if(u===1){if(Ur(i)<2)break;const E=Lr(i,2);f=new DataView(E.buffer,E.byteOffset,E.length).getUint16(0),u=3}else if(u===2){if(Ur(i)<8)break;const E=Lr(i,8),y=new DataView(E.buffer,E.byteOffset,E.length),S=y.getUint32(0);if(S>Math.pow(2,21)-1){w.enqueue(xu);break}f=S*Math.pow(2,32)+y.getUint32(4),u=3}else{if(Ur(i)<f)break;const E=Lr(i,f);w.enqueue(Lu(h?E:fu.decode(E),s)),u=0}if(f===0||f>o){w.enqueue(xu);break}}}})}const pp=4;function Wt(o){if(o)return ex(o)}function ex(o){for(var s in Wt.prototype)o[s]=Wt.prototype[s];return o}Wt.prototype.on=Wt.prototype.addEventListener=function(o,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+o]=this._callbacks["$"+o]||[]).push(s),this};Wt.prototype.once=function(o,s){function i(){this.off(o,i),s.apply(this,arguments)}return i.fn=s,this.on(o,i),this};Wt.prototype.off=Wt.prototype.removeListener=Wt.prototype.removeAllListeners=Wt.prototype.removeEventListener=function(o,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+o];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+o],this;for(var u,f=0;f<i.length;f++)if(u=i[f],u===s||u.fn===s){i.splice(f,1);break}return i.length===0&&delete this._callbacks["$"+o],this};Wt.prototype.emit=function(o){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),i=this._callbacks["$"+o],u=1;u<arguments.length;u++)s[u-1]=arguments[u];if(i){i=i.slice(0);for(var u=0,f=i.length;u<f;++u)i[u].apply(this,s)}return this};Wt.prototype.emitReserved=Wt.prototype.emit;Wt.prototype.listeners=function(o){return this._callbacks=this._callbacks||{},this._callbacks["$"+o]||[]};Wt.prototype.hasListeners=function(o){return!!this.listeners(o).length};const Wr=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,i)=>i(s,0),na=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),tx="arraybuffer";function gp(o,...s){return s.reduce((i,u)=>(o.hasOwnProperty(u)&&(i[u]=o[u]),i),{})}const nx=na.setTimeout,ax=na.clearTimeout;function Pr(o,s){s.useNativeTimers?(o.setTimeoutFn=nx.bind(na),o.clearTimeoutFn=ax.bind(na)):(o.setTimeoutFn=na.setTimeout.bind(na),o.clearTimeoutFn=na.clearTimeout.bind(na))}const sx=1.33;function lx(o){return typeof o=="string"?ix(o):Math.ceil((o.byteLength||o.size)*sx)}function ix(o){let s=0,i=0;for(let u=0,f=o.length;u<f;u++)s=o.charCodeAt(u),s<128?i+=1:s<2048?i+=2:s<55296||s>=57344?i+=3:(u++,i+=4);return i}function yp(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function rx(o){let s="";for(let i in o)o.hasOwnProperty(i)&&(s.length&&(s+="&"),s+=encodeURIComponent(i)+"="+encodeURIComponent(o[i]));return s}function ox(o){let s={},i=o.split("&");for(let u=0,f=i.length;u<f;u++){let h=i[u].split("=");s[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return s}class cx extends Error{constructor(s,i,u){super(s),this.description=i,this.context=u,this.type="TransportError"}}class Bu extends Wt{constructor(s){super(),this.writable=!1,Pr(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,i,u){return super.emitReserved("error",new cx(s,i,u)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const i=Lu(s,this.socket.binaryType);this.onPacket(i)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,i={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(i)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const i=rx(s);return i.length?"?"+i:""}}class ux extends Bu{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const i=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let u=0;this._polling&&(u++,this.once("pollComplete",function(){--u||i()})),this.writable||(u++,this.once("drain",function(){--u||i()}))}else i()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const i=u=>{if(this.readyState==="opening"&&u.type==="open"&&this.onOpen(),u.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(u)};Ib(s,this.socket.binaryType).forEach(i),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,Jb(s,i=>{this.doWrite(i,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",i=this.query||{};return this.opts.timestampRequests!==!1&&(i[this.opts.timestampParam]=yp()),!this.supportsBinary&&!i.sid&&(i.b64=1),this.createUri(s,i)}}let bp=!1;try{bp=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const dx=bp;function fx(){}class hx extends ux{constructor(s){if(super(s),typeof location<"u"){const i=location.protocol==="https:";let u=location.port;u||(u=i?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||u!==s.port}}doWrite(s,i){const u=this.request({method:"POST",data:s});u.on("success",i),u.on("error",(f,h)=>{this.onError("xhr post error",f,h)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(i,u)=>{this.onError("xhr poll error",i,u)}),this.pollXhr=s}}class wa extends Wt{constructor(s,i,u){super(),this.createRequest=s,Pr(this,u),this._opts=u,this._method=u.method||"GET",this._uri=i,this._data=u.data!==void 0?u.data:null,this._create()}_create(){var s;const i=gp(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this._opts.xd;const u=this._xhr=this.createRequest(i);try{u.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){u.setDisableHeaderCheck&&u.setDisableHeaderCheck(!0);for(let f in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(f)&&u.setRequestHeader(f,this._opts.extraHeaders[f])}}catch{}if(this._method==="POST")try{u.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{u.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(u),"withCredentials"in u&&(u.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(u.timeout=this._opts.requestTimeout),u.onreadystatechange=()=>{var f;u.readyState===3&&((f=this._opts.cookieJar)===null||f===void 0||f.parseCookies(u.getResponseHeader("set-cookie"))),u.readyState===4&&(u.status===200||u.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof u.status=="number"?u.status:0)},0))},u.send(this._data)}catch(f){this.setTimeoutFn(()=>{this._onError(f)},0);return}typeof document<"u"&&(this._index=wa.requestsCount++,wa.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=fx,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete wa.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}wa.requestsCount=0;wa.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Lm);else if(typeof addEventListener=="function"){const o="onpagehide"in na?"pagehide":"unload";addEventListener(o,Lm,!1)}}function Lm(){for(let o in wa.requests)wa.requests.hasOwnProperty(o)&&wa.requests[o].abort()}const mx=(function(){const o=xp({xdomain:!1});return o&&o.responseType!==null})();class px extends hx{constructor(s){super(s);const i=s&&s.forceBase64;this.supportsBinary=mx&&!i}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new wa(xp,this.uri(),s)}}function xp(o){const s=o.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||dx))return new XMLHttpRequest}catch{}if(!s)try{return new na[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const vp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class gx extends Bu{get name(){return"websocket"}doOpen(){const s=this.uri(),i=this.opts.protocols,u=vp?{}:gp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(u.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,i,u)}catch(f){return this.emitReserved("error",f)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let i=0;i<s.length;i++){const u=s[i],f=i===s.length-1;Uu(u,this.supportsBinary,h=>{try{this.doWrite(u,h)}catch{}f&&Wr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",i=this.query||{};return this.opts.timestampRequests&&(i[this.opts.timestampParam]=yp()),this.supportsBinary||(i.b64=1),this.createUri(s,i)}}const hu=na.WebSocket||na.MozWebSocket;class yx extends gx{createSocket(s,i,u){return vp?new hu(s,i,u):i?new hu(s,i):new hu(s)}doWrite(s,i){this.ws.send(i)}}class bx extends Bu{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const i=Pb(Number.MAX_SAFE_INTEGER,this.socket.binaryType),u=s.readable.pipeThrough(i).getReader(),f=Wb();f.readable.pipeTo(s.writable),this._writer=f.writable.getWriter();const h=()=>{u.read().then(({done:w,value:E})=>{w||(this.onPacket(E),h())}).catch(w=>{})};h();const x={type:"open"};this.query.sid&&(x.data=`{"sid":"${this.query.sid}"}`),this._writer.write(x).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let i=0;i<s.length;i++){const u=s[i],f=i===s.length-1;this._writer.write(u).then(()=>{f&&Wr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const xx={websocket:yx,webtransport:bx,polling:px},vx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,wx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function vu(o){if(o.length>8e3)throw"URI too long";const s=o,i=o.indexOf("["),u=o.indexOf("]");i!=-1&&u!=-1&&(o=o.substring(0,i)+o.substring(i,u).replace(/:/g,";")+o.substring(u,o.length));let f=vx.exec(o||""),h={},x=14;for(;x--;)h[wx[x]]=f[x]||"";return i!=-1&&u!=-1&&(h.source=s,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=Sx(h,h.path),h.queryKey=jx(h,h.query),h}function Sx(o,s){const i=/\/{2,9}/g,u=s.replace(i,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&u.splice(0,1),s.slice(-1)=="/"&&u.splice(u.length-1,1),u}function jx(o,s){const i={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(u,f,h){f&&(i[f]=h)}),i}const wu=typeof addEventListener=="function"&&typeof removeEventListener=="function",Gr=[];wu&&addEventListener("offline",()=>{Gr.forEach(o=>o())},!1);class ms extends Wt{constructor(s,i){if(super(),this.binaryType=tx,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(i=s,s=null),s){const u=vu(s);i.hostname=u.host,i.secure=u.protocol==="https"||u.protocol==="wss",i.port=u.port,u.query&&(i.query=u.query)}else i.host&&(i.hostname=vu(i.host).host);Pr(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},i.transports.forEach(u=>{const f=u.prototype.name;this.transports.push(f),this._transportsByName[f]=u}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ox(this.opts.query)),wu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Gr.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const i=Object.assign({},this.opts.query);i.EIO=pp,i.transport=s,this.id&&(i.sid=this.id);const u=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](u)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&ms.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const i=this.createTransport(s);i.open(),this.setTransport(i)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",i=>this._onClose("transport close",i))}onOpen(){this.readyState="open",ms.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const i=new Error("server error");i.code=s.data,this._onError(i);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let u=0;u<this.writeBuffer.length;u++){const f=this.writeBuffer[u].data;if(f&&(i+=lx(f)),u>0&&i>this._maxPayload)return this.writeBuffer.slice(0,u);i+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,Wr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,i,u){return this._sendPacket("message",s,i,u),this}send(s,i,u){return this._sendPacket("message",s,i,u),this}_sendPacket(s,i,u,f){if(typeof i=="function"&&(f=i,i=void 0),typeof u=="function"&&(f=u,u=null),this.readyState==="closing"||this.readyState==="closed")return;u=u||{},u.compress=u.compress!==!1;const h={type:s,data:i,options:u};this.emitReserved("packetCreate",h),this.writeBuffer.push(h),f&&this.once("flush",f),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),s()},u=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?u():s()}):this.upgrading?u():s()),this}_onError(s){if(ms.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,i){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),wu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const u=Gr.indexOf(this._offlineEventListener);u!==-1&&Gr.splice(u,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,i),this.writeBuffer=[],this._prevBufferLen=0}}}ms.protocol=pp;class Nx extends ms{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let i=this.createTransport(s),u=!1;ms.priorWebsocketSuccess=!1;const f=()=>{u||(i.send([{type:"ping",data:"probe"}]),i.once("packet",b=>{if(!u)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;ms.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{u||this.readyState!=="closed"&&(S(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const G=new Error("probe error");G.transport=i.name,this.emitReserved("upgradeError",G)}}))};function h(){u||(u=!0,S(),i.close(),i=null)}const x=b=>{const G=new Error("probe error: "+b);G.transport=i.name,h(),this.emitReserved("upgradeError",G)};function w(){x("transport closed")}function E(){x("socket closed")}function y(b){i&&b.name!==i.name&&h()}const S=()=>{i.removeListener("open",f),i.removeListener("error",x),i.removeListener("close",w),this.off("close",E),this.off("upgrading",y)};i.once("open",f),i.once("error",x),i.once("close",w),this.once("close",E),this.once("upgrading",y),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{u||i.open()},200):i.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const i=[];for(let u=0;u<s.length;u++)~this.transports.indexOf(s[u])&&i.push(s[u]);return i}}let _x=class extends Nx{constructor(s,i={}){const u=typeof s=="object"?s:i;(!u.transports||u.transports&&typeof u.transports[0]=="string")&&(u.transports=(u.transports||["polling","websocket","webtransport"]).map(f=>xx[f]).filter(f=>!!f)),super(s,u)}};function Ex(o,s="",i){let u=o;i=i||typeof location<"u"&&location,o==null&&(o=i.protocol+"//"+i.host),typeof o=="string"&&(o.charAt(0)==="/"&&(o.charAt(1)==="/"?o=i.protocol+o:o=i.host+o),/^(https?|wss?):\/\//.test(o)||(typeof i<"u"?o=i.protocol+"//"+o:o="https://"+o),u=vu(o)),u.port||(/^(http|ws)$/.test(u.protocol)?u.port="80":/^(http|ws)s$/.test(u.protocol)&&(u.port="443")),u.path=u.path||"/";const h=u.host.indexOf(":")!==-1?"["+u.host+"]":u.host;return u.id=u.protocol+"://"+h+":"+u.port+s,u.href=u.protocol+"://"+h+(i&&i.port===u.port?"":":"+u.port),u}const Cx=typeof ArrayBuffer=="function",Tx=o=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(o):o.buffer instanceof ArrayBuffer,wp=Object.prototype.toString,kx=typeof Blob=="function"||typeof Blob<"u"&&wp.call(Blob)==="[object BlobConstructor]",Ax=typeof File=="function"||typeof File<"u"&&wp.call(File)==="[object FileConstructor]";function qu(o){return Cx&&(o instanceof ArrayBuffer||Tx(o))||kx&&o instanceof Blob||Ax&&o instanceof File}function Yr(o,s){if(!o||typeof o!="object")return!1;if(Array.isArray(o)){for(let i=0,u=o.length;i<u;i++)if(Yr(o[i]))return!0;return!1}if(qu(o))return!0;if(o.toJSON&&typeof o.toJSON=="function"&&arguments.length===1)return Yr(o.toJSON(),!0);for(const i in o)if(Object.prototype.hasOwnProperty.call(o,i)&&Yr(o[i]))return!0;return!1}function Dx(o){const s=[],i=o.data,u=o;return u.data=Su(i,s),u.attachments=s.length,{packet:u,buffers:s}}function Su(o,s){if(!o)return o;if(qu(o)){const i={_placeholder:!0,num:s.length};return s.push(o),i}else if(Array.isArray(o)){const i=new Array(o.length);for(let u=0;u<o.length;u++)i[u]=Su(o[u],s);return i}else if(typeof o=="object"&&!(o instanceof Date)){const i={};for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=Su(o[u],s));return i}return o}function Ox(o,s){return o.data=ju(o.data,s),delete o.attachments,o}function ju(o,s){if(!o)return o;if(o&&o._placeholder===!0){if(typeof o.num=="number"&&o.num>=0&&o.num<s.length)return s[o.num];throw new Error("illegal attachments")}else if(Array.isArray(o))for(let i=0;i<o.length;i++)o[i]=ju(o[i],s);else if(typeof o=="object")for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&(o[i]=ju(o[i],s));return o}const zx=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var st;(function(o){o[o.CONNECT=0]="CONNECT",o[o.DISCONNECT=1]="DISCONNECT",o[o.EVENT=2]="EVENT",o[o.ACK=3]="ACK",o[o.CONNECT_ERROR=4]="CONNECT_ERROR",o[o.BINARY_EVENT=5]="BINARY_EVENT",o[o.BINARY_ACK=6]="BINARY_ACK"})(st||(st={}));class Mx{constructor(s){this.replacer=s}encode(s){return(s.type===st.EVENT||s.type===st.ACK)&&Yr(s)?this.encodeAsBinary({type:s.type===st.EVENT?st.BINARY_EVENT:st.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let i=""+s.type;return(s.type===st.BINARY_EVENT||s.type===st.BINARY_ACK)&&(i+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(i+=s.nsp+","),s.id!=null&&(i+=s.id),s.data!=null&&(i+=JSON.stringify(s.data,this.replacer)),i}encodeAsBinary(s){const i=Dx(s),u=this.encodeAsString(i.packet),f=i.buffers;return f.unshift(u),f}}class $u extends Wt{constructor(s){super(),this.reviver=s}add(s){let i;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(s);const u=i.type===st.BINARY_EVENT;u||i.type===st.BINARY_ACK?(i.type=u?st.EVENT:st.ACK,this.reconstructor=new Rx(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(qu(s)||s.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(s),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let i=0;const u={type:Number(s.charAt(0))};if(st[u.type]===void 0)throw new Error("unknown packet type "+u.type);if(u.type===st.BINARY_EVENT||u.type===st.BINARY_ACK){const h=i+1;for(;s.charAt(++i)!=="-"&&i!=s.length;);const x=s.substring(h,i);if(x!=Number(x)||s.charAt(i)!=="-")throw new Error("Illegal attachments");u.attachments=Number(x)}if(s.charAt(i+1)==="/"){const h=i+1;for(;++i&&!(s.charAt(i)===","||i===s.length););u.nsp=s.substring(h,i)}else u.nsp="/";const f=s.charAt(i+1);if(f!==""&&Number(f)==f){const h=i+1;for(;++i;){const x=s.charAt(i);if(x==null||Number(x)!=x){--i;break}if(i===s.length)break}u.id=Number(s.substring(h,i+1))}if(s.charAt(++i)){const h=this.tryParse(s.substr(i));if($u.isPayloadValid(u.type,h))u.data=h;else throw new Error("invalid payload")}return u}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,i){switch(s){case st.CONNECT:return Bm(i);case st.DISCONNECT:return i===void 0;case st.CONNECT_ERROR:return typeof i=="string"||Bm(i);case st.EVENT:case st.BINARY_EVENT:return Array.isArray(i)&&(typeof i[0]=="number"||typeof i[0]=="string"&&zx.indexOf(i[0])===-1);case st.ACK:case st.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Rx{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const i=Ox(this.reconPack,this.buffers);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Bm(o){return Object.prototype.toString.call(o)==="[object Object]"}const Ux=Object.freeze(Object.defineProperty({__proto__:null,Decoder:$u,Encoder:Mx,get PacketType(){return st}},Symbol.toStringTag,{value:"Module"}));function da(o,s,i){return o.on(s,i),function(){o.off(s,i)}}const Lx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Sp extends Wt{constructor(s,i,u){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=i,u&&u.auth&&(this.auth=u.auth),this._opts=Object.assign({},u),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[da(s,"open",this.onopen.bind(this)),da(s,"packet",this.onpacket.bind(this)),da(s,"error",this.onerror.bind(this)),da(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...i){var u,f,h;if(Lx.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(i.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;const x={type:st.EVENT,data:i};if(x.options={},x.options.compress=this.flags.compress!==!1,typeof i[i.length-1]=="function"){const S=this.ids++,b=i.pop();this._registerAckCallback(S,b),x.id=S}const w=(f=(u=this.io.engine)===null||u===void 0?void 0:u.transport)===null||f===void 0?void 0:f.writable,E=this.connected&&!(!((h=this.io.engine)===null||h===void 0)&&h._hasPingExpired());return this.flags.volatile&&!w||(E?(this.notifyOutgoingListeners(x),this.packet(x)):this.sendBuffer.push(x)),this.flags={},this}_registerAckCallback(s,i){var u;const f=(u=this.flags.timeout)!==null&&u!==void 0?u:this._opts.ackTimeout;if(f===void 0){this.acks[s]=i;return}const h=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let w=0;w<this.sendBuffer.length;w++)this.sendBuffer[w].id===s&&this.sendBuffer.splice(w,1);i.call(this,new Error("operation has timed out"))},f),x=(...w)=>{this.io.clearTimeoutFn(h),i.apply(this,w)};x.withError=!0,this.acks[s]=x}emitWithAck(s,...i){return new Promise((u,f)=>{const h=(x,w)=>x?f(x):u(w);h.withError=!0,i.push(h),this.emit(s,...i)})}_addToQueue(s){let i;typeof s[s.length-1]=="function"&&(i=s.pop());const u={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((f,...h)=>(this._queue[0],f!==null?u.tryCount>this._opts.retries&&(this._queue.shift(),i&&i(f)):(this._queue.shift(),i&&i(null,...h)),u.pending=!1,this._drainQueue())),this._queue.push(u),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const i=this._queue[0];i.pending&&!s||(i.pending=!0,i.tryCount++,this.flags=i.flags,this.emit.apply(this,i.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:st.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,i),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(u=>String(u.id)===s)){const u=this.acks[s];delete this.acks[s],u.withError&&u.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case st.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case st.EVENT:case st.BINARY_EVENT:this.onevent(s);break;case st.ACK:case st.BINARY_ACK:this.onack(s);break;case st.DISCONNECT:this.ondisconnect();break;case st.CONNECT_ERROR:this.destroy();const u=new Error(s.data.message);u.data=s.data.data,this.emitReserved("connect_error",u);break}}onevent(s){const i=s.data||[];s.id!=null&&i.push(this.ack(s.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const i=this._anyListeners.slice();for(const u of i)u.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const i=this;let u=!1;return function(...f){u||(u=!0,i.packet({type:st.ACK,id:s,data:f}))}}onack(s){const i=this.acks[s.id];typeof i=="function"&&(delete this.acks[s.id],i.withError&&s.data.unshift(null),i.apply(this,s.data))}onconnect(s,i){this.id=s,this.recovered=i&&this._pid===i,this._pid=i,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:st.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const i=this._anyListeners;for(let u=0;u<i.length;u++)if(s===i[u])return i.splice(u,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const i=this._anyOutgoingListeners;for(let u=0;u<i.length;u++)if(s===i[u])return i.splice(u,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const i=this._anyOutgoingListeners.slice();for(const u of i)u.apply(this,s.data)}}}function Cl(o){o=o||{},this.ms=o.min||100,this.max=o.max||1e4,this.factor=o.factor||2,this.jitter=o.jitter>0&&o.jitter<=1?o.jitter:0,this.attempts=0}Cl.prototype.duration=function(){var o=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),i=Math.floor(s*this.jitter*o);o=(Math.floor(s*10)&1)==0?o-i:o+i}return Math.min(o,this.max)|0};Cl.prototype.reset=function(){this.attempts=0};Cl.prototype.setMin=function(o){this.ms=o};Cl.prototype.setMax=function(o){this.max=o};Cl.prototype.setJitter=function(o){this.jitter=o};class Nu extends Wt{constructor(s,i){var u;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(i=s,s=void 0),i=i||{},i.path=i.path||"/socket.io",this.opts=i,Pr(this,i),this.reconnection(i.reconnection!==!1),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor((u=i.randomizationFactor)!==null&&u!==void 0?u:.5),this.backoff=new Cl({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(i.timeout==null?2e4:i.timeout),this._readyState="closed",this.uri=s;const f=i.parser||Ux;this.encoder=new f.Encoder,this.decoder=new f.Decoder,this._autoConnect=i.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var i;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(i=this.backoff)===null||i===void 0||i.setMin(s),this)}randomizationFactor(s){var i;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(i=this.backoff)===null||i===void 0||i.setJitter(s),this)}reconnectionDelayMax(s){var i;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(i=this.backoff)===null||i===void 0||i.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new _x(this.uri,this.opts);const i=this.engine,u=this;this._readyState="opening",this.skipReconnect=!1;const f=da(i,"open",function(){u.onopen(),s&&s()}),h=w=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",w),s?s(w):this.maybeReconnectOnOpen()},x=da(i,"error",h);if(this._timeout!==!1){const w=this._timeout,E=this.setTimeoutFn(()=>{f(),h(new Error("timeout")),i.close()},w);this.opts.autoUnref&&E.unref(),this.subs.push(()=>{this.clearTimeoutFn(E)})}return this.subs.push(f),this.subs.push(x),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(da(s,"ping",this.onping.bind(this)),da(s,"data",this.ondata.bind(this)),da(s,"error",this.onerror.bind(this)),da(s,"close",this.onclose.bind(this)),da(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(i){this.onclose("parse error",i)}}ondecoded(s){Wr(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,i){let u=this.nsps[s];return u?this._autoConnect&&!u.active&&u.connect():(u=new Sp(this,s,i),this.nsps[s]=u),u}_destroy(s){const i=Object.keys(this.nsps);for(const u of i)if(this.nsps[u].active)return;this._close()}_packet(s){const i=this.encoder.encode(s);for(let u=0;u<i.length;u++)this.engine.write(i[u],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,i){var u;this.cleanup(),(u=this.engine)===null||u===void 0||u.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const i=this.backoff.duration();this._reconnecting=!0;const u=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(f=>{f?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",f)):s.onreconnect()}))},i);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const Ni={};function Xr(o,s){typeof o=="object"&&(s=o,o=void 0),s=s||{};const i=Ex(o,s.path||"/socket.io"),u=i.source,f=i.id,h=i.path,x=Ni[f]&&h in Ni[f].nsps,w=s.forceNew||s["force new connection"]||s.multiplex===!1||x;let E;return w?E=new Nu(u,s):(Ni[f]||(Ni[f]=new Nu(u,s)),E=Ni[f]),i.query&&!s.query&&(s.query=i.queryKey),E.socket(i.path,s)}Object.assign(Xr,{Manager:Nu,Socket:Sp,io:Xr,connect:Xr});const Hu="http://localhost:5000",Bx=Hu,Dn=Hu;let _u=!1;try{_u=!!window.__TAURI__}catch{_u=!1}class qx{async getMetaSchema(){const s=await fetch(`${this.baseUrl}/api/v1/templates/meta-schema`);if(!s.ok)throw new Error("Failed to fetch meta schema");return s.json()}baseUrl;socket=null;constructor(s=Hu){this.baseUrl=s}async waitForBackend(s=30,i=200){if(!_u)return!0;for(let u=0;u<s;u++){try{if((await fetch(`${this.baseUrl}/api/v1/health`,{method:"GET",signal:AbortSignal.timeout(1e3)})).ok)return!0}catch{}u<s-1&&await new Promise(f=>setTimeout(f,i))}return console.warn("Backend did not become ready within timeout"),!1}async createSession(){return(await fetch(`${this.baseUrl}/api/v1/sessions`,{method:"POST",headers:{"Content-Type":"application/json"}})).json()}async getSessionInfo(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/info`);if(!i.ok)throw new Error("Session not found");return i.json()}async getSessionGraph(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/graph`);if(!i.ok)throw new Error("No graph in session");return i.json()}async getSession(s){return(await fetch(`${this.baseUrl}/api/v1/sessions/${s}`)).json()}async getOrphanedNodes(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/orphaned-nodes`);if(!i.ok){const u=await i.json();throw new Error(u?.error?.message||"Failed to get orphaned nodes")}return i.json()}async createNode(s){return(await fetch(`${this.baseUrl}/api/v1/nodes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async updateNode(s,i){return(await fetch(`${this.baseUrl}/api/v1/nodes/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()}async deleteNode(s){await fetch(`${this.baseUrl}/api/v1/nodes/${s}`,{method:"DELETE"})}async getNode(s){return(await fetch(`${this.baseUrl}/api/v1/nodes/${s}`)).json()}async getGraph(s){return(await fetch(`${this.baseUrl}/api/v1/graphs/${s}`)).json()}async saveGraph(s,i){return(await fetch(`${this.baseUrl}/api/v1/graphs/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()}async listTemplates(){return(await(await fetch(`${this.baseUrl}/api/v1/templates`)).json()).templates||[]}async getTemplateSchema(s){const i=await fetch(`${this.baseUrl}/api/v1/templates/${s}/schema`);if(!i.ok)throw new Error(`Failed to fetch template schema: ${i.status} ${i.statusText}`);return i.json()}async listMarkupProfiles(){const s=await fetch(`${this.baseUrl}/api/v1/markups`);if(!s.ok)throw new Error(`Failed to fetch markup profiles: ${s.status} ${s.statusText}`);return(await s.json()).profiles||[]}async getMarkupProfile(s){const i=await fetch(`${this.baseUrl}/api/v1/markup/${s}`);if(!i.ok)throw new Error(`Failed to fetch markup profile: ${i.status} ${i.statusText}`);return i.json()}async createMarkupProfile(s){const i=await fetch(`${this.baseUrl}/api/v1/markup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok)throw new Error(`Failed to create markup profile: ${i.status} ${i.statusText}`);return i.json()}async updateMarkupProfile(s,i){const u=await fetch(`${this.baseUrl}/api/v1/markup/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error(`Failed to update markup profile: ${u.status} ${u.statusText}`);return u.json()}async deleteMarkupProfile(s){const i=await fetch(`${this.baseUrl}/api/v1/markup/${s}`,{method:"DELETE"});if(!i.ok)throw new Error(`Failed to delete markup profile: ${i.status} ${i.statusText}`)}async getIconsConfig(){const s=await fetch(`${this.baseUrl}/api/v1/config/icons`);if(!s.ok)throw new Error(`Failed to fetch icons config: ${s.status} ${s.statusText}`);return s.json()}async getIndicatorsConfig(){const s=await fetch(`${this.baseUrl}/api/v1/config/indicators`);if(!s.ok)throw new Error(`Failed to fetch indicators config: ${s.status} ${s.statusText}`);return s.json()}async listIcons(){const s=await fetch(`${this.baseUrl}/api/v1/icon-catalog/icons`);if(!s.ok)throw new Error(`Failed to list icons: ${s.status} ${s.statusText}`);return s.json()}async createIcon(s){const i=await fetch(`${this.baseUrl}/api/v1/icon-catalog/icons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({icon_id:s.id,file:s.file,description:s.description})});if(!i.ok){const f=(await i.json().catch(()=>null))?.error?.message||`Failed to create icon: ${i.status}`;throw new Error(f)}return i.json()}async updateIcon(s,i){const u=await fetch(`${this.baseUrl}/api/v1/icon-catalog/icons/${encodeURIComponent(s)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({icon_id:i.id,file:i.file,description:i.description})});if(!u.ok){const h=(await u.json().catch(()=>null))?.error?.message||`Failed to update icon: ${u.status}`;throw new Error(h)}return u.json()}async deleteIcon(s){const i=await fetch(`${this.baseUrl}/api/v1/icon-catalog/icons/${encodeURIComponent(s)}`,{method:"DELETE"});if(!i.ok){const f=(await i.json().catch(()=>null))?.error?.message||`Failed to delete icon: ${i.status}`;throw new Error(f)}}async uploadIconFile(s,i){const u=new FormData;u.append("file",i);const f=await fetch(`${this.baseUrl}/api/v1/icon-catalog/icons/${encodeURIComponent(s)}/file`,{method:"POST",body:u});if(!f.ok){const x=(await f.json().catch(()=>null))?.error?.message||`Failed to upload icon file: ${f.status}`;throw new Error(x)}return f.json()}async listIndicatorSetIndicators(s){const i=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators`);if(!i.ok)throw new Error(`Failed to list indicators: ${i.status} ${i.statusText}`);return i.json()}async getIndicator(s,i){const u=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators/${encodeURIComponent(i)}`);if(!u.ok)throw new Error(`Failed to get indicator: ${u.status} ${u.statusText}`);return u.json()}async createIndicator(s,i){const u=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indicator_id:i.id,file:i.file,description:i.description})});if(!u.ok){const h=(await u.json().catch(()=>null))?.error?.message||`Failed to create indicator: ${u.status}`;throw new Error(h)}return u.json()}async updateIndicator(s,i,u){const f=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators/${encodeURIComponent(i)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({indicator_id:u.id,file:u.file,description:u.description})});if(!f.ok){const x=(await f.json().catch(()=>null))?.error?.message||`Failed to update indicator: ${f.status}`;throw new Error(x)}return f.json()}async uploadIndicatorFile(s,i,u){const f=new FormData;f.append("file",u);const h=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators/${encodeURIComponent(i)}/file`,{method:"POST",body:f});if(!h.ok){const w=(await h.json().catch(()=>null))?.error?.message||`Failed to upload indicator file: ${h.status}`;throw new Error(w)}return h.json()}async deleteIndicator(s,i){const u=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators/${encodeURIComponent(i)}`,{method:"DELETE"});if(!u.ok){const h=(await u.json().catch(()=>null))?.error?.message||`Failed to delete indicator: ${u.status}`;throw new Error(h)}}async setIndicatorTheme(s,i,u){const f=await fetch(`${this.baseUrl}/api/v1/indicator-catalog/sets/${encodeURIComponent(s)}/indicators/${encodeURIComponent(i)}/theme`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!f.ok){const x=(await f.json().catch(()=>null))?.error?.message||`Failed to set indicator theme: ${f.status}`;throw new Error(x)}return f.json()}async createProject(s,i){return(await fetch(`${this.baseUrl}/api/v1/projects`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template_id:s,project_name:i})})).json()}async loadGraphIntoSession(s,i,u,f=[]){const h=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/load-graph`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({graph:i,template_id:u,blocking_relationships:f})});if(!h.ok)throw new Error("Failed to load graph into session");return h.json()}async checkDirtyState(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/dirty`);if(!i.ok)throw new Error("Failed to check dirty state");return i.json()}async saveSession(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/save`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to save session");return i.json()}async resetDirtyState(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/reset-dirty`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to reset dirty state");return i.json()}async reloadBlueprint(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/reload-blueprint`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to reload blueprint");return i.json()}async executeCommand(s,i,u){const f=await fetch(`${this.baseUrl}/api/v1/commands/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:s,command_type:i,data:u})}),h=await f.json().catch(()=>null);if(!f.ok){const x=h?.error?.message||"Command failed";throw new Error(x)}return h}async undo(s){return(await fetch(`${this.baseUrl}/api/v1/sessions/${s}/undo`,{method:"POST",headers:{"Content-Type":"application/json"}})).json()}async redo(s){return(await fetch(`${this.baseUrl}/api/v1/sessions/${s}/redo`,{method:"POST",headers:{"Content-Type":"application/json"}})).json()}async importNodesFromCsv(s){const i=new FormData;i.append("session_id",s.sessionId),i.append("parent_id",s.parentId),i.append("blueprint_type_id",s.blueprintTypeId),i.append("column_map",JSON.stringify(s.columnMap)),i.append("file",s.file);const u=await fetch(`${this.baseUrl}/api/v1/imports/csv`,{method:"POST",body:i}),f=await u.json().catch(()=>null);if(!u.ok){const h=f?.error?.message||"CSV import failed";throw Object.assign(new Error(h),{code:f?.error?.code,rowErrors:f?.error?.rows,status:u.status})}return f}async getMigrationStatus(s){const i=await fetch(`${this.baseUrl}/api/v1/session/${s}/migrations/status`);if(!i.ok)throw new Error("Failed to get migration status");return i.json()}async applyMigrations(s){const i=await fetch(`${this.baseUrl}/api/v1/session/${s}/migrations/apply`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to apply migrations");return i.json()}async listTemplatesForEditor(){const s=await fetch(`${this.baseUrl}/api/v1/templates/editor/list`);if(!s.ok)throw new Error("Failed to list templates");return s.json()}async getTemplateForEditor(s){const i=await fetch(`${this.baseUrl}/api/v1/templates/editor/${s}`);if(!i.ok)throw new Error("Failed to load template");return i.json()}async createTemplate(s){const i=await fetch(`${this.baseUrl}/api/v1/templates/editor`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const u=await i.json();throw new Error(u.error?.message||"Failed to create template")}return i.json()}async updateTemplate(s,i){const u=await fetch(`${this.baseUrl}/api/v1/templates/editor/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok){const f=await u.json();throw new Error(f.error?.message||"Failed to update template")}return u.json()}async deleteTemplate(s){const i=await fetch(`${this.baseUrl}/api/v1/templates/editor/${s}`,{method:"DELETE"});if(!i.ok){const u=await i.json();throw new Error(u.error?.message||"Failed to delete template")}return i.json()}async validateTemplate(s){const i=await fetch(`${this.baseUrl}/api/v1/templates/editor/${s.id}/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const u=await i.json();throw new Error(u.error?.message||"Failed to validate template")}return i.json()}async listExportTemplates(){const s=await fetch(`${this.baseUrl}/api/export/list`);if(!s.ok){const i=await s.json();throw new Error(i.error?.message||"Failed to list export templates")}return s.json()}async downloadExport(s,i,u){const f=await fetch(`${this.baseUrl}/api/export/${s}/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template_id:i,context:u||{}})});if(!f.ok){const h=await f.json();throw new Error(h.error?.message||"Failed to download export")}return f.blob()}async getVelocityRanking(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/velocity`);if(!i.ok){const u=await i.json();throw new Error(u.error?.message||"Failed to get velocity ranking")}return i.json()}async getNodeVelocity(s,i){const u=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/nodes/${i}/velocity`);if(!u.ok){const f=await u.json();throw new Error(f.error?.message||"Failed to get node velocity")}return u.json()}async updateBlockingRelationship(s,i,u){return this.executeCommand(s,"UpdateBlockingRelationship",{blocked_node_id:i,blocking_node_id:u})}async getBlockingGraph(s){const i=await fetch(`${this.baseUrl}/api/v1/sessions/${s}/blocking-graph`);if(!i.ok){const u=await i.json();throw new Error(u.error?.message||"Failed to get blocking graph")}return i.json()}connectSocket(s){return this.socket&&this.socket.connected?this.socket:(this.socket&&this.socket.disconnect(),this.socket=Xr(`${Bx}/graph`,{transports:["polling"],upgrade:!1}),this.socket.on("connect",()=>{s.sessionId&&this.socket?.emit("join_session",{session_id:s.sessionId}),s.onConnect?.()}),s.onNodeCreated&&this.socket.on("node-created",s.onNodeCreated),s.onNodeUpdated&&this.socket.on("node-updated",s.onNodeUpdated),s.onNodeDeleted&&this.socket.on("node-deleted",s.onNodeDeleted),s.onDisconnect&&this.socket.on("disconnect",s.onDisconnect),this.socket)}disconnectSocket(){this.socket&&(this.socket.disconnect(),this.socket=null)}getSocket(){return this.socket}}const Ae=new qx,Us=new Map,Eu=new Set,$x=o=>o.trim().replace(/\.svg$/i,"").toLowerCase();function Hx(){Us.clear(),Eu.forEach(o=>{try{o()}catch(s){console.warn("[mapNodeIcon] Icon cache listener error",s)}})}function jp(o){return Eu.add(o),()=>{Eu.delete(o)}}function Np(o){if(!o)return Promise.resolve(void 0);const s=$x(o);if(Us.has(s))return Us.get(s);const i=fetch(`${Dn}/api/v1/icons/${s}`).then(async u=>{if(!u.ok){console.warn("[mapNodeIcon] Failed to load icon",s,"status",u.status),Us.delete(s);return}const f=await u.text();if(!f.trim().startsWith("<svg")){console.warn("[mapNodeIcon] Icon payload is not SVG for",s),Us.delete(s);return}return f}).catch(u=>{console.error("[mapNodeIcon] Network error while loading icon",s,u),Us.delete(s)});return Us.set(s,i),i}let mu=null;const Vx=async()=>(mu||(mu=fetch(`${Dn}/api/v1/config/indicators`).then(o=>o.ok?o.json():null).catch(()=>null)),mu);async function Gx(o){let s,i,u;if(o.indicator_id&&o.indicator_set){const h=`${Dn}/api/v1/assets/indicators/${o.indicator_set}/${o.indicator_id}`;try{const w=await fetch(h);if(w.ok){s=await w.text();const E=s.trim();E.startsWith("<svg")||E.startsWith("<?xml")||E.includes("<svg")||(console.warn("[mapNodeIndicator] Invalid SVG for",o.id),s=void 0)}else o.indicator&&o.indicator.bullet&&(i=o.indicator.bullet)}catch(w){console.error("[mapNodeIndicator] Fetch error:",w),o.indicator&&o.indicator.bullet&&(i=o.indicator.bullet)}u=(await Vx())?.indicator_sets?.[o.indicator_set]?.default_theme?.[o.indicator_id]}const f={...o,statusIndicatorSvg:s,statusText:i,indicator_theme:u,indicatorColor:u?.indicator_color,textColor:u?.text_color,textStyle:u?.text_style};return(o.schema_shape||o.schema_color)&&console.log("[mapNodeIndicator] Node",o.id,"has shape:",o.schema_shape,"color:",o.schema_color),f}const qm=(o,s)=>{if(!s||!o)return o;let i=o;return i=i.replace(/fill="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill="${f}"`:`fill="${s}"`}).replace(/fill='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill='${f}'`:`fill='${s}'`}).replace(/stroke="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke="${f}"`:`stroke="${s}"`}),i},Yx=new Set(["*","__any__","any"]),Rs={current:null},Xx=o=>{if(!Array.isArray(o.children)||o.children.length===0)return[];const s=[],i=[...o.children];for(;i.length>0;){const u=i.pop();u&&(s.push(u.id),Array.isArray(u.children)&&u.children.length>0&&i.push(...u.children))}return s};function _p({node:o,level:s=0,onSelect:i,onExpand:u,onContextMenu:f,expandedMap:h,setExpandedMap:x,getTypeLabel:w,scrollContainerRef:E}){const[y,S]=m.useState(()=>o.statusIndicatorSvg??void 0),[b,G]=m.useState(()=>o.statusText??void 0),[L,ce]=m.useState(void 0),[ie,ve]=m.useState(void 0),[ge,Ee]=m.useState(void 0),[_e,W]=m.useState(void 0),[Te,fe]=m.useState(null),[oe,Ce]=m.useState(null),[Re,Oe]=m.useState(null),[$,ye]=m.useState(!1),ee=m.useRef(null),[Se,B]=m.useState(0),v=m.useRef(null),M=o.selected===!0,Z=o.parent_id??null,j={project_root:"empty",season:"partial",episode:"partial",task:"partial",footage:"filled"},se={project_root:"film",assets:"archive-box",inventory_root:"archive-box",camera_gear_inventory:"camera",camera_gear_category:"camera",camera_gear_asset:"camera",parts_inventory:"cog",part_category:"cog",part_asset:"cog",car_parts_inventory:"cog",tools_inventory:"cog",tool_category:"cog",tool_asset:"cog",vehicles:"truck",vehicle_asset:"truck",phase:"calendar-days",season:"calendar-days",episode:"video-camera",task:"clipboard-document-check",footage:"play-circle",location_scout:"map-pin"},g=o.indicator_id??j[o.type]??void 0,T=o.indicator_set??"status",A=o.icon_id??se[o.type]??o.type??void 0;m.useEffect(()=>{S(o.statusIndicatorSvg??void 0),G(o.statusText??void 0)},[o.statusIndicatorSvg,o.statusText]),m.useEffect(()=>jp(()=>{W(void 0),B(D=>D+1)}),[]),m.useEffect(()=>{let C=!0;return A?(Np(A).then(D=>{C&&W(D)}).catch(D=>{console.warn("[TreeView] Failed to load icon",A,D),C&&W(void 0)}),()=>{C=!1}):(W(void 0),()=>{C=!1})},[A,Se]),m.useEffect(()=>{let C=!0;return!g||!T?(C&&(S(void 0),G(void 0)),()=>{C=!1}):(Gx({...o,indicator_id:g,indicator_set:T}).then(D=>{!C||!D||(S(D.statusIndicatorSvg??o.statusIndicatorSvg??void 0),G(D.statusText??o.statusText??void 0),Ee(D.indicatorColor??void 0),ce(D.textColor??D.indicatorColor??void 0),ve(D.textStyle??void 0))}).catch(D=>{console.warn("[TreeView] Failed to load indicator SVG",g,D),C&&(S(o.statusIndicatorSvg??void 0),G(o.statusText??void 0))}),()=>{C=!1})},[o.id,g,T]),m.useEffect(()=>{(!g||!T)&&(Ee(void 0),ce(void 0),ve(void 0))},[g,T]);const X=Array.isArray(o.children)&&o.children.length>0,me=Array.isArray(o.allowed_children)?o.allowed_children:[],we=me.map(C=>String(C).trim().toLowerCase()),qe=C=>{if(!C)return!1;if(we.length===0)return!0;const D=C.trim().toLowerCase();return we.some(Q=>Q===D||Yx.has(Q))},te=we.length>0,de=C=>C.endsWith("_inventory")||C==="assets"||C==="asset_category",Xe=me.some(C=>de(C)),Je=me.filter(C=>!de(C)),Ie=C=>{f?.(o.id,C),Oe(null)},vt=h[o.id]??!1,Ot="var(--color-fg-primary)",zt=L||ge||Ot,wt=ge||L||Ot,Mt=Z===null||typeof Z>"u"?null:String(Z),Xt=()=>{fe(null),Ce(null)},Qt=C=>{const D=v.current;if(!D)return"inside";const Q=D.getBoundingClientRect(),ue=C-Q.top;return ue<Q.height*.25?"above":ue>Q.height*.75?"below":"inside"},Ut=m.useRef(null),un=C=>{let D=C.dataTransfer.getData("application/json");if(D||(D=C.dataTransfer.getData("text/plain")),!D)return Rs.current??Ut.current;try{const Q=JSON.parse(D);return Rs.current=Q,Ut.current=Q,Q}catch(Q){return console.warn("[TreeView] Could not parse drag payload",Q),Rs.current??Ut.current}},On=C=>C===null||typeof C>"u"?null:String(C),zn=C=>{const D=un(C);if(!D){console.debug("[TreeView] dragOver ignored: missing payload",{targetId:o.id}),Xt();return}const Q=D.nodeId,ue=D.nodeType,be=On(D.parent_id),je=Array.isArray(D.descendants)?D.descendants:[];if(!Q||Q===o.id){console.debug("[TreeView] dragOver ignored: self drop blocked",{draggedId:Q,targetId:o.id}),Xt();return}if(je.includes(o.id)){console.debug("[TreeView] dragOver ignored: descendant blocked",{draggedId:Q,targetId:o.id}),Xt();return}const Ne=v.current?.getBoundingClientRect();let Le=Qt(C.clientY),He=!1;if(Le==="inside"?qe(ue)?He=!0:be===Mt&&(Ne?Le=C.clientY<Ne.top+Ne.height/2?"above":"below":Le="below",He=!0):be===Mt&&(He=!0),!He){console.debug("[TreeView] dragOver ignored: invalid target pairing",{draggedId:Q,draggedType:ue,targetId:o.id,dropZone:Le,draggedParentId:be,targetParentId:Mt}),Xt();return}console.debug("[TreeView] dragOver valid",{draggedId:Q,draggedType:ue,targetId:o.id,dropZone:Le}),C.preventDefault(),C.stopPropagation(),C.dataTransfer.dropEffect="move",Te!==o.id&&fe(o.id);const lt=Le==="inside"?null:Le;oe!==lt&&Ce(lt)},Ht=C=>{const D=C.relatedTarget;v.current&&D&&v.current.contains(D)||Xt()},Qe=C=>{C.preventDefault(),C.stopPropagation();const D=un(C);if(Xt(),Rs.current=null,Ut.current=null,!D){console.warn("[TreeView] drop ignored: missing payload",{targetId:o.id});return}const Q=D.nodeId,ue=D.nodeType,be=On(D.parent_id),je=Array.isArray(D.descendants)?D.descendants:[];if(!Q||Q===o.id){console.debug("[TreeView] drop ignored: self drop blocked",{droppedId:Q,targetId:o.id});return}if(je.includes(o.id)){console.debug("[TreeView] drop ignored: descendant blocked",{droppedId:Q,targetId:o.id});return}const Ne=v.current?.getBoundingClientRect();let Le=oe??Qt(C.clientY);if(Le==="inside"&&!qe(ue)&&be===Mt&&(Ne?Le=C.clientY<Ne.top+Ne.height/2?"above":"below":Le="below"),Le==="above"||Le==="below")console.debug("[TreeView] drop reorder",{droppedId:Q,targetId:o.id,dropZone:Le}),f?.(Q,`reorder:${o.id}:${Le}`);else{if(!qe(ue)){console.debug("[TreeView] drop rejected: child type not accepted",{droppedId:Q,droppedType:ue,targetId:o.id});return}if(be===o.id){console.debug("[TreeView] drop ignored: already child of target",{droppedId:Q,targetId:o.id});return}console.debug("[TreeView] drop move",{droppedId:Q,targetId:o.id}),f?.(Q,`move:${o.id}`)}},Ft=C=>w?w(C):C,J=C=>{C.stopPropagation(),C.dataTransfer.effectAllowed="move";const D={nodeId:o.id,nodeType:o.type,parent_id:Z,descendants:Xx(o)};console.debug("[TreeView] dragStart",D),Rs.current=D,Ut.current=D;const Q=JSON.stringify(D);C.dataTransfer.setData("application/json",Q),C.dataTransfer.setData("text/plain",Q)},he=()=>{console.debug("[TreeView] dragEnd",{nodeId:o.id}),Xt(),Rs.current?.nodeId===o.id&&(Rs.current=null),Ut.current=null},ke=Te===o.id,De=ke&&oe===null,Me=ke&&oe==="above",Ge=ke&&oe==="below",z=["relative flex w-full items-center gap-1 px-2 py-1.5 rounded-sm cursor-pointer transition-colors border-l-2 border-transparent",M?"bg-bg-selection border-l-4 border-accent-primary shadow-inner ring-1 ring-accent-primary/60":De?"bg-accent-primary/20 border-l-4 border-accent-primary shadow-inner ring-2 ring-accent-primary/70":ke?"bg-accent-primary/10 border-l-2 border-accent-primary/60 ring-1 ring-accent-primary/40":"hover:bg-bg-selection"].join(" "),U=C=>l.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-x-0 z-20",style:{[C==="above"?"top":"bottom"]:"-1px"},children:l.jsx("div",{className:"mx-2 h-0.5 rounded-full bg-accent-primary shadow-sm"})});return l.jsxs("div",{className:"relative flex flex-col w-full",children:[Me&&U("above"),l.jsxs("div",{ref:v,className:z,"data-testid":"tree-item-row","data-selected":M?"true":"false","aria-selected":M,onClick:()=>i?.(o.id),onContextMenu:C=>{C.preventDefault(),Oe({x:C.clientX,y:C.clientY})},onDragEnter:zn,onDragOver:zn,onDragLeave:Ht,onDrop:Qe,children:[M&&l.jsx("span",{"aria-hidden":"true",className:"pointer-events-none absolute inset-y-1 left-0.5 w-1 rounded-full bg-accent-primary"}),te&&l.jsxs(l.Fragment,{children:[l.jsx("button",{ref:ee,className:"mr-1 px-1 py-0.5 rounded bg-bg-light border border-border hover:bg-accent-primary hover:text-fg-primary",title:"Add child node",onClick:C=>{C.stopPropagation(),ye(D=>!D)},"aria-label":"Add child node","data-testid":"add-child-btn",children:"+"}),$&&l.jsxs("div",{className:"fixed z-50 bg-bg-light border border-border rounded shadow-lg mt-1",style:{left:(ee.current?.getBoundingClientRect().left??0)+window.scrollX,top:(ee.current?.getBoundingClientRect().bottom??0)+window.scrollY},onMouseLeave:()=>ye(!1),children:[Je.map(C=>l.jsxs("button",{className:"block w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-bg-selection",onClick:D=>{D.stopPropagation(),ye(!1),Ie(`add:${C}`)},children:[" Add ",Ft(C)]},C)),Xe&&l.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-bg-selection",onClick:C=>{C.stopPropagation(),ye(!1),Ie("add-asset-category")},children:" Add Asset Category"})]})]}),X?l.jsx("button",{onClick:C=>{C.stopPropagation(),x(D=>({...D,[o.id]:!vt})),u?.(o.id)},className:"p-0 hover:text-accent-hover","data-testid":"expand-toggle-btn",children:vt?l.jsx(Kr,{size:14}):l.jsx(ku,{size:14})}):l.jsx("div",{className:"w-4"}),l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"node-icon-svg h-4 w-4 flex-shrink-0",children:_e?l.jsx("span",{dangerouslySetInnerHTML:{__html:qm(_e,zt)}}):l.jsx("span",{className:"opacity-30",children:""})}),l.jsx("span",{className:"status-indicator-svg",children:y?l.jsx("span",{dangerouslySetInnerHTML:{__html:qm(y,wt)}}):b?l.jsx("span",{className:"status-indicator-text text-xs opacity-80",children:b}):l.jsx("span",{className:"status-indicator-text text-xs opacity-40",children:""})})]}),l.jsx("span",{className:"text-sm truncate",style:{color:L,fontWeight:ie==="bold"?"bold":"normal",textDecoration:ie==="strikethrough"?"line-through":"none"},children:o.name||o.type||o.id}),l.jsx("button",{draggable:!0,onDragStart:J,onDragEnd:he,className:"ml-auto opacity-60 hover:opacity-100 cursor-grab",title:"Drag to move or reorder","aria-label":"Drag handle",tabIndex:-1,children:l.jsx("span",{className:"icon",children:""})}),Re&&l.jsxs("div",{className:"fixed bg-bg-light border border-border rounded-sm shadow-lg z-50 min-w-max",style:{top:`${Re.y}px`,left:`${Re.x}px`},onMouseLeave:()=>Oe(null),children:[te&&Xe&&l.jsx("button",{onClick:()=>Ie("add-asset-category"),className:"w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-bg-selection transition-colors first:rounded-t-sm",children:" Add Asset Category"}),te&&Je.map(C=>l.jsxs("button",{onClick:()=>Ie(`add:${C}`),className:"w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-bg-selection transition-colors first:rounded-t-sm",children:[" Add ",Ft(C)]},C)),l.jsx("button",{onClick:()=>Ie("delete"),className:"w-full text-left px-4 py-2 text-sm text-fg-primary hover:bg-status-danger hover:text-fg-primary transition-colors last:rounded-b-sm",children:" Delete"})]})]}),Ge&&U("below"),vt&&X&&l.jsx("div",{className:"ml-2 border-l border-border pl-3",children:(()=>{const C=[],D=new Map;o.children?.forEach(ue=>{const be=ue.type??"Unknown",je=be.trim().toLowerCase();D.has(je)||D.set(je,{title:Ft(be),items:[]}),D.get(je)?.items.push(ue)});const Q=new Set;return me.forEach(ue=>{const be=String(ue??"").trim().toLowerCase();if(!be||Q.has(be))return;const je=D.get(be);!je||je.items.length===0||(C.push({key:be,title:Ft(String(ue)),items:je.items}),Q.add(be))}),D.forEach((ue,be)=>{Q.has(be)||ue.items.length===0||C.push({key:be,title:ue.title,items:ue.items})}),C.map(ue=>l.jsxs("div",{className:"mb-3 last:mb-0",children:[l.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-fg-secondary mb-1",children:ue.title}),l.jsx("div",{className:"space-y-1",children:ue.items.map(be=>l.jsx(_p,{node:be,level:s+1,onSelect:i,onExpand:u,onContextMenu:f,expandedMap:h,setExpandedMap:x,getTypeLabel:w,scrollContainerRef:E},be.id))})]},`${o.id}-${ue.key}`))})()})]})}function Qx({nodes:o,onSelectNode:s,onExpandNode:i,onContextMenu:u,expandAllSignal:f,collapseAllSignal:h,getTypeLabel:x,expandedMap:w,setExpandedMap:E}){const[y,S]=m.useState({}),b=m.useRef(null),G=m.useRef(void 0),L=m.useRef(void 0),ce=w||y,ie=E||S,ve=_e=>{const W=[],Te=fe=>{fe.forEach(oe=>{W.push(oe.id),Array.isArray(oe.children)&&oe.children.length>0&&Te(oe.children)})};return Te(_e),W};m.useEffect(()=>{if(f!==void 0&&f>0&&f!==G.current){G.current=f;const _e=ve(o),W={};_e.forEach(Te=>{W[Te]=!0}),ie(W)}},[f,o,ie]),m.useEffect(()=>{h!==void 0&&h>0&&h!==L.current&&(L.current=h,ie({}))},[h,ie]);const Ee=o.filter(_e=>_e.type==="project_root").length>1;return l.jsxs("aside",{ref:b,className:"bg-bg-light border-r border-border p-3 overflow-y-auto","data-expanded-map":JSON.stringify(ce),children:[l.jsx("div",{className:"font-display text-sm border-b border-accent-primary pb-2 mb-3",children:"Project Tree"}),l.jsx("div",{className:"space-y-1",children:o.map(_e=>l.jsxs("div",{children:[Ee&&_e.type==="project_root"&&l.jsxs("div",{className:"font-display text-xs font-semibold uppercase tracking-wide text-accent-primary border-t border-border pt-2 mt-2 mb-1",children:["Project: ",_e.name]}),l.jsx(_p,{node:_e,onSelect:s,onExpand:i,onContextMenu:u,expandedMap:ce,setExpandedMap:ie,getTypeLabel:x,scrollContainerRef:b})]},_e.id))})]})}function Fx({value:o,onChange:s,label:i,error:u,disabled:f}){const[h,x]=m.useState(!1),[w,E]=m.useState(()=>o?new Date(o):new Date),y=m.useRef(null),S=m.useRef(null),b=["January","February","March","April","May","June","July","August","September","October","November","December"],G=fe=>new Date(fe.getFullYear(),fe.getMonth()+1,0).getDate(),L=fe=>new Date(fe.getFullYear(),fe.getMonth(),1).getDay(),ce=()=>{E(new Date(w.getFullYear(),w.getMonth()-1,1))},ie=()=>{E(new Date(w.getFullYear(),w.getMonth()+1,1))},ve=fe=>{const Ce=new Date(w.getFullYear(),w.getMonth(),fe).toISOString().split("T")[0];s(Ce),x(!1)},ge=fe=>{const oe=fe.target.value;oe&&(s(oe),E(new Date(oe)))};m.useEffect(()=>{const fe=oe=>{y.current&&!y.current.contains(oe.target)&&x(!1)};if(h)return document.addEventListener("mousedown",fe),()=>document.removeEventListener("mousedown",fe)},[h]);const Ee=G(w),_e=L(w),W=Array(_e).fill(null);for(let fe=1;fe<=Ee;fe++)W.push(fe);const Te=o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"";return l.jsxs("div",{ref:y,className:"w-full",children:[i&&l.jsx("label",{className:"block text-sm text-fg-secondary mb-1 font-body",children:i}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{ref:S,type:"text",value:Te,onChange:ge,onClick:()=>!f&&x(!h),disabled:f,placeholder:"MM/DD/YYYY",className:`
            w-full bg-bg-dark text-fg-primary border border-border rounded-sm
            px-2 py-1 text-sm font-body cursor-pointer
            focus:border-accent-primary focus:outline-none focus:ring-1 focus:ring-accent-primary
            disabled:bg-bg-light disabled:text-fg-disabled disabled:cursor-not-allowed
            transition-colors duration-200
            ${u?"border-status-danger":""}
          `}),h&&!f&&l.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-bg-light border border-border rounded-sm shadow-lg z-50 p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("button",{onClick:ce,className:"p-1 hover:bg-bg-dark rounded transition-colors",type:"button",children:l.jsx(_l,{size:16,className:"text-fg-primary"})}),l.jsxs("div",{className:"text-sm font-body text-fg-primary",children:[b[w.getMonth()]," ",w.getFullYear()]}),l.jsx("button",{onClick:ie,className:"p-1 hover:bg-bg-dark rounded transition-colors",type:"button",children:l.jsx(ku,{size:16,className:"text-fg-primary"})})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(fe=>l.jsx("div",{className:"w-6 h-6 flex items-center justify-center text-xs text-fg-secondary font-body",children:fe},fe))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:W.map((fe,oe)=>{if(fe===null)return l.jsx("div",{className:"w-6 h-6"},`empty-${oe}`);const Ce=o&&new Date(o).getDate()===fe&&new Date(o).getMonth()===w.getMonth()&&new Date(o).getFullYear()===w.getFullYear();return l.jsx("button",{onClick:()=>ve(fe),className:`
                      w-6 h-6 flex items-center justify-center text-xs rounded
                      transition-colors duration-150 font-body
                      ${Ce?"bg-accent-primary text-bg-dark font-semibold":"text-fg-primary hover:bg-bg-dark"}
                    `,type:"button",children:fe},fe)})})]})]}),u&&l.jsx("div",{className:"mt-1 text-xs text-status-danger font-body",children:u})]})}function wl({label:o,error:s,className:i="",onChange:u,type:f="text",...h}){const x=Nl.useRef(null);if(f==="date")return l.jsx(Fx,{value:h.value,onChange:E=>{u?.({target:{value:E}})},label:o,error:s,disabled:h.disabled});const w=E=>{u?.(E)};return l.jsxs("div",{className:"w-full",children:[o&&l.jsx("label",{className:"block text-sm text-fg-secondary mb-1 font-body",children:o}),l.jsx("input",{ref:x,className:`
          w-full bg-bg-dark text-fg-primary border border-border rounded-sm
          px-2 py-1 text-sm font-body
          focus:border-accent-primary focus:outline-none focus:ring-1 focus:ring-accent-primary
          disabled:bg-bg-light disabled:text-fg-disabled disabled:cursor-not-allowed
          transition-colors duration-200
          ${s?"border-status-danger":""}
          ${i}
        `,type:f,onChange:w,...h}),s&&l.jsx("div",{className:"mt-1 text-xs text-status-danger font-body",children:s})]})}function $m({label:o,options:s,error:i,className:u="",...f}){return l.jsxs("div",{className:"w-full",children:[o&&l.jsx("label",{className:"block text-sm text-fg-secondary mb-1 font-body",children:o}),l.jsx("select",{className:`
          w-full bg-bg-dark text-fg-primary border border-border rounded-sm
          px-2 py-1 text-sm font-body
          focus:border-accent-primary focus:outline-none focus:ring-1 focus:ring-accent-primary
          disabled:bg-bg-light disabled:text-fg-disabled disabled:cursor-not-allowed
          transition-colors duration-200
          ${i?"border-status-danger":""}
          ${u}
        `,...f,children:s.map(h=>l.jsx("option",{value:h.value,children:h.label},h.value))}),i&&l.jsx("div",{className:"mt-1 text-xs text-status-danger font-body",children:i})]})}function Hm({label:o,value:s,onChange:i,error:u,className:f="",...h}){const x=w=>{const E=w.target.value;(E===""||/^\d*(\.\d{0,2})?$/.test(E))&&i(w)};return l.jsxs("div",{className:"w-full",children:[o&&l.jsx("label",{className:"block text-sm text-fg-secondary mb-1 font-body",children:o}),l.jsxs("div",{className:"relative",children:[l.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-fg-secondary",children:"$"}),l.jsx("input",{className:`pl-6 w-full bg-bg-dark text-fg-primary border border-border rounded-sm px-2 py-1 text-sm font-body focus:border-accent-primary focus:outline-none focus:ring-1 focus:ring-accent-primary disabled:bg-bg-light disabled:text-fg-disabled disabled:cursor-not-allowed transition-colors duration-200 ${u?"border-status-danger":""} ${f}`,inputMode:"decimal",pattern:"^\\\\d*(\\\\.\\\\d{0,2})?$",value:s,onChange:x,...h})]}),u&&l.jsx("div",{className:"mt-1 text-xs text-status-danger font-body",children:u})]})}class Zx{baseUrl;constructor(){this.baseUrl=`${Dn}/api/v1/text-editor`}transformState(s){return{sessionId:s.session_id,propertyId:s.property_id,nodeId:s.node_id,currentText:s.current_text,canUndo:s.can_undo,canRedo:s.can_redo,undoCount:s.undo_count,redoCount:s.redo_count,lastModified:s.last_modified,formattedText:s.formatted_text}}async createSession(s,i,u=""){const f=await fetch(`${this.baseUrl}/session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({property_id:s,node_id:i,initial_text:u})});if(!f.ok)throw new Error(`Failed to create text editing session: ${f.statusText}`);const h=await f.json();return{sessionId:h.session_id,state:this.transformState(h.state)}}async getSessionState(s){const i=await fetch(`${this.baseUrl}/session/${s}`);if(!i.ok)throw new Error(`Failed to get session state: ${i.statusText}`);const u=await i.json();return this.transformState(u.state)}async closeSession(s){const i=await fetch(`${this.baseUrl}/session/${s}`,{method:"DELETE"});if(!i.ok)throw new Error(`Failed to close session: ${i.statusText}`);return(await i.json()).final_text}async applyEdit(s,i){const u={before_text:i.beforeText,after_text:i.afterText,cursor_position:i.cursorPosition,selection_start:i.selectionStart,selection_end:i.selectionEnd,operation_type:i.operationType||"replace"};i.tokenConfig&&(u.token_config=i.tokenConfig);const f=await fetch(`${this.baseUrl}/session/${s}/edit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!f.ok)throw new Error(`Failed to apply edit: ${f.statusText}`);const h=await f.json(),x=this.transformState(h.state);return h.formatted_text&&(x.formattedText=h.formatted_text),x}async undo(s){const i=await fetch(`${this.baseUrl}/session/${s}/undo`,{method:"POST"});if(i.status===400)return null;if(!i.ok)throw new Error(`Failed to undo: ${i.statusText}`);const u=await i.json();return{text:u.text,cursorPosition:u.cursor_position,selectionStart:u.selection_start,selectionEnd:u.selection_end,canUndo:u.can_undo,canRedo:u.can_redo}}async redo(s){const i=await fetch(`${this.baseUrl}/session/${s}/redo`,{method:"POST"});if(i.status===400)return null;if(!i.ok)throw new Error(`Failed to redo: ${i.statusText}`);const u=await i.json();return{text:u.text,cursorPosition:u.cursor_position,selectionStart:u.selection_start,selectionEnd:u.selection_end,canUndo:u.can_undo,canRedo:u.can_redo}}}const Sl=new Zx;class Kx{baseUrl;constructor(){this.baseUrl=`${Dn}/api/v1/text-editor`}async checkText(s){const i=await fetch(`${this.baseUrl}/spell-check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})});if(!i.ok)throw new Error(`Failed to check spelling: ${i.statusText}`);return{misspellings:(await i.json()).misspellings}}async addToDictionary(s){const i=await fetch(`${this.baseUrl}/spell-check/add-word`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({word:s})});if(!i.ok)throw new Error(`Failed to add word to dictionary: ${i.statusText}`)}async ignoreWord(s){const i=await fetch(`${this.baseUrl}/spell-check/ignore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({word:s})});if(!i.ok)throw new Error(`Failed to ignore word: ${i.statusText}`)}debounceTimers=new Map;async checkTextDebounced(s,i,u=500,f="default"){const h=this.debounceTimers.get(f);h&&clearTimeout(h);const x=setTimeout(async()=>{try{const w=await this.checkText(s);i(w)}catch(w){console.error("Spell check error:",w)}finally{this.debounceTimers.delete(f)}},u);this.debounceTimers.set(f,x)}cancelDebounced(s="default"){const i=this.debounceTimers.get(s);i&&(clearTimeout(i),this.debounceTimers.delete(s))}}const Vm=new Kx;function Jx({isOpen:o,title:s,value:i,propertyId:u,nodeId:f,onChange:h,onClose:x,onSave:w,template:E,markupProfile:y}){const S=m.useRef(null),b=m.useRef(null),[G,L]=m.useState(null),[ce,ie]=m.useState(!1),[ve,ge]=m.useState(!1),[Ee,_e]=m.useState([]),[W,Te]=m.useState(null),[fe,oe]=m.useState(0),[Ce,Re]=m.useState(E),[Oe,$]=m.useState("formatted"),[ye,ee]=m.useState(""),Se=m.useRef(null),B=m.useRef(new Map),v=(J,he)=>Oe==="raw"||he.length===0?J:J.split(`
`).map((Ge,z)=>{for(const U of he)if(!(!U.prefix||U.format_scope!=="line")&&Ge.startsWith(U.prefix))return B.current.set(z,U.id),Ge.substring(U.prefix.length);return B.current.delete(z),Ge}).join(`
`),M=(J,he,ke,De)=>{if(Oe!=="formatted")return ke;const Me=De.filter(D=>D.format_scope==="line"&&D.prefix),Ge=J.split(`
`),z=he.split(`
`);let U=0,C=0;for(let D=0;D<z.length;D+=1){const Q=Ge[D]||"",ue=z[D]||"",be=Me.find(je=>je.prefix&&Q.startsWith(je.prefix))?.prefix?.length||0;if(ke<=C+ue.length)return U+be+(ke-C);U+=Q.length+1,C+=ue.length+1}return J.length},Z=(J,he,ke,De)=>{if(Oe!=="formatted")return ke;const Me=De.filter(D=>D.format_scope==="line"&&D.prefix),Ge=J.split(`
`),z=he.split(`
`);let U=0,C=0;for(let D=0;D<Ge.length;D+=1){const Q=Ge[D]||"",ue=z[D]||"",be=Me.find(je=>je.prefix&&Q.startsWith(je.prefix))?.prefix?.length||0;if(ke<=U+Q.length){const je=Math.max(0,ke-U-be);return C+Math.min(ue.length,je)}U+=Q.length+1,C+=ue.length+1}return he.length},j=(J,he)=>Oe==="raw"||he.length===0?J:J.split(`
`).map((Me,Ge)=>{const z=B.current.get(Ge);if(!z)return Me;const U=he.find(C=>C.id===z);return!U||!U.prefix?Me:`${U.prefix}${Me}`}).join(`
`),se=J=>J.map(he=>({...he,prefix:`[${he.id.toUpperCase()}]`}));m.useEffect(()=>{if(console.log("[TemplateAwareEditor] Profile loading effect triggered:",{markupProfile:y,isDefined:!!y}),!y){if(console.log("[TemplateAwareEditor] No markup profile specified, using template"),E){const he={...E,tokens:se(E.tokens||[])};Re(he)}else Re(E);return}(async()=>{try{console.log(`[TemplateAwareEditor] Starting to load markup profile: ${y}`);const he=await fetch(`/api/v1/markup/${y}`);if(!he.ok){const Ge=await he.text();console.error(`[TemplateAwareEditor] API error (${he.status}):`,Ge),Re(E);return}const ke=await he.text();if(console.log("[TemplateAwareEditor] Raw API response:",ke),!ke){console.error("[TemplateAwareEditor] Empty response from API"),Re(E);return}let De;try{De=JSON.parse(ke)}catch(Ge){console.error("[TemplateAwareEditor] Failed to parse JSON response:",Ge,"Response:",ke),Re(E);return}console.log(`[TemplateAwareEditor] Loaded markup profile "${y}":`,De);const Me={name:De.name||De.label||y,tokens:se(De.tokens||[]),features:De.features||{},formatting:De.formatting,lists:De.lists,indentation:De.indentation};console.log(`[TemplateAwareEditor] Tokens loaded: ${Me.tokens?.length||0} tokens with injected prefixes`),console.log("[TemplateAwareEditor] Token prefixes:",Me.tokens?.map(Ge=>({id:Ge.id,prefix:Ge.prefix}))),Re(Me)}catch(he){const ke=he instanceof Error?he.message:String(he),De=he instanceof Error?he.stack:"";console.error(`[TemplateAwareEditor] Error loading markup profile ${y}: ${ke}`,De),Re(E)}})()},[y,E]);const g=Ce?.tokens||[],T=Ce?.features?.spell_check??!0,A=Oe==="formatted"?v(i,g):i;m.useEffect(()=>{console.log("[TemplateAwareEditor] Component mounted/updated:",{markupProfile:y,markupProfileDefined:y!==void 0,template:E?.name,isOpen:o})},[y,E,o]),m.useEffect(()=>{console.log("[TemplateAwareEditor] Loaded template:",{name:Ce?.name,tokensCount:g.length,tokens:g.map(J=>({id:J.id,label:J.label,prefix:J.prefix})),features:Ce?.features})},[Ce]),m.useEffect(()=>{if(!o||G)return;(async()=>{try{const{sessionId:he,state:ke}=await Sl.createSession(u,f,i);L(he),ie(ke.canUndo),ge(ke.canRedo)}catch(he){console.error("Failed to create session:",he)}})()},[o,u,f]),m.useEffect(()=>()=>{G&&!o&&Sl.closeSession(G).catch(console.error),Se.current&&clearTimeout(Se.current)},[G,o]),m.useEffect(()=>{o&&S.current&&S.current.focus()},[o]);const X=J=>{b.current&&(b.current.scrollTop=J.currentTarget.scrollTop,b.current.scrollLeft=J.currentTarget.scrollLeft)},me=J=>{const he={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return J.replace(/[&<>"']/g,ke=>he[ke])},we=J=>{if(!J)return"";const he=[];return J.bold&&he.push("font-weight: bold"),J.italic&&he.push("font-style: italic"),J.underline&&he.push("text-decoration: underline"),J.color&&he.push(`color: ${J.color}`),J.background_color&&he.push(`background-color: ${J.background_color}`),J.font_size&&he.push(`font-size: ${J.font_size}`),J.align&&he.push(`text-align: ${J.align}`),he.join("; ")},qe=(J,he)=>{const ke=[];for(const De of he)if(De.prefix)if(De.format_scope==="line"){const Me=J.split(`
`);let Ge=0;for(const z of Me)z.startsWith(De.prefix)&&ke.push({index:Ge,token:De}),Ge+=z.length+1}else{let Me=0;for(;;){const Ge=J.indexOf(De.prefix,Me);if(Ge===-1)break;ke.push({index:Ge,token:De}),Me=Ge+De.prefix.length}}return ke.sort((De,Me)=>De.index-Me.index)},te=(J,he)=>!he?.text_transform||he.text_transform==="none"?J:he.text_transform==="uppercase"?J.toUpperCase():he.text_transform==="lowercase"?J.toLowerCase():he.text_transform==="capitalize"?J.replace(/\b\w/g,ke=>ke.toUpperCase()):J,de=(J,he)=>{if(!J)return"";const ke=he.filter(U=>U.prefix&&U.format_scope==="line"),De=(U,C,D)=>{const Q=te(U,D);if(C.length===0)return me(Q);const ue=C.filter(Ne=>Ne.end>Ne.start).sort((Ne,Le)=>Ne.start-Le.start);let be="",je=0;for(const Ne of ue)Ne.start<je||(Ne.start>je&&(be+=me(Q.slice(je,Ne.start))),be+=`<span class="tae-spelling-error">${me(Q.slice(Ne.start,Ne.end))}</span>`,je=Ne.end);return je<Q.length&&(be+=me(Q.slice(je))),be},Me=J.split(`
`),Ge=[];let z=0;for(const U of Me){let C=U,D,Q=0;for(const He of ke)if(He.prefix&&C.startsWith(He.prefix)){Q=He.prefix.length,C=C.slice(Q),D=He.format;break}const ue=z,be=z+U.length,je=Ee.filter(He=>He.position>=ue&&He.position<be).map(He=>{const lt=He.position-ue-Q,ct=lt+He.length;return ct<=0||lt>=C.length?null:{start:Math.max(0,lt),end:Math.min(C.length,ct)}}).filter(He=>He!==null),Ne=De(C,je,D),Le=we(D);Le?Ge.push(`<div class="markup-line" style="${Le}">${Ne}</div>`):Ge.push(`<div class="markup-line">${Ne}</div>`),z+=U.length+1}return Ge.join("")},Xe=m.useMemo(()=>!o||Oe!=="formatted"?null:de(i,g),[o,i,g,Oe,Ee]);m.useEffect(()=>{g.length>0&&Xe&&console.log(`[TemplateAwareEditor] Rendered ${g.length} tokens, HTML length: ${Xe.length}`)},[Xe,g.length]),m.useEffect(()=>{if(!o||!T||!i){_e([]);return}return Se.current&&clearTimeout(Se.current),Se.current=setTimeout(async()=>{try{const J=await Vm.checkText(i);J.misspellings&&_e(J.misspellings.map(he=>({word:he.word,suggestions:he.suggestions||[],position:he.position||0,length:he.word.length})))}catch(J){console.error("Spell check failed:",J)}},500),()=>{Se.current&&clearTimeout(Se.current)}},[i,o,T]);const Je=m.useCallback(async J=>{const he=J.currentTarget.value,ke=Oe==="formatted"?j(he,g):he;if(h(ke),G)try{const De={beforeText:i,afterText:ke,cursorPosition:J.currentTarget.selectionStart,selectionStart:J.currentTarget.selectionStart,selectionEnd:J.currentTarget.selectionEnd,operationType:"replace"},Me=await Sl.applyEdit(G,De);ie(Me.canUndo),ge(Me.canRedo)}catch(De){console.error("Failed to apply edit:",De)}setTimeout(()=>un(),0)},[G,i,h]),Ie=m.useCallback(()=>{un()},[]),vt=m.useCallback(async(J,he,ke)=>{if(h(J),G)try{const De={beforeText:i,afterText:J,cursorPosition:ke,selectionStart:he,selectionEnd:ke,operationType:"replace"},Me=await Sl.applyEdit(G,De);ie(Me.canUndo),ge(Me.canRedo)}catch(De){console.error("Failed to apply edit:",De)}},[G,i,h]),Ot=m.useCallback(async()=>{if(G)try{const J=await Sl.undo(G);J&&S.current&&(h(J.text),ie(J.canUndo),ge(J.canRedo),S.current.selectionStart=J.cursorPosition,S.current.selectionEnd=J.cursorPosition)}catch(J){console.error("Undo failed:",J)}},[G,h]),zt=m.useCallback(async()=>{if(G)try{const J=await Sl.redo(G);J&&S.current&&(h(J.text),ie(J.canUndo),ge(J.canRedo),S.current.selectionStart=J.cursorPosition,S.current.selectionEnd=J.cursorPosition)}catch(J){console.error("Redo failed:",J)}},[G,h]),wt=async(J,he=J)=>{if(!S.current)return;const ke=S.current,De=ke.selectionStart,Me=ke.selectionEnd,Ge=i.substring(De,Me)||"text",z=i.substring(0,De),U=i.substring(Me),C=`${z}${J}${Ge}${he}${U}`,D=De+J.length,Q=D+Ge.length;await vt(C,D,Q),setTimeout(()=>{ke.focus(),ke.setSelectionRange(D,Q)},0)},Mt=async()=>{if(!S.current)return;const J=S.current,he=J.selectionStart,ke=i.substring(0,he),De=i.substring(he),Me=ke.lastIndexOf(`
`),Ge=Me===-1?0:Me+1,z="  ".repeat(fe);let U;he===Ge||ke[he-1]===`
`?U=`${ke}${z}- ${De}`:U=`${ke}
${z}- ${De}`;const C=U.length;await vt(U,C,C),setTimeout(()=>{J.focus(),J.setSelectionRange(C,C)},0)},Xt=async()=>{if(!S.current)return;const J=S.current,he=J.selectionStart,ke=i.substring(0,he),De=i.substring(he),Me=ke.lastIndexOf(`
`),Ge=Me===-1?0:Me+1,z="  ".repeat(fe),U=ke.substring(0,Ge).split(`
`);let C=1;for(let ue=U.length-2;ue>=0;ue--){const be=U[ue].match(/^\s*(\d+)\./);if(be){C=parseInt(be[1])+1;break}}let D;he===Ge||ke[he-1]===`
`?D=`${ke}${z}${C}. ${De}`:D=`${ke}
${z}${C}. ${De}`;const Q=D.length;await vt(D,Q,Q),setTimeout(()=>{J.focus(),J.setSelectionRange(Q,Q)},0)},Qt=()=>{const J=E?.indentation?.max_levels??5;oe(Math.min(fe+1,J))},Ut=()=>{oe(Math.max(fe-1,0))},un=()=>{if(!S.current){ee("");return}const J=S.current.selectionStart,he=qe(i,g),De=i.substring(0,J).lastIndexOf(`
`),Me=De===-1?0:De+1,Ge=i.indexOf(`
`,J),z=Ge===-1?i.length:Ge;for(const U of he){const C=U.token,D=C.prefix?.length||0;if(C.format_scope==="line"){if(U.index>=Me&&U.index<z&&J>=U.index&&J<=U.index+D){ee(C.id);return}}else if(J>=U.index&&J<U.index+D){ee(C.id);return}}for(const U of he){const C=U.token;if(C.format_scope==="line"&&U.index>=Me&&U.index<z){ee(C.id);return}}ee("")},On=async J=>{if(!S.current)return;const he=S.current,ke=he.selectionStart,De=he.selectionEnd,Me=ke!==De,Ge=Oe==="formatted"?A:i,z=M(i,Ge,ke,g),U=M(i,Ge,De,g),C=i.substring(0,z),D=i.substring(z,U),Q=i.substring(U);let ue,be,je;const Ne=J.prefix||"";if(J.format_scope==="line"){const ct=g.filter(ut=>ut.format_scope==="line"&&ut.prefix).map(ut=>ut.prefix),Ye=i.lastIndexOf(`
`,z-1)+1,Tt=i.indexOf(`
`,U),jt=Tt===-1?i.length:Tt,Lt=i.substring(Ye,jt),hn=z-Ye,ha=U-Ye,$a=Lt.split(`
`);let bn=0,Mn=0,Vn=0;const xn=$a.map((ut,St)=>{const vn=!ct.some(aa=>ut.startsWith(aa))&&ut!==""&&Ne;return vn&&(hn>=Vn&&(bn+=Ne.length),ha>=Vn&&(Mn+=Ne.length)),Vn+=ut.length+1,vn?`${Ne}${ut}`:ut}).join(`
`);ue=`${i.substring(0,Ye)}${xn}${i.substring(jt)}`,be=z+bn,je=Me?U+Mn:be}else Me?(ue=`${C}${Ne}${D}${Ne}${Q}`,be=z+Ne.length,je=z+Ne.length+D.length):(ue=`${C}${Ne}${Q}`,be=z+Ne.length,je=be);if(ue===i)return;await vt(ue,be,je);const Le=Oe==="formatted"?v(ue,g):ue,He=Z(ue,Le,be,g),lt=Z(ue,Le,je,g);setTimeout(()=>{he.focus(),he.setSelectionRange(He,lt)},0)},zn=J=>{J.preventDefault();const ke=J.currentTarget.selectionStart,De=Ee.find(Me=>ke>=Me.position&&ke<=Me.position+Me.length);Te(De?{x:J.clientX,y:J.clientY,word:De.word,suggestions:De.suggestions,position:De.position}:null)},Ht=J=>{if(!W)return;const he=i.substring(0,W.position)+J+i.substring(W.position+W.word.length);h(he),Te(null),S.current&&(S.current.focus(),S.current.setSelectionRange(W.position+J.length,W.position+J.length))},Qe=()=>{W&&Te(null)},Ft=()=>{w(i),x()};return o?l.jsxs("div",{className:"tae-modal",children:[l.jsx("div",{className:"tae-overlay",onClick:Qe}),l.jsxs("div",{className:"tae-container",onClick:Qe,children:[l.jsxs("div",{className:"tae-header",children:[l.jsx("h2",{className:"tae-title",children:s}),l.jsx("button",{className:"tae-close",onClick:x,"aria-label":"Close",children:l.jsx(Jr,{size:20})})]}),l.jsxs("div",{className:"tae-toolbar",children:[l.jsx("div",{className:"tae-toolbar-group",children:l.jsxs("select",{className:"tae-markup-selector",value:ye,disabled:g.length===0,onChange:J=>{if(J.target.value){const he=g.find(ke=>ke.id===J.target.value);he&&On(he)}},title:g.length===0?"No markup tags available for this template":ye?`Current tag on this line: ${ye}. Select a new tag to apply.`:"Select a tag to apply to selected text, or just insert at cursor",children:[l.jsx("option",{value:"",children:g.length===0?"No markup tags":ye?`${ye} (current)`:"Apply Markup Tag..."}),g.map(J=>l.jsx("option",{value:J.id,children:J.label},J.id))]})}),l.jsx("div",{className:"tae-toolbar-divider"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsx("button",{className:"tae-btn",onClick:Ot,disabled:!ce,title:"Undo",children:l.jsx(kb,{size:18})}),l.jsx("button",{className:"tae-btn",onClick:zt,disabled:!ve,title:"Redo",children:l.jsx(vb,{size:18})})]}),l.jsx("div",{className:"tae-toolbar-divider"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsx("button",{className:"tae-btn",onClick:()=>wt("**","**"),title:"Bold",children:l.jsx(Iy,{size:18})}),l.jsx("button",{className:"tae-btn",onClick:()=>wt("*","*"),title:"Italic",children:l.jsx(cb,{size:18})}),l.jsx("button",{className:"tae-btn",onClick:()=>wt("__","__"),title:"Underline",children:l.jsx(Cb,{size:18})})]}),l.jsx("div",{className:"tae-toolbar-divider"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsx("button",{className:"tae-btn",onClick:Mt,title:"Bullet List",children:l.jsx(hb,{size:18})}),l.jsx("button",{className:"tae-btn",onClick:Xt,title:"Numbered List",children:l.jsx(db,{size:18})})]}),l.jsx("div",{className:"tae-toolbar-divider"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsxs("label",{className:"tae-indent-label",children:["Indent: ",l.jsx("span",{className:"tae-indent-level",children:fe})]}),l.jsx("button",{className:"tae-btn tae-btn-sm",onClick:Ut,title:"Decrease indent",children:"-"}),l.jsx("button",{className:"tae-btn tae-btn-sm",onClick:Qt,title:"Increase indent",children:"+"})]}),l.jsx("div",{className:"tae-toolbar-spacer"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsx("button",{className:`tae-btn ${Oe==="formatted"?"tae-btn-active":""}`,onClick:()=>$("formatted"),title:"Formatted view",children:"Formatted"}),l.jsx("button",{className:`tae-btn ${Oe==="raw"?"tae-btn-active":""}`,onClick:()=>$("raw"),title:"Raw view",children:"Raw"})]}),l.jsx("div",{className:"tae-toolbar-divider"}),l.jsxs("div",{className:"tae-toolbar-group",children:[l.jsx("button",{className:"tae-save-btn",onClick:Ft,children:"Save"}),l.jsx("button",{className:"tae-cancel-btn",onClick:x,children:"Cancel"})]})]}),l.jsxs("div",{className:"tae-editor-wrapper",children:[l.jsx("textarea",{ref:S,className:"tae-textarea",value:A,onChange:Je,onScroll:X,onContextMenu:zn,onClick:Ie,onKeyUp:Ie,placeholder:"Start typing...",spellCheck:"false","data-view-mode":Oe}),Oe==="formatted"&&l.jsx("div",{className:"tae-render-layer tae-render-layer-overlay",ref:b,children:Xe&&l.jsx("div",{className:"tae-rendered-content",dangerouslySetInnerHTML:{__html:Xe}})})]}),W&&l.jsxs("div",{className:"tae-context-menu",style:{top:W.y,left:W.x},onClick:J=>J.stopPropagation(),children:[l.jsx("div",{className:"tae-context-word",children:W.word}),l.jsx("div",{className:"tae-context-divider"}),W.suggestions.slice(0,5).map((J,he)=>l.jsx("button",{className:"tae-context-item",onClick:()=>Ht(J),children:J},he)),l.jsx("div",{className:"tae-context-divider"}),l.jsx("button",{className:"tae-context-item",onClick:async()=>{await Vm.addToDictionary(W.word),_e(Ee.filter(J=>J.word!==W.word)),Te(null)},children:"Add to Dictionary"}),l.jsx("button",{className:"tae-context-item",onClick:()=>Te(null),children:"Ignore"})]}),l.jsxs("div",{className:"tae-status-bar",children:[l.jsxs("span",{children:[i.length," characters"]}),l.jsxs("span",{children:[i.split(`
`).length," lines"]}),T&&l.jsx("span",{className:`tae-spell-count ${Ee.length>0?"tae-spell-error":"tae-spell-ok"}`,children:Ee.length===0?" No errors":` ${Ee.length} misspellings`})]})]})]}):null}function Ix({nodeId:o,nodeName:s,nodeType:i,properties:u,onPropertyChange:f,linkedAsset:h,onLinkedAssetPropertyChange:x,orphanedProperties:w,onOrphanedPropertyDelete:E,blockedByNodes:y=[],blocksNodes:S=[],nodes:b={},onClearBlocks:G,velocityScore:L}){const[ce,ie]=m.useState({}),ve=m.useRef({}),[ge,Ee]=m.useState({isOpen:!1,propId:"",propName:"",value:"",isLinkedAsset:!1}),_e=($,ye)=>{f?.($,ye)},W=($,ye)=>{x?.($,ye)};m.useEffect(()=>{ie({}),Object.values(ve.current).forEach(clearTimeout),ve.current={}},[o,h?.nodeId]);const Te=($,ye)=>`${ye?"asset":"node"}:${$}`,fe=($,ye,ee)=>{ee?W($,ye):_e($,ye)},oe=($,ye,ee,Se)=>{ve.current[$]&&clearTimeout(ve.current[$]),ve.current[$]=setTimeout(()=>{fe(ye,ee,Se),delete ve.current[$]},250)},Ce=($,ye,ee,Se=!1,B)=>{console.log("[Inspector] Opening editor with:",{propId:$,propName:ye,markupProfile:B}),Ee({isOpen:!0,propId:$,propName:ye,value:String(ee),isLinkedAsset:Se,markupProfile:B})},Re=()=>{console.log("[Inspector] Closing editor"),Ee({isOpen:!1,propId:"",propName:"",value:"",isLinkedAsset:!1,markupProfile:void 0})},Oe=$=>{ge.isLinkedAsset?x?.(ge.propId,$):f?.(ge.propId,$),Re()};return o?l.jsxs("aside",{className:"bg-bg-light border-l border-border flex-1 flex flex-col h-full overflow-hidden",children:[l.jsx("div",{className:"text-sm font-semibold border-b border-accent-primary pb-2 mb-3 px-3 pt-3 flex-shrink-0",children:"Properties"}),l.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-3 pb-3",children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"text-xs text-fg-secondary mb-1",children:"Node Type"}),l.jsx("div",{className:"text-sm text-fg-primary font-semibold bg-accent-primary/10 rounded px-2 py-1 capitalize",children:i||"Unknown"})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"text-xs text-fg-secondary mb-1",children:"Node ID"}),l.jsx("div",{className:"text-sm text-fg-primary font-mono bg-bg-dark rounded px-2 py-1 truncate",title:o,children:o})]}),l.jsx("div",{className:"space-y-3",children:u.map($=>{const ye=$.value,ee=Te($.id,!1),Se=ce[ee]??String(ye??"");return l.jsxs("div",{children:[$.type==="text"&&l.jsx(wl,{label:$.name,value:Se,onChange:B=>{const v=B.target.value;ie(M=>({...M,[ee]:v})),oe(ee,$.id,v,!1)},onBlur:B=>{fe($.id,B.target.value,!1)},required:$.required}),$.type==="number"&&l.jsx(wl,{label:$.name,type:"number",value:ye,onChange:B=>_e($.id,B.target.valueAsNumber),required:$.required}),$.type==="currency"&&l.jsx(Hm,{label:$.name,value:ye,onChange:B=>_e($.id,B.target.value),required:$.required}),$.type==="date"&&l.jsx(wl,{label:$.name,type:"date",value:ye,onChange:B=>_e($.id,B.target.value),required:$.required}),$.type==="select"&&$.options&&l.jsx($m,{label:$.name,value:String(ye),onChange:B=>_e($.id,B.target.value),options:$.options,required:$.required}),$.type==="textarea"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:$.name}),l.jsx("textarea",{value:Se,onChange:B=>{const v=B.target.value;ie(M=>({...M,[ee]:v})),oe(ee,$.id,v,!1)},onBlur:B=>{fe($.id,B.target.value,!1)},className:"w-full bg-bg-dark text-fg-primary border border-border rounded-sm px-2 py-1 text-sm font-body focus:border-accent-primary focus:outline-none resize-none",rows:3,required:$.required})]}),$.type==="checkbox"&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",id:`checkbox-${$.id}`,checked:ye==="true"||ye===1||ye==="1",onChange:B=>_e($.id,B.target.checked?"true":"false"),className:"w-4 h-4 cursor-pointer accent-accent-primary"}),l.jsx("label",{htmlFor:`checkbox-${$.id}`,className:"text-sm text-fg-secondary cursor-pointer",children:$.name})]}),$.type==="editor"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:$.name}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsxs("div",{className:"flex-1 bg-bg-dark text-fg-primary border border-border rounded-sm px-2 py-1 text-sm truncate",children:[String(ye).substring(0,50),String(ye).length>50?"...":""]}),l.jsx("button",{onClick:()=>Ce($.id,$.name,ye,!1,$.markupProfile),className:"px-3 py-1 bg-accent-primary text-fg-primary rounded hover:bg-accent-hover transition-colors text-sm font-semibold",children:"Edit"})]})]})]},$.id)})}),(y.length>0||S.length>0)&&l.jsxs("div",{className:"mt-6 pt-6 border-t border-border",children:[l.jsx("div",{className:"text-sm font-semibold text-fg-primary mb-2",children:"Blocking"}),y.length>0&&l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"flex items-center justify-between mb-1",children:l.jsxs("div",{className:"text-xs text-fg-secondary",children:["Blocked By (",y.length,")"]})}),l.jsx("ul",{className:"space-y-1 text-sm text-fg-primary",children:y.map($=>{const ee=b[$]?.properties?.name||$;return l.jsx("li",{className:"truncate",title:ee,children:ee},$)})})]}),S.length>0&&l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"flex items-center justify-between mb-1",children:l.jsxs("div",{className:"text-xs text-fg-secondary",children:["Blocks (",S.length,")"]})}),l.jsx("ul",{className:"space-y-1 text-sm text-fg-primary mb-2",children:S.map($=>{const ee=b[$]?.properties?.name||$;return l.jsx("li",{className:"truncate",title:ee,children:ee},$)})}),G&&o&&l.jsx("button",{onClick:()=>G(o),className:"text-xs px-2 py-1 bg-orange-500/20 text-orange-400 rounded border border-orange-500/50 hover:bg-orange-500/30 transition-colors",children:"Clear"})]})]}),L&&l.jsxs("div",{className:"mt-6 pt-6 border-t border-border",children:[l.jsx("div",{className:"text-sm font-semibold text-fg-primary mb-2",children:"Velocity"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs text-fg-secondary",children:"Total Score:"}),l.jsx("span",{className:"text-sm font-semibold text-fg-primary",children:L.totalVelocity})]}),l.jsxs("div",{className:"text-xs text-fg-secondary border-t border-border/50 pt-2 space-y-1",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Base:"}),l.jsx("span",{className:"text-fg-primary",children:L.baseScore})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Inherited:"}),l.jsx("span",{className:"text-fg-primary",children:L.inheritedScore})]}),L.statusScore!==0&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Status:"}),l.jsx("span",{className:"text-fg-primary",children:L.statusScore})]}),L.numericalScore!==0&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Numerical:"}),l.jsx("span",{className:"text-fg-primary",children:L.numericalScore})]}),L.blockingBonus!==0&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Blocking Bonus:"}),l.jsx("span",{className:"text-fg-primary",children:L.blockingBonus})]}),L.blockingPenalty!==0&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:"Blocking Penalty:"}),l.jsx("span",{className:"text-fg-primary",children:L.blockingPenalty})]})]})]})]}),w&&Object.keys(w).length>0&&l.jsxs("div",{className:"mt-6 pt-6 border-t border-border",children:[l.jsxs("div",{className:"text-sm font-semibold border-b border-orange-500/50 pb-2 mb-3 text-orange-400 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Orphaned Properties"]}),l.jsx("div",{className:"mb-3 text-xs text-orange-300/80 bg-orange-500/10 border border-orange-500/30 rounded px-2 py-2",children:"These properties were removed from the template but their values are preserved. They are read-only."}),l.jsx("div",{className:"space-y-3",children:Object.entries(w).map(([$,ye])=>l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:$}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsx("div",{className:"flex-1 bg-bg-dark/50 text-fg-primary/70 border border-orange-500/30 rounded-sm px-2 py-1 text-sm",children:String(ye)}),E&&l.jsx("button",{onClick:()=>E($),className:"px-3 py-1 bg-status-danger/20 text-status-danger rounded hover:bg-status-danger/30 transition-colors text-sm font-semibold",title:"Delete orphaned property",children:"Delete"})]})]},$))})]}),h&&l.jsxs("div",{className:"mt-6 pt-6 border-t border-border",children:[l.jsxs("div",{className:"text-sm font-semibold border-b border-accent-success pb-2 mb-3 text-accent-success",children:["Linked Asset: ",h.name]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"text-xs text-fg-secondary mb-1",children:"Asset Type"}),l.jsx("div",{className:"text-sm text-fg-primary font-semibold bg-accent-success/10 rounded px-2 py-1 capitalize",children:h.nodeType})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("div",{className:"text-xs text-fg-secondary mb-1",children:"Asset ID"}),l.jsx("div",{className:"text-sm text-fg-primary font-mono bg-bg-dark rounded px-2 py-1 truncate",title:h.nodeId,children:h.nodeId})]}),l.jsx("div",{className:"space-y-3",children:h.properties.map($=>{const ye=$.value,ee=Te($.id,!0),Se=ce[ee]??String(ye??"");return l.jsxs("div",{children:[$.type==="text"&&l.jsx(wl,{label:$.name,value:Se,onChange:B=>{const v=B.target.value;ie(M=>({...M,[ee]:v})),oe(ee,$.id,v,!0)},onBlur:B=>{fe($.id,B.target.value,!0)},required:$.required}),$.type==="number"&&l.jsx(wl,{label:$.name,type:"number",value:ye,onChange:B=>W($.id,B.target.valueAsNumber),required:$.required}),$.type==="currency"&&l.jsx(Hm,{label:$.name,value:ye,onChange:B=>W($.id,B.target.value),required:$.required}),$.type==="date"&&l.jsx(wl,{label:$.name,type:"date",value:ye,onChange:B=>W($.id,B.target.value),required:$.required}),$.type==="select"&&$.options&&l.jsx($m,{label:$.name,value:String(ye),onChange:B=>W($.id,B.target.value),options:$.options,required:$.required}),$.type==="textarea"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:$.name}),l.jsx("textarea",{value:Se,onChange:B=>{const v=B.target.value;ie(M=>({...M,[ee]:v})),oe(ee,$.id,v,!0)},onBlur:B=>{fe($.id,B.target.value,!0)},className:"w-full bg-bg-dark text-fg-primary border border-border rounded-sm px-2 py-1 text-sm font-body focus:border-accent-primary focus:outline-none resize-none",rows:3,required:$.required})]}),$.type==="checkbox"&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",id:`checkbox-asset-${$.id}`,checked:ye==="true"||ye===1||ye==="1",onChange:B=>W($.id,B.target.checked?"true":"false"),className:"w-4 h-4 cursor-pointer accent-accent-primary"}),l.jsx("label",{htmlFor:`checkbox-asset-${$.id}`,className:"text-sm text-fg-secondary cursor-pointer",children:$.name})]}),$.type==="editor"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:$.name}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsxs("div",{className:"flex-1 bg-bg-dark text-fg-primary border border-border rounded-sm px-2 py-1 text-sm truncate",children:[String(ye).substring(0,50),String(ye).length>50?"...":""]}),l.jsx("button",{onClick:()=>Ce($.id,$.name,ye,!0,$.markupProfile),className:"px-3 py-1 bg-accent-primary text-fg-primary rounded hover:bg-accent-hover transition-colors text-sm font-semibold",children:"Edit"})]})]})]},$.id)})})]}),l.jsx(Jx,{isOpen:ge.isOpen,title:ge.propName,value:ge.value,propertyId:ge.propId,nodeId:o||"",onChange:$=>{Ee({...ge,value:$})},onClose:Re,onSave:Oe,template:void 0,markupProfile:ge.markupProfile})]})]}):l.jsx("aside",{className:"bg-bg-light border-l border-border p-3 flex items-center justify-center",children:l.jsx("div",{className:"text-sm text-fg-secondary text-center",children:"Select a node to view properties"})})}function Gm({templates:o,onConfirm:s,onCancel:i,title:u="New Project",confirmLabel:f="Create"}){const[h,x]=m.useState(o[0]?.id||""),[w,E]=m.useState("New Project"),y=()=>{if(!h||!w.trim()){alert("Please select a template and enter a project name");return}s(h,w)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-lg p-6 w-96",children:[l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary mb-4",children:u}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Template"}),l.jsx("select",{value:h,onChange:S=>x(S.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",children:o.map(S=>l.jsx("option",{value:S.id,children:S.name},S.id))}),o.find(S=>S.id===h)?.description&&l.jsx("p",{className:"text-xs text-fg-secondary mt-1",children:o.find(S=>S.id===h)?.description})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Project Name"}),l.jsx("input",{type:"text",value:w,onChange:S=>E(S.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",placeholder:"Enter project name",onKeyDown:S=>{S.key==="Enter"&&y(),S.key==="Escape"&&i()},autoFocus:!0})]})]}),l.jsxs("div",{className:"flex gap-2 mt-6",children:[l.jsx("button",{onClick:i,className:"flex-1 px-4 py-2 bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection",children:"Cancel"}),l.jsx("button",{onClick:y,className:"flex-1 px-4 py-2 bg-accent-primary rounded text-fg-primary hover:bg-accent-hover",children:f})]})]})})}function Wx({title:o="Add Child Node",confirmLabel:s="Add Child",onConfirm:i,onCancel:u}){const[f,h]=m.useState("New Child"),x=()=>{if(!f.trim()){alert("Please enter a name");return}i(f.trim())};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-lg p-6 w-96",children:[l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary mb-4",children:o}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Child Name"}),l.jsx("input",{type:"text",value:f,onChange:w=>h(w.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",placeholder:"Enter child name",onKeyDown:w=>{w.key==="Enter"&&x(),w.key==="Escape"&&u()},autoFocus:!0})]})}),l.jsxs("div",{className:"flex gap-2 mt-6",children:[l.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection",children:"Cancel"}),l.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-accent-primary rounded text-fg-primary hover:bg-accent-hover",children:s})]})]})})}function Px({title:o="Select Asset",assets:s,onConfirm:i,onCancel:u}){const[f,h]=m.useState(s[0]?.id??""),x=m.useMemo(()=>{const E=new Map;for(const y of s){const S=y.typeLabel||y.type,b=E.get(S)??[];b.push(y),E.set(S,b)}return Array.from(E.entries()).sort((y,S)=>y[0].localeCompare(S[0]))},[s]),w=()=>{if(!f){alert("Please select an asset");return}i(f)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-lg p-6 w-[28rem]",children:[l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary mb-4",children:o}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Asset"}),l.jsxs("select",{value:f,onChange:E=>h(E.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",children:[s.length===0&&l.jsx("option",{value:"",disabled:!0,children:"No assets available"}),x.map(([E,y])=>l.jsx("optgroup",{label:E,children:y.map(S=>l.jsx("option",{value:S.id,children:S.name},S.id))},E))]})]})}),l.jsxs("div",{className:"flex gap-2 mt-6",children:[l.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection",children:"Cancel"}),l.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-accent-primary rounded text-fg-primary hover:bg-accent-hover",children:"Add Asset"})]})]})})}function ev({title:o="Add Asset Category",categories:s,onConfirm:i,onCancel:u}){const[f,h]=m.useState(s[0]?.id??""),x=m.useMemo(()=>s.find(S=>S.id===f)?.label||"",[s,f]),[w,E]=m.useState(x||"");m.useEffect(()=>{x&&E(x)},[x]);const y=()=>{if(!f){alert("Please select a category");return}if(!w.trim()){alert("Please enter a name");return}i(f,w.trim())};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-lg p-6 w-[28rem]",children:[l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary mb-4",children:o}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Category Type"}),l.jsxs("select",{value:f,onChange:S=>h(S.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",children:[s.length===0&&l.jsx("option",{value:"",disabled:!0,children:"No categories available"}),s.map(S=>l.jsx("option",{value:S.id,children:S.label},S.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-primary mb-2",children:"Category Name"}),l.jsx("input",{type:"text",value:w,onChange:S=>E(S.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",placeholder:"Enter category name"})]})]}),l.jsxs("div",{className:"flex gap-2 mt-6",children:[l.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection",children:"Cancel"}),l.jsx("button",{onClick:y,className:"flex-1 px-4 py-2 bg-accent-primary rounded text-fg-primary hover:bg-accent-hover",children:"Add Category"})]})]})})}const tv=(o,s)=>{if(!o)return o;let i=o;return i=i.replace(/fill="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill="${f}"`:`fill="${s}"`}).replace(/fill='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill='${f}'`:`fill='${s}'`}).replace(/stroke="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke="${f}"`:`stroke="${s}"`}).replace(/stroke='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke='${f}'`:`stroke='${s}'`}),i=i.replace(/style="([^"]*)"/g,(u,f)=>`style="${String(f).replace(/fill:\s*[^;]+/gi,x=>{const w=x.split(":")[1]?.trim().toLowerCase();return w==="none"||w==="transparent"?x:`fill:${s}`}).replace(/stroke:\s*[^;]+/gi,x=>{const w=x.split(":")[1]?.trim().toLowerCase();return w==="none"||w==="transparent"?x:`stroke:${s}`})}"`),i};function nv({isOpen:o,onClose:s}){const[i,u]=m.useState(14),[f,h]=m.useState(null),[x,w]=m.useState({}),[E,y]=m.useState(null);m.useEffect(()=>{const L=localStorage.getItem("indicator_size");if(L){const ce=parseInt(L,10);isNaN(ce)||(u(ce),S(ce))}},[]),m.useEffect(()=>{if(!o)return;(async()=>{try{y(null);const ce=await fetch(`${Dn}/api/v1/indicators/catalog`);if(!ce.ok)throw new Error(`Failed to load catalog (${ce.status})`);const ie=await ce.json();h(ie);const ve={},ge=ie.indicator_sets||{},Ee=[];Object.entries(ge).forEach(([_e,W])=>{(W.indicators||[]).forEach(Te=>{const fe=`${_e}:${Te.id}`;Ee.push(fetch(`${Dn}/api/v1/indicators/${_e}/${Te.id}`).then(oe=>oe.ok?oe.text():"").then(oe=>{oe&&(ve[fe]=oe)}).catch(()=>{}))})}),await Promise.all(Ee),w(ve)}catch{y("Failed to load indicator preview")}})()},[o]);const S=L=>{document.documentElement.style.setProperty("--indicator-size",`${L}px`)},b=L=>{const ce=parseInt(L.target.value,10);isNaN(ce)||(u(ce),S(ce),localStorage.setItem("indicator_size",String(ce)))},G=()=>{u(14),S(14),localStorage.setItem("indicator_size",String(14))};return o?l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-[var(--color-bg-light)] border border-[var(--color-border-default)] rounded-lg shadow-xl w-[500px] max-h-[80vh] flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[var(--color-border-default)]",children:[l.jsx("h2",{className:"text-lg font-semibold text-[var(--color-fg-primary)]",children:"Settings"}),l.jsx("button",{onClick:s,className:"p-1 hover:bg-[var(--color-bg-selection)] rounded transition-colors","aria-label":"Close",children:l.jsx(Jr,{size:20,className:"text-[var(--color-fg-secondary)]"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-6",children:l.jsxs("section",{children:[l.jsx("h3",{className:"text-sm font-semibold text-[var(--color-fg-primary)] mb-3",children:"Appearance"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{htmlFor:"indicator-size",className:"text-sm text-[var(--color-fg-secondary)]",children:"Indicator Size"}),l.jsxs("span",{className:"text-sm text-[var(--color-fg-primary)] font-mono",children:[i,"px"]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("input",{id:"indicator-size",type:"range",min:"8",max:"32",step:"2",value:i,onChange:b,className:`flex-1 h-2 bg-[var(--color-bg-selection)] rounded-lg appearance-none cursor-pointer\r
                    [&::-webkit-slider-thumb]:appearance-none \r
                    [&::-webkit-slider-thumb]:w-4 \r
                    [&::-webkit-slider-thumb]:h-4 \r
                    [&::-webkit-slider-thumb]:rounded-full \r
                    [&::-webkit-slider-thumb]:bg-[var(--color-accent-primary)]\r
                    [&::-webkit-slider-thumb]:cursor-pointer\r
                    [&::-moz-range-thumb]:w-4 \r
                    [&::-moz-range-thumb]:h-4 \r
                    [&::-moz-range-thumb]:rounded-full \r
                    [&::-moz-range-thumb]:bg-[var(--color-accent-primary)]\r
                    [&::-moz-range-thumb]:border-0\r
                    [&::-moz-range-thumb]:cursor-pointer`}),l.jsx("span",{className:"text-xs text-[var(--color-fg-secondary)] w-16 text-right",children:"8-32px"})]}),l.jsxs("div",{className:"space-y-3 p-3 bg-[var(--color-bg-dark)] rounded border border-[var(--color-border-default)]",children:[l.jsx("div",{className:"text-sm text-[var(--color-fg-secondary)]",children:"Preview:"}),E?l.jsx("div",{className:"text-xs text-[var(--color-fg-secondary)]",children:E}):f?l.jsx("div",{className:"space-y-3",children:Object.entries(f.indicator_sets||{}).map(([L,ce])=>l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"text-xs font-semibold text-[var(--color-fg-secondary)] uppercase tracking-wide",children:L}),l.jsx("div",{className:"flex flex-wrap gap-2",children:(ce.indicators||[]).map(ie=>{const ve=`${L}:${ie.id}`,ge=x[ve];return l.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded border border-[var(--color-border-default)] bg-[var(--color-bg-light)]",children:[ge?l.jsx("span",{className:"status-indicator-svg",dangerouslySetInnerHTML:{__html:tv(ge,"#ffffff")}}):l.jsx("span",{className:"status-indicator-text text-xs opacity-60",children:"..."}),l.jsx("span",{className:"text-xs text-[var(--color-fg-secondary)]",children:ie.id})]},ve)})})]},L))}):l.jsx("div",{className:"text-xs text-[var(--color-fg-secondary)]",children:"Loading indicators..."})]})]})]})}),l.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-[var(--color-border-default)]",children:[l.jsx("button",{onClick:G,className:"px-4 py-2 text-sm text-[var(--color-fg-secondary)] hover:text-[var(--color-fg-primary)] hover:bg-[var(--color-bg-selection)] rounded transition-colors",children:"Reset to Default"}),l.jsx("button",{onClick:s,className:"px-4 py-2 text-sm bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-hover)] text-white rounded transition-colors",children:"Done"})]})]})}):null}function av({onConfirm:o,onCancel:s,isOpen:i=!0}){const[u,f]=m.useState("cancel");if(!i)return null;const h=()=>{o?.(u)},x=()=>{s?.()};return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-lg max-w-md w-full mx-4",children:[l.jsx("div",{className:"border-b border-border px-6 py-4",children:l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary",children:"Unsaved Changes"})}),l.jsxs("div",{className:"px-6 py-4",children:[l.jsx("p",{className:"text-fg-primary mb-6",children:"You have unsaved changes. What would you like to do?"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center p-3 border border-border rounded hover:bg-bg-selection cursor-pointer transition-colors",children:[l.jsx("input",{type:"radio",name:"action",value:"save",checked:u==="save",onChange:w=>f(w.target.value),className:"mr-3"}),l.jsx("span",{className:"text-fg-primary font-semibold",children:"Save"}),l.jsx("span",{className:"text-fg-secondary text-sm ml-2",children:"(Ctrl+S)"})]}),l.jsxs("label",{className:"flex items-center p-3 border border-border rounded hover:bg-bg-selection cursor-pointer transition-colors",children:[l.jsx("input",{type:"radio",name:"action",value:"save-as",checked:u==="save-as",onChange:w=>f(w.target.value),className:"mr-3"}),l.jsx("span",{className:"text-fg-primary font-semibold",children:"Save As"}),l.jsx("span",{className:"text-fg-secondary text-sm ml-2",children:"(Save to new location)"})]}),l.jsxs("label",{className:"flex items-center p-3 border border-border rounded hover:bg-bg-selection cursor-pointer transition-colors",children:[l.jsx("input",{type:"radio",name:"action",value:"dont-save",checked:u==="dont-save",onChange:w=>f(w.target.value),className:"mr-3"}),l.jsx("span",{className:"text-fg-primary font-semibold",children:"Don't Save"}),l.jsx("span",{className:"text-fg-secondary text-sm ml-2",children:"(Discard changes)"})]})]})]}),l.jsxs("div",{className:"border-t border-border px-6 py-4 flex justify-end gap-3",children:[l.jsx("button",{onClick:x,className:"px-4 py-2 bg-bg-dark text-fg-primary border border-border rounded hover:bg-bg-selection transition-colors",children:"Cancel"}),l.jsx("button",{onClick:h,className:"px-4 py-2 bg-accent-primary text-bg-dark font-semibold rounded hover:opacity-90 transition-opacity",children:"Proceed"})]})]})})}const sv={sm:"w-96",md:"w-[500px]",lg:"w-[640px]"};function Ep({isOpen:o,onClose:s,title:i,children:u,actions:f,size:h="md"}){return m.useEffect(()=>{const x=w=>{w.key==="Escape"&&o&&s()};if(o)return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[o,s]),o?l.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[l.jsxs("div",{className:`bg-bg-light border border-border rounded-sm shadow-2xl ${sv[h]}`,onClick:x=>x.stopPropagation(),children:[i&&l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[l.jsx("h2",{className:"font-display text-lg text-fg-primary",children:i}),l.jsx("button",{onClick:s,className:"p-1 hover:bg-bg-selection rounded transition-colors","aria-label":"Close",children:l.jsx(Jr,{size:18,className:"text-fg-secondary"})})]}),l.jsx("div",{className:"px-4 py-4 max-h-[calc(100vh-200px)] overflow-y-auto",children:u}),f&&l.jsx("div",{className:"px-4 py-3 border-t border-border flex items-center justify-end gap-2",children:f})]}),l.jsx("div",{className:"fixed inset-0 -z-10",onClick:s,"aria-hidden":"true"})]}):null}class Zr extends Error{}async function lv(o,s={}){const u=(await o.text()).replace(/^\uFEFF/,""),f=iv(u,s.maxRows?s.maxRows+1:void 0);if(f.length===0)throw new Zr("CSV file is empty");const[h,...x]=f;if(h.map(y=>y.trim()).filter(y=>y.length>0).length===0)throw new Zr("CSV header row is empty");const E=x.filter(y=>y.some(S=>S.trim().length>0)).map(y=>rv(y,h.length)).slice(0,s.maxRows??5);return{headers:h.map(y=>y.trim()),rows:E}}function iv(o,s){const i=[];let u="",f=[],h=!1;const x=()=>{f.push(u),u=""},w=()=>{i.push(f.map(E=>E.trim())),f=[]};for(let E=0;E<o.length;E+=1){const y=o[E];if(h){y==='"'?o[E+1]==='"'?(u+='"',E+=1):h=!1:u+=y;continue}if(y==='"'){h=!0;continue}if(y===","){x();continue}if(y===`
`){if(x(),w(),s&&i.length>=s)break;continue}y!=="\r"&&(u+=y)}if(h)throw new Zr("CSV contains an unterminated quoted value");return(u.length>0||f.length>0)&&(x(),w()),s&&i.length>s?i.slice(0,s):i}function rv(o,s){return o.length===s?o:o.length<s?[...o,...Array.from({length:s-o.length},()=>"")]:o.slice(0,s)}function ov({isOpen:o,selectedNodeId:s,nodes:i,templateSchema:u,ensureSession:f,onClose:h,onImported:x}){const[w,E]=m.useState(null),[y,S]=m.useState(null),[b,G]=m.useState(null),[L,ce]=m.useState(null),[ie,ve]=m.useState({}),[ge,Ee]=m.useState(null),[_e,W]=m.useState(null),[Te,fe]=m.useState([]),[oe,Ce]=m.useState(!1),[Re,Oe]=m.useState(!1),$=m.useRef(null),ye=m.useMemo(()=>Object.values(i).map(te=>({id:te.id,label:`${te.properties?.name??te.type} (${te.type})`,type:te.type})).sort((te,de)=>te.label.localeCompare(de.label)),[i]);m.useEffect(()=>{if(!o){E(null),S(null),G(null),ce(null),ve({}),Ee(null),W(null),fe([]),Ce(!1),Oe(!1),$.current&&($.current.value="");return}E(te=>te??s??null)},[o,s]);const ee=w?i[w]:null,Se=m.useMemo(()=>!ee||!u?[]:ee.allowed_children&&ee.allowed_children.length>0?ee.allowed_children:u.node_types.find(de=>de.id===ee.type)?.allowed_children??[],[ee,u]),B=m.useMemo(()=>u?Se.length===0?u.node_types.map(te=>({id:te.id,name:te.name||te.id})):Se.map(te=>{const de=u.node_types.find(Xe=>Xe.id===te);return de?{id:de.id,name:de.name||de.id}:null}).filter(te=>!!te):[],[Se,u]);m.useEffect(()=>{if(!B.length){S(null);return}S(te=>te&&B.some(Xe=>Xe.id===te)?te:B[0]?.id??null)},[B]);const v=m.useMemo(()=>{if(!u||!y)return[];const te=u.node_types.find(Je=>Je.id===y);if(!te)return[];const de=te.properties.map(Je=>({id:Je.id,name:Je.name,type:Je.type,required:!!Je.required,options:Je.options?.map(Ie=>({id:Ie.id,name:Ie.name}))}));return de.some(Je=>Je.id==="name")?de.forEach(Je=>{Je.id==="name"&&(Je.required=!0)}):de.unshift({id:"name",name:"Name",type:"string",required:!0}),de},[y,u]);m.useEffect(()=>{if(!v.length){ve({});return}ve(te=>{const de={};return v.forEach(Xe=>{de[Xe.id]=te?.[Xe.id]??null}),de})},[v]),m.useEffect(()=>{!L||!v.length||ve(te=>{if(Object.values(te).some(Ie=>Ie))return te;const Xe={},Je=new Set;return v.forEach(Ie=>{const vt=L.headers.find(wt=>wt.toLowerCase()===Ie.id.toLowerCase()),Ot=L.headers.find(wt=>wt.toLowerCase()===Ie.name.toLowerCase()),zt=vt??Ot??null;zt&&!Je.has(zt)?(Xe[Ie.id]=zt,Je.add(zt)):Xe[Ie.id]=null}),Xe})},[L,v]);const Z=m.useMemo(()=>v.filter(te=>te.required).map(te=>te.id),[v]).filter(te=>!ie[te]),j=m.useMemo(()=>Object.entries(ie).filter(([,te])=>!!te).map(([te,de])=>({property_id:te,header:de})),[ie]),se=!!w&&!!y&&!!b&&Z.length===0&&j.length>0&&!Re,g=async te=>{const de=te.target.files?.[0]??null;if($.current&&($.current.value=""),G(de),ce(null),Ee(null),W(null),fe([]),!!de)try{Ce(!0);const Xe=await lv(de,{maxRows:5});ce(Xe)}catch(Xe){Xe instanceof Zr?Ee(Xe.message):Ee("Failed to read CSV file"),ce(null)}finally{Ce(!1)}},T=(te,de)=>{ve(Xe=>({...Xe,[te]:de||null}))},A=()=>{Re||h()},X=async()=>{if(!(!se||!w||!y||!b)){W(null),fe([]),Oe(!0);try{const te=await f(),de=await Ae.importNodesFromCsv({sessionId:te,parentId:w,blueprintTypeId:y,columnMap:j,file:b});x({graph:de.graph,createdNodeIds:de.created_node_ids,parentId:w,blueprintTypeId:y,createdCount:de.created_count,undoAvailable:de.undo_available,redoAvailable:de.redo_available}),h()}catch(te){const de=te;W(de.message||"Import failed"),fe(de.rowErrors||[])}finally{Oe(!1)}}},me=te=>{switch(te.type){case"number":case"integer":return"0";case"boolean":return"true";case"select":return te.options?.[0]?.id??"";case"multi_select":return te.options?.slice(0,2).map(de=>de.id).join("|")??"";default:return te.id==="name"?"Example Name":""}},we=te=>te.includes('"')||te.includes(",")||te.includes(`
`)?`"${te.replace(/"/g,'""')}"`:te,qe=m.useCallback(async()=>{if(!y||v.length===0){alert("Select a node type before exporting a template CSV.");return}const te=v.map(wt=>wt.id),de=v.map(wt=>me(wt)),Xe=[te,de].map(wt=>wt.map(Mt=>we(Mt)).join(",")).join(`
`),Je=`talus-import-${y}.csv`;if(typeof window<"u"&&(!!window.__TAURI__||!!window.__TAURI_INTERNALS__)){let wt=!1;try{const[{save:Mt},{writeTextFile:Xt}]=await Promise.all([Rt(()=>import("./index-D1Z_VsQB.js"),[]),Rt(()=>import("./index-CcyFo--U.js"),[])]),Qt=await Mt({defaultPath:Je,filters:[{name:"CSV Files",extensions:["csv"]}]});Qt&&(await Xt(Qt,Xe),alert("Template CSV saved."),wt=!0)}catch(Mt){console.error("Failed to save CSV template via Tauri:",Mt),alert("Failed to save template CSV via desktop save dialog. Falling back to browser download.")}if(wt)return}const vt=new Blob([Xe],{type:"text/csv;charset=utf-8"}),Ot=URL.createObjectURL(vt),zt=document.createElement("a");zt.href=Ot,zt.download=Je,document.body.appendChild(zt),zt.click(),document.body.removeChild(zt),URL.revokeObjectURL(Ot)},[v,y]);return o?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-bg-light border border-border rounded-lg shadow-xl w-[720px] max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[l.jsx("h2",{className:"font-display text-lg font-bold text-fg-primary",children:"Import Nodes from CSV"}),l.jsx("button",{type:"button",onClick:A,className:"text-fg-secondary hover:text-fg-primary","aria-label":"Close import dialog",children:"X"})]}),l.jsxs("div",{className:"px-6 py-4 space-y-6",children:[!u&&l.jsx("div",{className:"p-3 border border-yellow-500/40 bg-yellow-500/10 text-yellow-200 rounded",children:"Load a template before importing nodes."}),l.jsxs("section",{className:"space-y-3",children:[l.jsx("div",{className:"text-sm text-fg-secondary uppercase tracking-wide",children:"Parent Selection"}),l.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[l.jsx("label",{className:"text-sm text-fg-primary",children:"Parent Node"}),l.jsxs("select",{className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",value:w??"",onChange:te=>E(te.target.value||null),children:[l.jsx("option",{value:"",children:"Select parent node..."}),ye.map(te=>l.jsx("option",{value:te.id,children:te.label},te.id))]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[l.jsx("label",{className:"text-sm text-fg-primary",children:"Node Type"}),l.jsxs("select",{className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",value:y??"",onChange:te=>S(te.target.value||null),disabled:!B.length,children:[l.jsx("option",{value:"",children:"Select node type..."}),B.map(te=>l.jsx("option",{value:te.id,children:te.name},te.id))]})]})]}),l.jsxs("section",{className:"space-y-3",children:[l.jsx("div",{className:"text-sm text-fg-secondary uppercase tracking-wide",children:"CSV File"}),l.jsx("input",{ref:$,type:"file",accept:".csv,text/csv",onChange:g,className:"w-full text-sm text-fg-primary"}),oe&&l.jsx("div",{className:"text-sm text-fg-secondary",children:"Reading CSV..."}),b&&L&&l.jsxs("div",{className:"text-sm text-fg-secondary",children:["Loaded ",b.name," (",L.headers.length," columns)"]}),ge&&l.jsx("div",{className:"text-sm text-red-400",children:ge})]}),L&&l.jsxs("section",{className:"space-y-2",children:[l.jsx("div",{className:"text-sm text-fg-secondary uppercase tracking-wide",children:"Preview"}),l.jsx("div",{className:"overflow-auto border border-border rounded",children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"bg-bg-dark/60",children:l.jsx("tr",{children:L.headers.map(te=>l.jsx("th",{className:"px-3 py-2 text-left font-medium text-fg-secondary border-b border-border",children:te||"(blank)"},te))})}),l.jsx("tbody",{children:L.rows.length===0?l.jsx("tr",{children:l.jsx("td",{className:"px-3 py-2 text-fg-secondary",colSpan:L.headers.length,children:"No data rows detected in CSV."})}):L.rows.map((te,de)=>l.jsx("tr",{className:"odd:bg-bg-dark/40",children:te.map((Xe,Je)=>l.jsx("td",{className:"px-3 py-2 border-b border-border text-fg-primary",children:Xe},`${de}-${Je}`))},`row-${de}`))})]})})]}),l.jsxs("section",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-sm text-fg-secondary uppercase tracking-wide",children:"Column Mapping"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",className:"px-3 py-1 text-xs bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection disabled:opacity-50 disabled:cursor-not-allowed",onClick:qe,disabled:!y||v.length===0,children:"Download template CSV"}),!L&&l.jsx("div",{className:"text-xs text-fg-secondary",children:"Load a CSV to configure mappings."})]})]}),l.jsx("div",{className:"space-y-3",children:v.map(te=>l.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3 sm:items-center",children:[l.jsxs("div",{className:"sm:col-span-1",children:[l.jsxs("div",{className:"text-sm text-fg-primary font-medium",children:[te.name,te.required&&l.jsx("span",{className:"text-xs text-red-400 ml-2",children:"Required"})]}),l.jsx("div",{className:"text-xs text-fg-secondary",children:te.type})]}),l.jsx("div",{className:"sm:col-span-2",children:l.jsxs("select",{className:"w-full px-3 py-2 bg-bg-dark border border-border rounded text-fg-primary",value:ie[te.id]??"",onChange:de=>T(te.id,de.target.value),disabled:!L,children:[l.jsx("option",{value:"",children:"Not mapped"}),L?.headers.map(de=>l.jsx("option",{value:de,children:de||"(blank)"},`${te.id}-${de}`))]})})]},te.id))}),Z.length>0&&l.jsxs("div",{className:"text-sm text-red-400",children:["Map required fields: ",Z.join(", "),"."]})]}),_e&&l.jsx("div",{className:"p-3 border border-red-500/40 bg-red-500/10 text-red-200 rounded",children:_e}),Te.length>0&&l.jsxs("section",{className:"space-y-2",children:[l.jsx("div",{className:"text-sm text-fg-secondary uppercase tracking-wide",children:"Row Errors"}),l.jsx("div",{className:"space-y-2 max-h-40 overflow-auto border border-border rounded px-3 py-2",children:Te.map(te=>l.jsxs("div",{className:"text-sm text-red-200",children:[l.jsxs("div",{className:"font-semibold",children:["Row ",te.row_number]}),l.jsx("ul",{className:"list-disc list-inside text-xs text-red-300",children:te.messages.map((de,Xe)=>l.jsx("li",{children:de},`${te.row_number}-${Xe}`))})]},te.row_number))})]})]}),l.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-end gap-2 bg-bg-light",children:[l.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-bg-dark border border-border rounded text-fg-primary hover:bg-bg-selection",disabled:Re,children:"Cancel"}),l.jsx("button",{type:"button",onClick:X,className:"px-4 py-2 bg-accent-primary rounded text-fg-primary hover:bg-accent-hover disabled:opacity-50 disabled:cursor-not-allowed",disabled:!se,children:Re?"Importing...":"Import Nodes"})]})]})}):null}const cv={default:"bg-bg-light text-fg-primary border border-border hover:bg-bg-selection hover:text-accent-hover hover:border-accent-primary active:bg-bg-dark disabled:text-fg-disabled disabled:border-border disabled:cursor-not-allowed",primary:"bg-accent-primary text-fg-primary border border-accent-primary hover:bg-accent-hover active:bg-accent-primary disabled:opacity-50 disabled:cursor-not-allowed",danger:"bg-status-danger text-fg-primary border border-status-danger hover:bg-red-700 active:bg-status-danger disabled:opacity-50 disabled:cursor-not-allowed"},uv={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"};function Ym({variant:o="default",size:s="md",className:i="",children:u,...f}){return l.jsx("button",{className:`
        rounded-sm font-body font-medium transition-all duration-200
        ${cv[o]}
        ${uv[s]}
        ${i}
      `,...f,children:u})}function dv({isOpen:o,onClose:s,sessionId:i}){const[u,f]=m.useState([]),[h,x]=m.useState(null),[w,E]=m.useState(!1),[y,S]=m.useState(!1),[b,G]=m.useState(null),[L,ce]=m.useState(null),[ie,ve]=m.useState(!1);m.useEffect(()=>{(async()=>{try{console.log("[ExportDialog] Checking for Tauri environment...");const{isTauri:Te}=await Rt(async()=>{const{isTauri:oe}=await Promise.resolve().then(()=>qa);return{isTauri:oe}},void 0),fe=Te();console.log("[ExportDialog] isTauri() returned:",fe),ve(fe),console.log(fe?"[ExportDialog]  Tauri environment detected":"[ExportDialog]  Not in Tauri environment")}catch(Te){console.log("[ExportDialog] Not in Tauri (dynamic import failed):",Te),ve(!1)}})()},[]),m.useEffect(()=>{o&&(ge(),G(null),ce(null))},[o]);const ge=async()=>{try{E(!0),G(null);const W=await Ae.listExportTemplates();f(W.templates),W.templates.length>0&&!h&&x(W.templates[0].id)}catch(W){const Te=W instanceof Error?W.message:String(W);G(`Failed to load templates: ${Te}`),console.error("Failed to load export templates:",W)}finally{E(!1)}},Ee=async()=>{if(!h||!i){G("Please select a template");return}try{S(!0),G(null),ce(null),console.log("[ExportDialog] Starting export..."),console.log("[ExportDialog] isTauri state:",ie);const W=await Ae.downloadExport(i,h),Te=u.find(Ce=>Ce.id===h),fe=new Date().toISOString().split("T")[0],oe=Te?`talus-export-${fe}.${Te.extension}`:`talus-export-${fe}.txt`;if(ie){console.log("[ExportDialog] TAKING TAURI PATH");try{console.log("[ExportDialog] Attempting to use Tauri file dialog...");const[{save:Ce},{writeFile:Re}]=await Promise.all([Rt(()=>import("./index-D1Z_VsQB.js"),[]),Rt(()=>import("./index-CcyFo--U.js"),[])]);console.log("[ExportDialog] Tauri APIs imported successfully"),console.log("[ExportDialog] save function type:",typeof Ce),console.log("[ExportDialog] writeFile function type:",typeof Re);const Oe={defaultPath:oe,...Te&&{filters:[{name:Te.name,extensions:[Te.extension]}]}};console.log("[ExportDialog] Opening save dialog with options:",JSON.stringify(Oe)),console.log("[ExportDialog] Calling save() function...");const $=await Ce(Oe);if(console.log("[ExportDialog] Save dialog returned:",$,"type:",typeof $),!$){console.log("[ExportDialog] User cancelled save dialog"),G("Save cancelled");return}const ye=await W.arrayBuffer(),ee=new Uint8Array(ye);console.log("[ExportDialog] Writing file to:",$),await Re($,ee),console.log("[ExportDialog] File written successfully"),ce(`Export saved to:
${$}`),setTimeout(()=>{s()},1e3)}catch(Ce){console.error("[ExportDialog] Tauri error caught:",Ce),console.error("[ExportDialog] Error type:",Ce instanceof Error?Ce.constructor.name:typeof Ce),Ce instanceof Error&&(console.error("[ExportDialog] Error message:",Ce.message),console.error("[ExportDialog] Error stack:",Ce.stack)),G(`Tauri error: ${Ce instanceof Error?Ce.message:String(Ce)}`)}}else console.log("[ExportDialog] TAKING BROWSER FALLBACK PATH"),console.log("[ExportDialog] Browser downloads will appear in your Downloads folder"),_e(W,oe)}catch(W){const Te=W instanceof Error?W.message:String(W);G(`Export failed: ${Te}`),console.error("Export failed:",W)}finally{S(!1)}},_e=(W,Te)=>{console.log("[ExportDialog handleBrowserDownload] Creating download for:",Te,"blob size:",W.size);const fe=window.URL.createObjectURL(W);console.log("[ExportDialog handleBrowserDownload] Created object URL:",fe);const oe=document.createElement("a");oe.href=fe,oe.download=Te,console.log("[ExportDialog handleBrowserDownload] Created link element, appending to document"),document.body.appendChild(oe),console.log("[ExportDialog handleBrowserDownload] Clicking link to trigger download"),oe.click(),console.log("[ExportDialog handleBrowserDownload] Removing link and revoking URL"),document.body.removeChild(oe),window.URL.revokeObjectURL(fe),console.log("[ExportDialog handleBrowserDownload] Download triggered. File should appear in Downloads folder"),ce("Export downloaded successfully to Downloads folder!"),setTimeout(()=>{s()},1e3)};return l.jsx(Ep,{isOpen:o,onClose:s,title:"Export Project Data",size:"md",actions:l.jsxs(l.Fragment,{children:[l.jsx(Ym,{variant:"default",onClick:s,disabled:y,children:"Cancel"}),l.jsxs(Ym,{variant:"primary",onClick:Ee,disabled:!h||y||w,children:[l.jsx(lb,{size:16,className:"inline mr-2"}),y?"Saving...":"Save"]})]}),children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-xs text-fg-secondary bg-bg-dark p-2 rounded",children:["Environment: ",ie?"Tauri Desktop App":"Web Browser",ie&&" - File save dialog should be available"]}),l.jsx("p",{className:"text-sm text-fg-secondary",children:"Export your project data in various formats. Select a template below to save your data."}),L&&l.jsxs("div",{className:"flex items-start gap-2 p-3 bg-status-success/10 border border-status-success rounded-sm",children:[l.jsx(Wm,{size:18,className:"text-status-success mt-0.5 flex-shrink-0"}),l.jsx("div",{className:"text-sm text-fg-primary whitespace-pre-wrap",children:L})]}),b&&l.jsxs("div",{className:"flex items-start gap-2 p-3 bg-status-danger/10 border border-status-danger rounded-sm",children:[l.jsx(fa,{size:18,className:"text-status-danger mt-0.5 flex-shrink-0"}),l.jsx("div",{className:"text-sm text-fg-primary",children:b})]}),w&&l.jsx("div",{className:"text-center py-8 text-fg-secondary",children:l.jsx("div",{className:"text-sm",children:"Loading templates..."})}),!w&&u.length===0&&l.jsxs("div",{className:"text-center py-8 text-fg-secondary",children:[l.jsx(Am,{size:48,className:"mx-auto mb-3 opacity-30"}),l.jsx("div",{className:"text-sm",children:"No export templates available"}),l.jsxs("div",{className:"text-xs mt-1",children:["Add .j2 templates to ",l.jsx("code",{className:"text-xs bg-bg-dark px-1 py-0.5 rounded",children:"data/templates/exports"})]})]}),!w&&u.length>0&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-fg-primary mb-2",children:"Select Export Format"}),l.jsxs("select",{value:h||"",onChange:W=>x(W.target.value),className:"w-full px-3 py-2 bg-bg-dark border border-border rounded-sm text-fg-primary text-sm focus:outline-none focus:border-accent-primary transition-colors",children:[l.jsx("option",{value:"",children:"Choose a template..."}),u.map(W=>l.jsxs("option",{value:W.id,children:[W.name," (.",W.extension,")"]},W.id))]})]}),h&&l.jsx("div",{className:"p-3 bg-bg-dark border border-accent-primary/30 rounded-sm",children:u.find(W=>W.id===h)&&l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Am,{size:16,className:"text-accent-primary"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-fg-primary text-sm",children:u.find(W=>W.id===h)?.name}),l.jsxs("div",{className:"text-xs text-fg-secondary mt-0.5",children:["Format: ",l.jsxs("code",{className:"text-xs bg-bg-light px-1 py-0.5 rounded",children:[".",u.find(W=>W.id===h)?.extension]})]})]})]})})})]}),!w&&u.length>0&&l.jsxs("div",{className:"text-xs text-fg-secondary bg-bg-dark p-3 rounded-sm",children:[l.jsx("strong",{children:"Note:"})," The export will include all nodes from your current project graph. Depending on the template, only relevant node types will be included in the output."]})]})})}const fv={top:"bottom-full mb-2",bottom:"top-full mt-2",left:"right-full mr-2",right:"left-full ml-2"};function hv({content:o,trigger:s,position:i="bottom"}){const[u,f]=m.useState(!1),h=m.useRef(null);return m.useEffect(()=>{const x=w=>{h.current&&!h.current.contains(w.target)&&f(!1)};if(u)return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[u]),l.jsxs("div",{className:"relative inline-block",ref:h,children:[l.jsx("button",{onClick:()=>f(!u),className:"focus:outline-none",children:s}),u&&l.jsx("div",{className:`
            absolute ${fv[i]}
            bg-bg-light border border-border rounded-sm
            shadow-lg z-50 min-w-max
          `,children:o})]})}const mv=["#D94E1F","#FF6B3B","#28a745","#ffc107","#dc3545","#60a5fa","#22d3ee","#a855f7","#e0e0e0","#b0b0b0","#1e1e1e","#121212"],Xm=o=>{const s=o.trim();if(!s)return"";const i=s.startsWith("#")?s:`#${s}`;return i.match(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/)?i.length===4?`#${i.slice(1).split("").map(h=>h+h).join("").toLowerCase()}`:i.toLowerCase():null};function Cu({value:o,onChange:s,swatches:i,placeholder:u="#RRGGBB",allowEmpty:f=!1}){const h=m.useMemo(()=>Xm(o||"")??"",[o]),[x,w]=m.useState(o||"");m.useEffect(()=>{w(o||"")},[o]);const E=i&&i.length>0?i:mv,y=b=>{const G=Xm(b);if(G===null){w(o||"");return}if(!G&&!f){w(o||"");return}w(G),s(G)},S=b=>({backgroundColor:b});return l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(hv,{content:l.jsx("div",{className:"p-3",children:l.jsx("div",{className:"grid grid-cols-6 gap-2",children:E.map(b=>l.jsx("button",{type:"button",onClick:()=>s(b),className:"h-6 w-6 rounded border border-border transition hover:scale-105",style:S(b),title:b},b))})}),trigger:l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("div",{className:"h-9 w-12 rounded border border-border bg-bg-light",style:{backgroundColor:h||"#1f2937"}})})}),l.jsx("input",{type:"text",value:x,onChange:b=>w(b.target.value),onBlur:b=>y(b.target.value),onKeyDown:b=>{b.key==="Enter"&&y(x)},placeholder:u,className:"flex-1 px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm font-mono focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})}const Cp=(o,s)=>{if(!o)return o;let i=o;return i=i.replace(/fill="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill="${f}"`:`fill="${s}"`}).replace(/fill='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill='${f}'`:`fill='${s}'`}).replace(/stroke="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke="${f}"`:`stroke="${s}"`}).replace(/stroke='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke='${f}'`:`stroke='${s}'`}),i=i.replace(/style="([^"]*)"/g,(u,f)=>`style="${String(f).replace(/fill:\s*[^;]+/gi,x=>{const w=x.split(":")[1]?.trim().toLowerCase();return w==="none"||w==="transparent"?x:`fill:${s}`}).replace(/stroke:\s*[^;]+/gi,x=>{const w=x.split(":")[1]?.trim().toLowerCase();return w==="none"||w==="transparent"?x:`stroke:${s}`})}"`),i};function pv({nodeTypes:o,onChange:s}){const[i,u]=m.useState(null),[f,h]=m.useState(null),[x,w]=m.useState({}),[E,y]=m.useState(!1),[S,b]=m.useState({}),[G,L]=m.useState([]),[ce,ie]=m.useState(null),[ve,ge]=m.useState({}),[Ee,_e]=m.useState({}),[W,Te]=m.useState([]),fe=m.useRef(!1),oe=o.map(j=>({...j,...S[j.id]||{}}));m.useEffect(()=>{(async()=>{try{const[se,g]=await Promise.all([Ae.getIconsConfig(),Ae.getIndicatorsConfig()]);L(se.icons),ie(g)}catch(se){console.error("Failed to load config catalogs:",se)}})()},[]),m.useEffect(()=>{(async()=>{try{const se=await Ae.listMarkupProfiles();Te(se.map(g=>({id:g.id,label:g.label||g.id})))}catch(se){console.error("Failed to load markup profiles:",se),Te([])}})()},[]);const Ce=async(j,se)=>{if(!ve[j]&&se)try{const g=await fetch(`${Dn}${se}`);if(g.ok){const T=await g.text();ge(A=>({...A,[j]:T}))}}catch(g){console.error(`Failed to load SVG for icon ${j}:`,g)}},Re=async(j,se)=>{if(!Ee[j]&&se)try{const g=await fetch(`${Dn}${se}`);if(g.ok){const T=await g.text();_e(A=>({...A,[j]:T}))}}catch(g){console.error(`Failed to load SVG for indicator ${j}:`,g)}};m.useEffect(()=>{G.length!==0&&o.forEach(j=>{if(j.icon){const se=G.find(g=>g.id===j.icon);se?.url&&!ve[j.icon]&&Ce(j.icon,se.url)}})},[G,o]),m.useEffect(()=>{if(!ce)return;const j=ce.indicator_sets.status?.indicators||[];o.forEach(se=>{se.properties.forEach(g=>{g.type==="select"&&g.options&&g.options.forEach(T=>{if(T.indicator_id){const A=j.find(X=>X.id===T.indicator_id);A?.url&&!Ee[T.indicator_id]&&Re(T.indicator_id,A.url)}})})})},[ce,o]);const Oe=j=>Array.from(new Set(j.filter(Boolean))),$=()=>{if(E){console.warn("Add operation already in progress");return}const j={id:`node_type_${Date.now()}`,label:"New Node Type",allowed_children:[],properties:[{id:"name",label:"Name",type:"text"}],icon:void 0,shape:void 0,color:void 0};y(!0),s([...o,j]).then(()=>{console.log(" Node type added successfully"),u(j.id)}).catch(se=>{console.error(` Failed to add node type: ${se instanceof Error?se.message:String(se)}`),w(g=>({...g,[j.id]:`Failed to add: ${se instanceof Error?se.message:"Unknown error"}`}))}).finally(()=>{y(!1)})},ye=j=>{if(fe.current||E){console.warn("Delete operation already in progress, ignoring duplicate call");return}if(o.length<=1){w(X=>({...X,[j]:"At least one node type is required"}));return}const se=o.find(X=>X.id===j);if(!se){console.error(`Node type ${j} not found`);return}const g=se.label||j;if(fe.current=!0,window.confirm(`Delete "${g}" node type?

 IMPORTANT: If any nodes of this type exist in active projects:

 They will become "orphaned nodes"
 Orphaned nodes are preserved with all their data
 You can still view and edit their properties
 You can delete them if no longer needed
 Children CANNOT be added to orphaned nodes
 They exist outside the template structure

This protects your data while allowing template evolution.

Continue with deletion?`)!==!0){console.log(`Deletion of ${g} cancelled by user`),fe.current=!1;return}console.log(`Deleting node type: ${g}`);const A=o.filter(X=>X.id!==j);y(!0),s(A).then(()=>{console.log(` Node type ${g} deleted successfully`);const X={...x};delete X[j],w(X)}).catch(X=>{console.error(` Failed to delete node type: ${X instanceof Error?X.message:String(X)}`),w(me=>({...me,[j]:`Failed to delete: ${X instanceof Error?X.message:"Unknown error"}`}))}).finally(()=>{y(!1),fe.current=!1})},ee=(j,se)=>{se.id&&i===j&&u(se.id);const g=oe.map(T=>T.id===j?{...T,...se}:T);b(T=>({...T,[j]:{...T[j],...se}})),s(g).then(()=>{b(A=>{const X={...A};return delete X[j],X});const T={...x};delete T[j],w(T)}).catch(T=>{console.error(` Failed to update node type: ${T instanceof Error?T.message:String(T)}`),b(A=>{const X={...A};return delete X[j],X}),w(A=>({...A,[j]:`Failed to update: ${T instanceof Error?T.message:"Unknown error"}`}))})},Se=j=>{const se={id:`prop_${Date.now()}`,label:"New Property",type:"text",indicator_set:"status"},g=oe.map(T=>T.id===j?{...T,properties:[...T.properties,se]}:T);b(T=>({...T,[j]:{...T[j],properties:g.find(A=>A.id===j)?.properties||[]}})),s(g).catch(T=>{console.error(` Failed to add property: ${T instanceof Error?T.message:String(T)}`),b(A=>{const X={...A};return delete X[j],X}),w(A=>({...A,[j]:`Failed to add property: ${T instanceof Error?T.message:"Unknown error"}`}))})},B=(j,se)=>{const A=o.find(we=>we.id===j)?.properties.find(we=>we.id===se)?.label||se;if(!window.confirm(`Delete "${A}" property?

 IMPORTANT: If any nodes have data in this property:

 The property values will become "orphaned"
 Orphaned property values are preserved
 They appear in an "Orphaned Properties" section
 You can view orphaned property values
 You can delete orphaned properties if no longer needed
 Orphaned properties cannot be edited (read-only)

This prevents data loss while allowing template evolution.

Continue with deletion?`))return;const me=oe.map(we=>we.id===j?{...we,properties:we.properties.filter(qe=>qe.id!==se)}:we);b(we=>({...we,[j]:{...we[j],properties:me.find(qe=>qe.id===j)?.properties||[]}})),s(me).catch(we=>{console.error(` Failed to remove property: ${we instanceof Error?we.message:String(we)}`),b(qe=>{const te={...qe};return delete te[j],te}),w(qe=>({...qe,[j]:`Failed to remove property: ${we instanceof Error?we.message:"Unknown error"}`}))})},v=(j,se,g)=>{g.id&&f===se&&h(g.id||null);const T=oe.map(A=>A.id===j?{...A,properties:A.properties.map(X=>X.id===se?{...X,...g}:X)}:A);b(A=>({...A,[j]:{...A[j],properties:T.find(X=>X.id===j)?.properties||[]}})),s(T).catch(A=>{console.error(` Failed to update property: ${A instanceof Error?A.message:String(A)}`),b(X=>{const me={...X};return delete me[j],me}),w(X=>({...X,[j]:`Failed to update property: ${A instanceof Error?A.message:"Unknown error"}`}))})},[M,Z]=m.useState(null);return m.useEffect(()=>{Ae.getMetaSchema().then(Z).catch(()=>Z(null))},[]),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(cu,{size:20,className:"text-blue-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm",children:[l.jsx("h3",{className:"font-semibold text-blue-300 mb-2",children:"About Removing Node Types"}),l.jsxs("p",{className:"text-blue-200/90 mb-2",children:["When you remove a node type, existing nodes of that type in active projects become ",l.jsx("strong",{children:'"orphaned nodes"'}),"."]}),l.jsxs("ul",{className:"text-blue-200/80 space-y-1 text-xs ml-4",children:[l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Data is preserved:"})," All properties and content remain intact"]}),l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Read/edit only:"})," You can view, edit properties, and delete orphaned nodes"]}),l.jsxs("li",{children:[" ",l.jsx("strong",{children:"No children allowed:"})," Cannot add new children to orphaned nodes"]}),l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Outside template:"}),' They exist in a "sandbox" separate from the template structure']})]}),l.jsx("p",{className:"text-blue-200/70 mt-2 text-xs italic",children:"This system protects your data while allowing templates to evolve."})]})]})}),l.jsxs("button",{onClick:$,className:"w-full px-4 py-2 flex items-center justify-center gap-2 bg-accent-primary text-fg-primary rounded hover:bg-accent-hover transition-colors font-semibold",children:[l.jsx(Bs,{size:18}),"Add Node Type"]}),l.jsx("div",{className:"space-y-2",children:oe.map((j,se)=>l.jsxs("div",{className:"bg-bg-light border border-border rounded overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-bg-dark/50 transition-colors cursor-pointer",onClick:()=>u(i===j.id?null:j.id),children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[l.jsx("button",{className:"p-0 -m-1 hover:bg-bg-dark rounded",children:i===j.id?l.jsx(Im,{size:20}):l.jsx(Kr,{size:20})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-fg-primary",children:j.label}),l.jsx("p",{className:"text-xs text-fg-secondary font-mono",children:j.id})]})]}),l.jsx("button",{onClick:g=>{g.stopPropagation(),ye(j.id)},className:"px-2 py-1 text-sm text-status-danger hover:bg-status-danger/20 rounded transition-colors",title:"Delete node type",children:l.jsx(Ls,{size:18})})]}),x[j.id]&&l.jsxs("div",{className:"px-4 py-2 bg-status-danger/10 text-status-danger text-sm flex items-center gap-2",children:[l.jsx(fa,{size:16}),x[j.id]]}),i===j.id&&l.jsxs("div",{className:"border-t border-border p-4 space-y-4 bg-bg-dark/50",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"ID"}),l.jsx("input",{type:"text",value:j.id,onChange:g=>ee(j.id,{id:g.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary font-mono text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Label"}),l.jsx("input",{type:"text",value:j.label,onChange:g=>ee(j.id,{label:g.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-fg-secondary mb-1",children:"Base Type"}),l.jsx("select",{value:j.base_type||"standard",onChange:g=>ee(j.id,{base_type:g.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded-md text-fg-primary",children:M?.node_classes?.map(g=>l.jsx("option",{value:g.id,children:g.name},g.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-2",children:"Icon (optional)"}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsxs("select",{value:j.icon||"",onChange:g=>{const T=g.target.value||void 0;if(ee(j.id,{icon:T}),T){const A=G.find(X=>X.id===T);A?.url&&Ce(T,A.url)}},className:"flex-1 px-3 py-2 bg-bg-light border border-border rounded text-fg-primary",children:[l.jsx("option",{value:"",children:"Select an icon..."}),G.map(g=>l.jsxs("option",{value:g.id,children:[g.id," - ",g.description]},g.id))]}),j.icon&&ve[j.icon]&&l.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-bg-light border border-border rounded p-2 flex items-center justify-center overflow-hidden",dangerouslySetInnerHTML:{__html:Cp(ve[j.icon],"#e0e0e0")}})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-2",children:"Visual Style"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-fg-muted mb-1",children:"Shape"}),l.jsxs("select",{value:j.shape||"",onChange:g=>{const T=g.target.value||void 0;ee(j.id,{shape:T})},className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[l.jsx("option",{value:"",children:"Default"}),l.jsx("option",{value:"rounded",children:"Rounded"}),l.jsx("option",{value:"roundedSquare",children:"Rounded Square"}),l.jsx("option",{value:"circle",children:"Circle"}),l.jsx("option",{value:"hexagon",children:"Hexagon"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-fg-muted mb-1",children:"Color"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Cu,{value:j.color||"",onChange:g=>ee(j.id,{color:g||void 0}),allowEmpty:!0,placeholder:"#60a5fa"}),l.jsx("button",{onClick:()=>ee(j.id,{color:void 0}),className:"px-2 py-1 text-xs text-fg-secondary hover:text-fg-primary hover:bg-bg-light rounded transition-colors",type:"button",children:"Clear"})]}),l.jsx("p",{className:"text-[11px] text-fg-muted mt-1",children:"Use hex colors like #60a5fa. Leave empty for default."})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-2",children:"Allowed Children"}),l.jsxs("div",{className:"space-y-2",children:[j.allowed_children.map((g,T)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:g,onChange:A=>{const X=[...j.allowed_children];X[T]=A.target.value,ee(j.id,{allowed_children:Oe(X)})},className:"flex-1 px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[!o.some(A=>A.id===g)&&l.jsxs("option",{value:g,children:["Missing: ",g]}),o.filter(A=>A.id!==j.id).map(A=>l.jsxs("option",{value:A.id,children:[A.label," (",A.id,")"]},A.id))]}),l.jsx("button",{onClick:()=>{const A=j.allowed_children.filter((X,me)=>me!==T);ee(j.id,{allowed_children:A})},className:"px-2 py-1 text-status-danger hover:bg-status-danger/20 rounded transition-colors",children:l.jsx(Ls,{size:16})})]},T)),l.jsx("button",{onClick:()=>{const g=o.filter(T=>T.id!==j.id&&!j.allowed_children.includes(T.id));g.length!==0&&ee(j.id,{allowed_children:[...j.allowed_children,g[0].id]})},disabled:o.filter(g=>g.id!==j.id&&!j.allowed_children.includes(g.id)).length===0,className:"text-sm px-3 py-1 bg-accent-primary/20 text-accent-primary rounded hover:bg-accent-primary/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add Child Type"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-fg-secondary mb-2 flex items-center gap-2",children:["Allowed Asset Types",l.jsx("span",{title:"Specify which asset node types can be added as children. E.g., 'uses_assets' accepts all assets, 'uses_asset_camera_gear' only accepts camera_gear_asset.",children:l.jsx(cu,{size:14,className:"text-fg-muted cursor-help"})}),l.jsx("span",{className:"text-xs text-fg-muted",children:"(optional - leave empty to allow all asset types)"})]}),l.jsxs("div",{className:"space-y-2",children:[(j.allowed_asset_types||[]).map((g,T)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:g,onChange:A=>{const X=[...j.allowed_asset_types||[]];X[T]=A.target.value,ee(j.id,{allowed_asset_types:X})},className:"flex-1 px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[!o.some(A=>A.id===g)&&l.jsxs("option",{value:g,children:["Missing: ",g]}),o.filter(A=>A.id.endsWith("_asset")).map(A=>l.jsxs("option",{value:A.id,children:[A.label," (",A.id,")"]},A.id))]}),l.jsx("button",{onClick:()=>{const A=(j.allowed_asset_types||[]).filter((X,me)=>me!==T);ee(j.id,{allowed_asset_types:A})},className:"px-2 py-1 text-status-danger hover:bg-status-danger/20 rounded transition-colors",children:l.jsx(Ls,{size:16})})]},T)),l.jsx("button",{onClick:()=>{const g=o.filter(T=>T.id.endsWith("_asset")&&!(j.allowed_asset_types||[]).includes(T.id));g.length!==0&&ee(j.id,{allowed_asset_types:[...j.allowed_asset_types||[],g[0].id]})},disabled:o.filter(g=>g.id.endsWith("_asset")&&!(j.allowed_asset_types||[]).includes(g.id)).length===0,className:"text-sm px-3 py-1 bg-accent-primary/20 text-accent-primary rounded hover:bg-accent-primary/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add Asset Type Filter"})]})]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[l.jsx("div",{className:"flex items-center justify-between mb-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h4",{className:"font-semibold text-fg-primary",children:"Velocity Configuration"}),l.jsx("span",{title:"Configure velocity scoring for prioritization. Leave blank to exclude this node type from velocity calculations.",children:l.jsx(cu,{size:14,className:"text-fg-muted cursor-help"})})]})}),l.jsxs("div",{className:"space-y-3 bg-bg-secondary/30 rounded p-3 mb-3",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-fg-secondary mb-1",children:["Base Score",l.jsx("span",{className:"text-xs ml-2 text-fg-muted",children:"(initial velocity value, optional)"})]}),l.jsx("input",{type:"number",min:"0",step:"1",value:j.velocityConfig?.baseScore??"",onChange:g=>{const T=g.target.value?parseInt(g.target.value,10):void 0;ee(j.id,{velocityConfig:{...j.velocityConfig,baseScore:T}})},placeholder:"e.g., 10",className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-fg-secondary mb-1",children:["Score Mode",l.jsx("span",{className:"text-xs ml-2 text-fg-muted",children:"(how scores are inherited from parents)"})]}),l.jsxs("select",{value:j.velocityConfig?.scoreMode??"",onChange:g=>{const T=g.target.value||void 0;ee(j.id,{velocityConfig:{...j.velocityConfig,scoreMode:T}})},className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[l.jsx("option",{value:"",children:"-- Not configured --"}),l.jsx("option",{value:"inherit",children:"Inherit (accumulate from parents)"}),l.jsx("option",{value:"standalone",children:"Standalone (independent score)"})]})]}),!j.velocityConfig?.baseScore&&!j.velocityConfig?.scoreMode&&l.jsx("p",{className:"text-xs text-fg-muted italic",children:" This node type will be excluded from velocity calculations until at least one velocity setting is configured."})]})]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h4",{className:"font-semibold text-fg-primary",children:"Properties"}),l.jsxs("button",{onClick:()=>Se(j.id),className:"text-sm px-3 py-1 bg-accent-primary/20 text-accent-primary rounded hover:bg-accent-primary/30 transition-colors flex items-center gap-1",children:[l.jsx(Bs,{size:14}),"Add Property"]})]}),j.properties.length===0?l.jsx("p",{className:"text-sm text-fg-secondary",children:"No properties defined"}):l.jsx("div",{className:"space-y-3",children:j.properties.map((g,T)=>l.jsx(yv,{property:g,onUpdate:A=>v(j.id,g.id,A),onRemove:()=>B(j.id,g.id),isExpanded:f===g.id,onToggleExpand:()=>h(f===g.id?null:g.id),indicatorsConfig:ce,indicatorSvgCache:Ee,fetchIndicatorSvg:Re,markupProfiles:W,metaSchema:M},`${se}-${T}`))})]})]})]},String(se)))})]})}const gv=m.memo(pv),yv=m.memo(function({property:s,onUpdate:i,onRemove:u,isExpanded:f,onToggleExpand:h,indicatorsConfig:x,indicatorSvgCache:w,fetchIndicatorSvg:E,markupProfiles:y,metaSchema:S}){return m.useEffect(()=>{s.type==="markup"&&i({type:"editor"})},[s.type,i]),l.jsxs("div",{className:"bg-bg-light/50 border border-border/50 rounded overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-bg-light/80 transition-colors cursor-pointer",onClick:h,children:[l.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[l.jsx("button",{className:"p-0",children:f?l.jsx(Im,{size:16}):l.jsx(Kr,{size:16})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h5",{className:"font-semibold text-fg-primary text-sm",children:s.label||s.id}),l.jsx("p",{className:"text-xs text-fg-secondary font-mono",children:s.type})]})]}),l.jsx("button",{onClick:b=>{b.stopPropagation(),u()},className:"px-2 py-1 text-status-danger hover:bg-status-danger/20 rounded transition-colors flex-shrink-0",children:l.jsx(Ls,{size:14})})]}),f&&l.jsxs("div",{className:"border-t border-border/50 p-3 space-y-3 bg-bg-dark/30",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"ID"}),s.indicator_set==="status"?l.jsx("input",{type:"text",value:"status",disabled:!0,className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm font-mono opacity-70 cursor-not-allowed"}):l.jsx("input",{type:"text",value:s.id,onChange:b=>i({id:b.target.value}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm font-mono"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Label"}),l.jsx("input",{type:"text",value:s.label,onChange:b=>i({label:b.target.value}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Type"}),l.jsx("select",{value:s.type==="markup"?"editor":s.type,onChange:b=>i({type:b.target.value}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm",children:S?.property_types?.map(b=>l.jsx("option",{value:b.id,children:b.description?`${b.id} - ${b.description}`:b.id},b.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Description (optional)"}),l.jsx("textarea",{value:s.description||"",onChange:b=>i({description:b.target.value||void 0}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm resize-none",rows:2,placeholder:"Help text for this property"})]}),(s.type==="editor"||s.type==="markup")&&l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Editor Template (optional)"}),y.length>0?l.jsxs("select",{value:s.markup_profile||"",onChange:b=>i({markup_profile:b.target.value||void 0}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[l.jsx("option",{value:"",children:"None"}),y.map(b=>l.jsx("option",{value:b.id,children:b.label},b.id))]}):l.jsx("input",{type:"text",value:s.markup_profile||"",onChange:b=>i({markup_profile:b.target.value||void 0}),className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm",placeholder:"e.g., script_default"})]}),l.jsxs("div",{className:"border-t border-border/50 pt-3 mt-3",children:[l.jsxs("label",{className:"text-xs text-fg-secondary mb-2 block flex items-center gap-1",children:[l.jsx("input",{type:"checkbox",checked:!!s.velocityConfig?.enabled,onChange:b=>{b.target.checked?i({velocityConfig:{enabled:!0,mode:"multiplier"}}):i({velocityConfig:void 0})},className:"rounded"}),"Enable velocity configuration for this property"]}),s.velocityConfig?.enabled&&l.jsxs("div",{className:"space-y-2 bg-bg-dark/30 rounded p-2 mt-2",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"text-xs text-fg-secondary mb-1 block",children:["Velocity Mode",l.jsx("span",{className:"text-fg-muted text-[10px] ml-1",children:"(how this property contributes to velocity)"})]}),l.jsxs("select",{value:s.velocityConfig?.mode||"multiplier",onChange:b=>{i({velocityConfig:{...s.velocityConfig,mode:b.target.value}})},className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-xs",children:[l.jsx("option",{value:"multiplier",children:"Multiplier (numeric property)"}),l.jsx("option",{value:"status",children:"Status (select property with scores)"})]})]}),s.velocityConfig?.mode==="multiplier"&&l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Multiplier Factor"}),l.jsx("input",{type:"number",min:"0",step:"0.5",value:s.velocityConfig?.multiplierFactor??1,onChange:b=>{i({velocityConfig:{...s.velocityConfig,multiplierFactor:parseFloat(b.target.value)||1}})},className:"w-full px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-xs",placeholder:"e.g., 5"}),l.jsx("p",{className:"text-[10px] text-fg-muted mt-1",children:"Property valor  multiplier = velocity contribution"})]}),s.velocityConfig?.mode==="status"&&l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Status Value Scores"}),l.jsx("p",{className:"text-[10px] text-fg-muted mb-2",children:"Define velocity points for each status option:"}),l.jsxs("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:[(s.options||[]).map(b=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-xs flex-1 text-fg-secondary",children:b.name}),l.jsx("input",{type:"number",value:s.velocityConfig?.statusScores?.[b.name]??0,onChange:G=>{const L={...s.velocityConfig?.statusScores||{},[b.name]:parseInt(G.target.value,10)||0};i({velocityConfig:{...s.velocityConfig,statusScores:L}})},className:"w-16 px-1 py-1 bg-bg-light border border-border rounded text-fg-primary text-xs",placeholder:"0"})]},b.name)),(!s.options||s.options.length===0)&&l.jsx("p",{className:"text-[10px] text-fg-muted italic",children:"Add options to this property first"})]})]})]})]}),s.type==="select"&&l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-2 block",children:"Options (with optional status indicator)"}),l.jsxs("div",{className:"space-y-3",children:[(s.options||[]).map((b,G)=>l.jsxs("div",{className:"border border-border/50 rounded p-2 space-y-2 bg-bg-dark/20",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"text",value:b.name,onChange:L=>{const ce=[...s.options||[]];ce[G]={...ce[G],name:L.target.value},i({options:ce})},className:"flex-1 px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm",placeholder:"Option name"}),l.jsx("button",{onClick:()=>{const L=(s.options||[]).filter((ce,ie)=>ie!==G);i({options:L.length>0?L:void 0})},className:"px-2 py-1 text-status-danger hover:bg-status-danger/20 rounded transition-colors",children:l.jsx(Ls,{size:14})})]}),x&&l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-fg-secondary mb-1 block",children:"Status Indicator Icon"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:b.indicator_id||"",onChange:L=>{const ce=[...s.options||[]],ie=L.target.value||void 0;if(ce[G]={...ce[G],indicator_id:ie},i({options:ce}),ie){const ve=x.indicator_sets.status?.indicators?.find(ge=>ge.id===ie);ve?.url&&E(ie,ve.url)}},className:"flex-1 px-2 py-1 bg-bg-light border border-border rounded text-fg-primary text-sm",children:[l.jsx("option",{value:"",children:"None - no indicator"}),x.indicator_sets.status?.indicators?.map(L=>l.jsxs("option",{value:L.id,children:[L.id," - ",L.description]},L.id))]}),b.indicator_id&&w[b.indicator_id]&&(()=>{const L=x.indicator_sets.status?.default_theme?.[b.indicator_id],ce=L?.indicator_color||"#e0e0e0",ie=L?.text_color||"#e0e0e0",ve=L?.text_style;return l.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 bg-bg-light border border-border rounded p-2",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center overflow-hidden",dangerouslySetInnerHTML:{__html:Cp(w[b.indicator_id],ce)}}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("div",{className:"text-xs font-mono px-1 rounded",style:{color:ie,fontWeight:ve==="bold"?"bold":"normal",textDecoration:ve==="strikethrough"?"line-through":"none"},children:"Sample"}),l.jsx("div",{className:"text-[10px] text-fg-secondary font-mono",children:ce})]})]})})()]})]})]},G)),l.jsx("button",{onClick:()=>{const b=[...s.options||[]];b.push({name:""}),i({options:b})},className:"text-xs px-2 py-1 bg-accent-primary/20 text-accent-primary rounded hover:bg-accent-primary/30 transition-colors",children:"+ Add Option"})]})]})]})]})}),bv=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`tt-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,10)}`;function xv({onClose:o}){const[s,i]=m.useState("list"),[u,f]=m.useState([]),[h,x]=m.useState(null),[w,E]=m.useState(null),[y,S]=m.useState(!1),[b,G]=m.useState(null),[L,ce]=m.useState([]),[ie,ve]=m.useState(!1),[ge,Ee]=m.useState(null),_e={base_width:160,base_height:100,max_depth:6,min_scale:.7,max_scale:1.3,direction:"down"};m.useEffect(()=>{W()},[]);const W=m.useCallback(async()=>{S(!0),G(null);try{const Z=await Ae.listTemplatesForEditor(),j=Array.from(new Map((Z.templates||[]).map(se=>[se.id,se])).values());f(j),j.length<(Z.templates||[]).length&&console.warn("[TemplateEditor] Duplicate template IDs detected and removed")}catch(Z){G(Z instanceof Error?Z.message:"Failed to load templates")}finally{S(!1)}},[]),Te=m.useCallback(async Z=>{S(!0),G(null),ce([]);try{const j=await Ae.getTemplateForEditor(Z);x(j),E(JSON.parse(JSON.stringify(j))),ve(!1),Ee(null),i("editor")}catch(j){G(j instanceof Error?j.message:"Failed to load template")}finally{S(!1)}},[]),fe=m.useCallback(()=>{console.log("[TemplateEditor] Creating new template...");const Z={id:"new_template",uuid:bv(),name:"New Template",version:"0.1.0",description:"A new template",blocking_view:{node_size:{..._e}},node_types:[{id:"root",label:"Root",allowed_children:[],properties:[{id:"name",label:"Name",type:"text"}]}]};x(Z),E(null),ce([]),G(null),ve(!1),Ee(null),i("editor"),console.log("[TemplateEditor] New template created, switching to editor view")},[]),oe=m.useCallback(()=>{console.log("[TemplateEditor] Cancelling and returning to list..."),x(null),E(null),ce([]),G(null),ve(!1),Ee(null),i("list"),console.log("[TemplateEditor] Cancel complete, view set to list")},[]),Ce=m.useCallback(async()=>{if(h){S(!0),G(null),ve(!1),Ee(null);try{const Z=await Ae.validateTemplate(h);if(!Z.is_valid){ce(Z.errors),G("Template has validation errors"),S(!1);return}ce([]);const j=!u.some(T=>T.id===h.id);let se;j?se=await Ae.createTemplate(h):se=await Ae.updateTemplate(h.id,h),se?.orphan_info&&se.orphan_info.total_orphaned_nodes>0&&Ee(se.orphan_info);const g=se?.template??{...h};x(g),E(JSON.parse(JSON.stringify(g))),ve(!0),setTimeout(()=>{ve(!1),Ee(null)},8e3),await W()}catch(Z){G(Z instanceof Error?Z.message:"Failed to save template")}finally{S(!1)}}},[h,u,W]),Re=m.useCallback(async()=>{if(h&&window.confirm(`Are you sure you want to delete template "${h.name}"?`)){S(!0),G(null);try{await Ae.deleteTemplate(h.id),i("list"),x(null),await W()}catch(Z){G(Z instanceof Error?Z.message:"Failed to delete template")}finally{S(!1)}}},[h,W]),Oe=m.useCallback(Z=>{ve(!1),x(j=>j&&{...j,...Z})},[]),$=m.useCallback(Z=>{ve(!1),x(j=>{if(!j)return j;const se={...j.blocking_view?.node_size||{},...Z};return{...j,blocking_view:{...j.blocking_view||{},node_size:se}}})},[]),ye=m.useCallback(async Z=>{if(Oe({node_types:Z}),h){S(!0),G(null);try{const j={...h,node_types:Z},se=await Ae.updateTemplate(j.id,j);x(se?.template??j),E(JSON.parse(JSON.stringify(se?.template??j))),ve(!0),setTimeout(()=>ve(!1),3e3)}catch(j){G(j instanceof Error?j.message:"Failed to update template")}finally{S(!1)}}if(h){S(!0),G(null);try{const j={...h,node_types:Z},se=await Ae.updateTemplate(j.id,j);x(se?.template??j),E(JSON.parse(JSON.stringify(se?.template??j))),ve(!0),setTimeout(()=>ve(!1),3e3)}catch(j){G(j instanceof Error?j.message:"Failed to update template")}finally{S(!1)}}},[Oe]);if(s==="list")return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[l.jsx(El,{}),l.jsxs("div",{className:"flex flex-col h-full overflow-hidden flex-1 bg-bg-light",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"p-1 hover:bg-bg-dark rounded transition-colors",title:"Close",children:l.jsx(_l,{size:24,className:"text-fg-primary"})}),l.jsx("h1",{className:"text-2xl font-display font-bold text-fg-primary",children:"Template Editor"})]}),l.jsxs("button",{onClick:fe,className:"flex items-center gap-2 px-3 py-2 bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity font-semibold",children:[l.jsx(Bs,{size:18}),"New Template"]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[b&&l.jsxs("div",{className:"mb-4 p-4 bg-status-danger/10 border border-status-danger rounded flex items-start gap-3",children:[l.jsx(fa,{size:20,className:"text-status-danger flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-status-danger",children:"Error"}),l.jsx("p",{className:"text-sm text-status-danger/80",children:b})]})]}),y?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-fg-secondary",children:"Loading templates..."})}):u.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[l.jsx("p",{className:"text-lg text-fg-secondary mb-4",children:"No templates found"}),l.jsx("button",{onClick:fe,className:"px-4 py-2 bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity font-semibold",children:"Create the first template"})]}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(Z=>l.jsxs("div",{className:"p-0 border border-border rounded bg-bg-dark hover:border-accent-primary cursor-pointer transition-colors group flex flex-col h-full",onClick:()=>Te(Z.id),children:[l.jsxs("div",{className:"flex-1 p-4 flex flex-col",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-1 font-mono",children:Z.id}),l.jsx("p",{className:"text-sm text-fg-secondary",children:Z.name}),Z.description&&l.jsx("p",{className:"text-xs text-fg-secondary mt-1",children:Z.description})]}),l.jsxs("div",{className:"flex items-center justify-between px-4 pb-4 pt-2",children:[l.jsxs("span",{className:"px-2 py-1 bg-accent-primary/10 text-accent-primary text-xs rounded font-mono inline-block",children:["v",Z.version]}),l.jsx("button",{onClick:j=>{j.stopPropagation(),Te(Z.id)},className:"px-2 py-1 text-xs font-semibold border border-border rounded hover:border-accent-primary transition-colors",children:"Edit"})]})]},Z.id))})]})]})]});if(!h)return null;const ee=ge?.total_orphaned_nodes??0,Se=ge?.total_orphaned_properties??0,B=ge?.orphaned_sessions?.length??0,v=h.blocking_view?.node_size||_e,M=!!h.blocking_view?.node_size;return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[l.jsx(El,{}),l.jsxs("div",{className:"flex flex-col h-full overflow-hidden flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:oe,className:"p-1 hover:bg-bg-dark rounded transition-colors",title:"Cancel and go back",disabled:y,children:l.jsx(_l,{size:24,className:"text-fg-primary"})}),l.jsx("h1",{className:"text-2xl font-display font-bold text-fg-primary",children:h.name})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[ie&&!ge&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-status-success/10 text-status-success rounded",children:[l.jsx(Wm,{size:18}),l.jsx("span",{className:"text-sm font-semibold",children:"Saved successfully"})]}),ge&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-orange-500/10 text-orange-400 rounded border border-orange-500/30",children:[l.jsx(fa,{size:18}),l.jsxs("div",{className:"text-sm",children:[l.jsxs("span",{className:"font-semibold",children:["Saved with ",ee," orphaned node",ee!==1?"s":"",Se>0&&l.jsxs("span",{children:[" and ",Se," orphaned propert",Se!==1?"ies":"y"]})]}),l.jsxs("span",{className:"text-xs block text-orange-300/80",children:[B," active session",B!==1?"s":""," affected"]})]})]}),b&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-status-danger/10 text-status-danger rounded",children:[l.jsx(fa,{size:18}),l.jsx("span",{className:"text-sm font-semibold",children:b})]}),l.jsx("button",{onClick:oe,disabled:y,className:"px-4 py-2 bg-bg-dark border border-border text-fg-primary rounded hover:bg-bg-light transition-colors disabled:opacity-50 font-semibold",children:"Cancel"}),l.jsxs("button",{onClick:Ce,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-accent-primary text-fg-primary rounded hover:bg-accent-hover disabled:opacity-50 transition-colors font-semibold",children:[l.jsx(Pm,{size:20}),"Save"]}),l.jsxs("button",{onClick:Re,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-status-danger/20 text-status-danger rounded hover:bg-status-danger/30 disabled:opacity-50 transition-colors font-semibold",children:[l.jsx(Ls,{size:20}),"Delete"]})]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[L.length>0&&l.jsxs("div",{className:"mb-6 p-4 bg-status-danger/10 border border-status-danger rounded",children:[l.jsx("h3",{className:"font-semibold text-status-danger mb-2",children:"Validation Errors:"}),l.jsx("ul",{className:"text-sm text-status-danger/90 space-y-1",children:L.map((Z,j)=>l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:Z})]},j))})]}),ge&&(ee>0||Se>0)&&l.jsxs("div",{className:"mb-6 p-4 bg-orange-500/10 border border-orange-500/30 rounded",children:[l.jsxs("h3",{className:"font-semibold text-orange-400 mb-2 flex items-center gap-2",children:[l.jsx(fa,{size:18}),"Orphaned Data Created"]}),l.jsxs("p",{className:"text-sm text-orange-300/90 mb-3",children:[ee>0&&l.jsxs("span",{children:[ee," node",ee!==1?"s":""," in"," ",B," active session",B!==1?"s":""," ","became orphaned because their node type was removed.",Se>0&&" "]}),Se>0&&l.jsxs("span",{children:[ee>0&&"Additionally, ",Se," propert",Se!==1?"ies":"y"," became orphaned because they were removed from node types."]})]}),l.jsxs("div",{className:"text-xs text-orange-200/80 space-y-1",children:[l.jsx("p",{children:l.jsx("strong",{children:"What this means:"})}),l.jsxs("ul",{className:"ml-4 space-y-1",children:[ee>0&&l.jsxs(l.Fragment,{children:[l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Orphaned nodes:"})," Preserve all data and properties"]}),l.jsx("li",{children:" You can still view, edit, and delete orphaned nodes"}),l.jsx("li",{children:" Children cannot be added to orphaned nodes"}),l.jsx("li",{children:" They exist outside the template structure"})]}),Se>0&&l.jsxs(l.Fragment,{children:[l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Orphaned properties:"})," Preserve existing values"]}),l.jsx("li",{children:' Appear in "Orphaned Properties" section in Inspector'}),l.jsx("li",{children:" Read-only (cannot be edited)"}),l.jsx("li",{children:" Can be deleted if no longer needed"})]})]})]})]}),l.jsxs("div",{className:"bg-bg-dark border border-border rounded p-6 mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-4",children:"Template Information"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"ID"}),l.jsx("input",{type:"text",value:h.id,onChange:Z=>Oe({id:Z.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary font-mono"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Version"}),l.jsx("input",{type:"text",value:h.version,onChange:Z=>Oe({version:Z.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary",placeholder:"0.1.0"})]}),l.jsxs("div",{className:"col-span-2",children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Name"}),l.jsx("input",{type:"text",value:h.name,onChange:Z=>Oe({name:Z.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{className:"col-span-2",children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Description"}),l.jsx("textarea",{value:h.description,onChange:Z=>Oe({description:Z.target.value}),className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary resize-none",rows:3})]})]})]}),l.jsxs("div",{className:"bg-bg-dark border border-border rounded p-6 mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-4",children:"Blocking View"}),l.jsxs("label",{className:"flex items-center gap-2 text-sm text-fg-secondary mb-4",children:[l.jsx("input",{type:"checkbox",checked:M,onChange:Z=>{Z.target.checked?Oe({blocking_view:{node_size:{..._e}}}):Oe({blocking_view:void 0})},className:"rounded"}),"Enable size scaling by hierarchy depth"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Base Width"}),l.jsx("input",{type:"number",min:40,step:1,value:v.base_width??"",onChange:Z=>{const j=Z.target.value===""?void 0:Number(Z.target.value);$({base_width:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Base Height"}),l.jsx("input",{type:"number",min:30,step:1,value:v.base_height??"",onChange:Z=>{const j=Z.target.value===""?void 0:Number(Z.target.value);$({base_height:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Min Scale"}),l.jsx("input",{type:"number",min:.1,step:.05,value:v.min_scale??"",onChange:Z=>{const j=Z.target.value===""?void 0:Number(Z.target.value);$({min_scale:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Max Scale"}),l.jsx("input",{type:"number",min:.1,step:.05,value:v.max_scale??"",onChange:Z=>{const j=Z.target.value===""?void 0:Number(Z.target.value);$({max_scale:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Max Depth"}),l.jsx("input",{type:"number",min:1,step:1,value:v.max_depth??"",onChange:Z=>{const j=Z.target.value===""?void 0:Number(Z.target.value);$({max_depth:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-fg-secondary mb-1",children:"Direction"}),l.jsxs("select",{value:v.direction||"down",onChange:Z=>{const j=Z.target.value==="up"?"up":"down";$({direction:j})},disabled:!M,className:"w-full px-3 py-2 bg-bg-light border border-border rounded text-fg-primary",children:[l.jsx("option",{value:"down",children:"Deeper = smaller"}),l.jsx("option",{value:"up",children:"Deeper = larger"})]})]})]}),l.jsx("p",{className:"text-xs text-fg-secondary mt-3",children:"Sizes scale by depth from root in the blocking editor. Max Depth caps the effect."})]}),l.jsxs("div",{className:"bg-bg-dark border border-border rounded p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-4",children:"Node Types"}),l.jsx(gv,{nodeTypes:h.node_types,onChange:ye})]}),l.jsx("div",{className:"mt-6 text-sm text-fg-secondary text-center pb-6",children:l.jsx("p",{children:"Support for indicator management and markup profiles coming soon..."})})]})]})]})}function vv({onClose:o}){const[s,i]=m.useState({}),[u,f]=m.useState(!0),[h,x]=m.useState(null),[w,E]=m.useState(!1),[y,S]=m.useState("create"),[b,G]=m.useState(null),[L,ce]=m.useState(null),[ie,ve]=m.useState({id:"",file:"",description:""}),[ge,Ee]=m.useState(null),[_e,W]=m.useState(null),[Te,fe]=m.useState(!1),[oe,Ce]=m.useState(null),[Re,Oe]=m.useState("#000000"),[$,ye]=m.useState("#000000"),[ee,Se]=m.useState(!1),[B,v]=m.useState(!1);m.useEffect(()=>{M()},[]);const M=async()=>{try{f(!0),x(null);const A=await Ae.getIndicatorsConfig();i(A.indicator_sets||{}),console.log("Loaded indicator sets:",A.indicator_sets)}catch(A){const X=A instanceof Error?A.message:String(A);x(`Failed to load indicators: ${X}`),console.error("Failed to load indicators:",A)}finally{f(!1)}},Z=A=>{S("create"),G(A),ce(null),ve({id:"",file:"",description:""}),Ee(null),Ce(null),Oe("#000000"),ye("#000000"),Se(!1),v(!1),W(null),E(!0)},j=(A,X)=>{if(S("edit"),G(A),ce(X.id),ve({id:X.id,file:X.file,description:X.description||""}),Ee(null),X.file){const we=`${Dn}/api/v1/assets/indicators/${A}/${X.id}`;Ce(we)}else Ce(null);const me=s[A];if(me?.default_theme?.[X.id]){const we=me.default_theme[X.id];Oe(we.indicator_color||"#000000"),ye(we.text_color||"#000000"),Se(we.text_style?.includes("bold")||!1),v(we.text_style?.includes("strikethrough")||!1)}else Oe("#000000"),ye("#000000"),Se(!1),v(!1);W(null),E(!0)},se=()=>{E(!1),Ee(null),Ce(null),W(null),fe(!1)},g=async(A,X)=>{if(window.confirm(`Delete indicator "${X}" from set "${A}"?`))try{x(null),await Ae.deleteIndicator(A,X),await M()}catch(we){const qe=we instanceof Error?we.message:String(we);x(`Failed to delete indicator: ${qe}`)}},T=async A=>{if(A.preventDefault(),!b){W("No indicator set selected.");return}if(!ie.id||!ie.file||!ie.description){W("ID, file, and description are required.");return}try{fe(!0),W(null);let X=ie.file;if(y==="create"){if(await Ae.createIndicator(b,{id:ie.id,file:X,description:ie.description}),ge){const qe=await Ae.uploadIndicatorFile(b,ie.id,ge);await Ae.updateIndicator(b,ie.id,{id:ie.id,file:qe.file,description:ie.description})}}else if(L){if(ge){const qe=ie.id||L;X=(await Ae.uploadIndicatorFile(b,qe,ge)).file}await Ae.updateIndicator(b,L,{id:ie.id,file:X,description:ie.description})}const me=[];ee&&me.push("bold"),B&&me.push("strikethrough");const we=ie.id;await Ae.setIndicatorTheme(b,we,{indicator_color:Re,text_color:$,text_style:me.length>0?me.join(","):void 0}),await M(),se()}catch(X){const me=X instanceof Error?X.message:String(X);W(`Failed to ${y} indicator: ${me}`)}finally{fe(!1)}};return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[l.jsx(El,{}),l.jsxs("div",{className:"flex flex-col h-full overflow-hidden flex-1 bg-bg-light",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"p-1 hover:bg-bg-dark rounded transition-colors",title:"Go back",children:l.jsx(_l,{size:24,className:"text-fg-primary"})}),l.jsx("h1",{className:"text-2xl font-display font-bold text-fg-primary",children:"Indicator Editor"})]}),Object.keys(s).length>0&&l.jsxs("button",{onClick:()=>Z(Object.keys(s)[0]),className:"flex items-center gap-2 px-3 py-2 bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity font-semibold",children:[l.jsx(Bs,{size:18}),"New Indicator"]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[h&&l.jsxs("div",{className:"mb-4 p-4 bg-status-danger/10 border border-status-danger rounded flex items-start gap-3",children:[l.jsx(fa,{size:20,className:"text-status-danger flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-status-danger",children:"Error"}),l.jsx("p",{className:"text-sm text-status-danger/80",children:h})]})]}),u?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-fg-secondary",children:"Loading indicators..."})}):Object.keys(s).length===0?l.jsx("div",{className:"flex items-center justify-center h-64 text-center",children:l.jsx("p",{className:"text-lg text-fg-secondary",children:"No indicator sets found"})}):l.jsx("div",{className:"space-y-6",children:Object.entries(s).map(([A,X])=>l.jsxs("div",{className:"border border-border rounded",children:[l.jsx("div",{className:"px-6 py-4 border-b border-border bg-bg-dark",children:l.jsx("div",{className:"flex items-start gap-4",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-1 font-mono",children:A}),X.description&&l.jsx("p",{className:"text-sm text-fg-secondary",children:X.description})]})})}),X.indicators&&X.indicators.length>0?l.jsx("div",{className:"p-6 bg-bg-light",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:X.indicators.map(me=>l.jsxs("div",{className:"p-4 bg-bg-dark border border-border rounded hover:border-accent-primary transition-colors",children:[l.jsx("h3",{className:"font-mono text-sm font-semibold text-fg-primary mb-2",children:me.id}),me.description&&l.jsx("p",{className:"text-xs text-fg-secondary mb-3",children:me.description}),me.file&&l.jsxs("p",{className:"text-xs text-fg-secondary mb-2",children:[l.jsx("span",{className:"font-semibold",children:"File:"})," ",me.file]}),l.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[l.jsx("button",{onClick:()=>j(A,me),className:"px-2 py-1 text-xs font-semibold border border-border rounded hover:border-accent-primary transition-colors",children:"Edit"}),l.jsx("button",{onClick:()=>g(A,me.id),className:"px-2 py-1 text-xs font-semibold border border-status-danger text-status-danger rounded hover:bg-status-danger/10 transition-colors",children:"Delete"})]})]},me.id))})}):l.jsx("div",{className:"p-6 bg-bg-light text-center text-sm text-fg-secondary",children:"No indicators in this set."})]},A))})]})]}),w&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",onClick:A=>{A.target===A.currentTarget&&se()},children:l.jsxs("div",{className:"w-full max-w-2xl rounded border border-border bg-bg-dark max-h-96 overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary",children:y==="create"?"Create Indicator":"Edit Indicator"}),l.jsx("button",{onClick:se,className:"text-sm text-fg-secondary hover:text-fg-primary",children:"Close"})]}),l.jsxs("form",{onSubmit:T,className:"space-y-4 p-4",children:[_e&&l.jsx("div",{className:"rounded border border-status-danger bg-status-danger/10 px-3 py-2 text-sm text-status-danger",children:_e}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"ID"}),l.jsx("input",{type:"text",value:ie.id,onChange:A=>ve({...ie,id:A.target.value}),className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"SVG File"}),y==="edit"&&ie.file&&l.jsxs("span",{className:"text-xs text-fg-secondary",children:["Current: ",ie.file]})]}),l.jsx("input",{type:"file",accept:".svg",onChange:A=>{const X=A.target.files?.[0]||null;if(Ee(X),ve({...ie,file:X?X.name:ie.file}),X){const me=URL.createObjectURL(X);Ce(me)}else Ce(null)},className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"}),l.jsx("div",{className:"text-xs text-fg-secondary",children:ge?`New file selected: ${ge.name}`:y==="edit"?"Leave empty to keep current file, or select a new one.":"Choose an SVG file to copy into the indicators folder."})]}),oe&&l.jsxs("div",{className:"space-y-2 rounded border border-border bg-bg-dark p-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-fg-secondary",children:"Preview"}),l.jsxs("div",{className:"flex items-center gap-4 rounded bg-bg-light p-4",children:[l.jsx("div",{style:{backgroundColor:Re,maskImage:`url(${oe})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${oe})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"},className:"h-12 w-12 flex-shrink-0"}),l.jsx("div",{style:{color:$,fontWeight:ee?"bold":"normal",textDecoration:B?"line-through":"none"},className:"text-sm",children:"Example: Status Active"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-semibold text-fg-secondary",children:"Indicator Color"}),l.jsx(Cu,{value:Re,onChange:Oe})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-semibold text-fg-secondary",children:"Text Color"}),l.jsx(Cu,{value:$,onChange:ye})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:ee,onChange:A=>Se(A.target.checked),className:"w-4 h-4 rounded border border-border cursor-pointer"}),l.jsx("span",{className:"text-xs font-semibold text-fg-secondary",children:"Bold"})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:B,onChange:A=>v(A.target.checked),className:"w-4 h-4 rounded border border-border cursor-pointer"}),l.jsx("span",{className:"text-xs font-semibold text-fg-secondary",children:"Strikethrough"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"Description"}),l.jsx("textarea",{value:ie.description,onChange:A=>ve({...ie,description:A.target.value}),rows:3,className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),l.jsxs("div",{className:"flex items-center justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:se,className:"px-3 py-2 text-sm font-semibold text-fg-secondary hover:text-fg-primary",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:Te,className:"px-4 py-2 text-sm font-semibold bg-accent-primary text-bg-dark rounded hover:opacity-90 disabled:opacity-60",children:Te?"Saving...":y==="create"?"Create":"Save"})]})]})]})})]})}const Qm={id:"",label:"",description:"",tokens:[]},wv=["none","uppercase","lowercase","capitalize"],Sv=["line","prefix","inline"],jv=["left","center","right"];function Nv({onClose:o}){const[s,i]=m.useState([]),[u,f]=m.useState(!0),[h,x]=m.useState(null),[w,E]=m.useState(!1),[y,S]=m.useState("create"),[b,G]=m.useState(Qm),[L,ce]=m.useState(null),[ie,ve]=m.useState(!1);m.useEffect(()=>{ge()},[]);const ge=async()=>{try{f(!0),x(null);const B=await Ae.listMarkupProfiles(),v=await Promise.all(B.map(async M=>{try{return await Ae.getMarkupProfile(M.id)}catch{return{id:M.id,label:M.label,description:M.description,tokens:[]}}}));i(v)}catch(B){const v=B instanceof Error?B.message:String(B);x(`Failed to load markup profiles: ${v}`)}finally{f(!1)}},Ee=()=>{S("create"),G({...Qm}),ce(null),E(!0)},_e=B=>{S("edit"),G({...B,description:B.description||"",tokens:B.tokens?[...B.tokens]:[]}),ce(null),E(!0)},W=()=>{E(!1),ce(null),ve(!1)},Te=async B=>{if(window.confirm(`Delete markup profile "${B}"?`))try{x(null),await Ae.deleteMarkupProfile(B),await ge()}catch(M){const Z=M instanceof Error?M.message:String(M);x(`Failed to delete markup profile: ${Z}`)}},fe=B=>{const v={id:B.id.trim(),label:B.label.trim()};if(B.format_scope&&(v.format_scope=B.format_scope),B.prefix?.trim()&&(v.prefix=B.prefix.trim()),B.pattern?.trim()&&(v.pattern=B.pattern.trim()),B.format){const M={...B.format},Z={};["text_transform","align","font_size","color","background_color"].forEach(j=>{const se=M[j];typeof se=="string"&&se.trim()&&(Z[j]=se.trim())}),["bold","italic","underline"].forEach(j=>{M[j]&&(Z[j]=!0)}),Object.keys(Z).length>0&&(v.format=Z)}return v},oe=B=>{const v={id:B.id.trim(),label:B.label.trim()};return B.description?.trim()&&(v.description=B.description.trim()),B.tokens&&B.tokens.length>0&&(v.tokens=B.tokens.map(fe)),v},Ce=B=>{if(!B.id.trim())return"Profile ID is required.";if(!B.label.trim())return"Profile label is required.";for(const v of B.tokens||[]){if(!v.id.trim())return"Token ID is required.";if(!v.label.trim())return"Token label is required."}return null},Re=async B=>{B.preventDefault();const v=Ce(b);if(v){ce(v);return}try{ve(!0),ce(null);const M=oe(b);y==="create"?await Ae.createMarkupProfile(M):await Ae.updateMarkupProfile(M.id,M),await ge(),W()}catch(M){const Z=M instanceof Error?M.message:String(M);ce(`Failed to ${y==="create"?"create":"update"} profile: ${Z}`)}finally{ve(!1)}},Oe=(B,v)=>{G(M=>{const Z=[...M.tokens||[]];return Z[B]={...Z[B],...v},{...M,tokens:Z}})},$=(B,v,M)=>{G(Z=>{const j=[...Z.tokens||[]],se={...j[B]},g={...se.format||{}};return typeof M=="boolean"?(v==="bold"||v==="italic"||v==="underline")&&(M?g[v]=!0:delete g[v]):M?g[v]=M:delete g[v],se.format=Object.keys(g).length>0?g:void 0,j[B]=se,{...Z,tokens:j}})},ye=()=>{G(B=>({...B,tokens:[...B.tokens||[],{id:"",label:"",format_scope:"line"}]}))},ee=B=>{G(v=>{const M=[...v.tokens||[]];return M.splice(B,1),{...v,tokens:M}})},Se=m.useMemo(()=>b.tokens||[],[b.tokens]);return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[l.jsx(El,{}),l.jsxs("div",{className:"flex flex-col h-full overflow-hidden flex-1 bg-bg-light",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"p-1 hover:bg-bg-dark rounded transition-colors",title:"Go back",children:l.jsx(_l,{size:24,className:"text-fg-primary"})}),l.jsx("h1",{className:"text-2xl font-display font-bold text-fg-primary",children:"Markup Editor"})]}),l.jsxs("button",{onClick:Ee,className:"flex items-center gap-2 px-3 py-2 bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity font-semibold",children:[l.jsx(Bs,{size:16}),"New Profile"]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[h&&l.jsxs("div",{className:"mb-4 p-4 bg-status-danger/10 border border-status-danger rounded flex items-start gap-3",children:[l.jsx(fa,{size:20,className:"text-status-danger flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-status-danger",children:"Error"}),l.jsx("p",{className:"text-sm text-status-danger/80",children:h})]})]}),u?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-fg-secondary",children:"Loading markup profiles..."})}):s.length===0?l.jsx("div",{className:"flex items-center justify-center h-64 text-center",children:l.jsx("p",{className:"text-lg text-fg-secondary",children:"No markup profiles found"})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(B=>l.jsxs("div",{className:"border border-border rounded bg-bg-dark hover:border-accent-primary cursor-pointer transition-colors group flex flex-col h-full",children:[l.jsxs("div",{className:"flex-1 p-4 flex flex-col",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary mb-1 font-mono",children:B.id}),l.jsx("p",{className:"text-sm text-fg-secondary",children:B.label}),B.description&&l.jsx("p",{className:"text-xs text-fg-secondary mt-1",children:B.description}),l.jsxs("div",{className:"text-xs text-fg-secondary mt-2",children:["Tokens: ",B.tokens?.length||0]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 px-4 pb-4 pt-2",children:[l.jsx("button",{onClick:v=>{v.stopPropagation(),_e(B)},className:"px-2 py-1 text-xs font-semibold border border-border rounded hover:border-accent-primary transition-colors",children:"Edit"}),l.jsx("button",{onClick:v=>{v.stopPropagation(),Te(B.id)},className:"px-2 py-1 text-xs font-semibold border border-status-danger text-status-danger rounded hover:bg-status-danger/10 transition-colors",children:"Delete"})]})]},B.id))})]}),w&&l.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center z-50",children:l.jsx("div",{className:"bg-bg-light w-full max-w-5xl max-h-[90vh] overflow-auto rounded shadow-lg border border-border",children:l.jsxs("form",{onSubmit:Re,className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-fg-primary",children:y==="create"?"Create Markup Profile":"Edit Markup Profile"}),l.jsx("button",{type:"button",onClick:W,className:"text-sm text-fg-secondary hover:text-fg-primary",children:"Close"})]}),L&&l.jsx("div",{className:"mb-4 p-3 bg-status-danger/10 border border-status-danger rounded text-sm text-status-danger",children:L}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("label",{className:"text-sm text-fg-secondary",children:["ID",l.jsx("input",{type:"text",value:b.id,disabled:y==="edit",onChange:B=>G(v=>({...v,id:B.target.value})),className:"mt-1 w-full px-3 py-2 border border-border rounded bg-bg-light text-fg-primary",placeholder:"script_default"})]}),l.jsxs("label",{className:"text-sm text-fg-secondary",children:["Label",l.jsx("input",{type:"text",value:b.label,onChange:B=>G(v=>({...v,label:B.target.value})),className:"mt-1 w-full px-3 py-2 border border-border rounded bg-bg-light text-fg-primary",placeholder:"Default Script"})]})]}),l.jsxs("label",{className:"text-sm text-fg-secondary mt-4 block",children:["Description",l.jsx("textarea",{value:b.description||"",onChange:B=>G(v=>({...v,description:B.target.value})),className:"mt-1 w-full px-3 py-2 border border-border rounded bg-bg-light text-fg-primary",rows:3})]}),l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h3",{className:"text-lg font-semibold text-fg-primary",children:"Tokens"}),l.jsxs("button",{type:"button",onClick:ye,className:"flex items-center gap-2 px-3 py-2 border border-border rounded text-sm text-fg-primary hover:bg-bg-dark",children:[l.jsx(Bs,{size:14}),"Add Token"]})]}),Se.length===0?l.jsx("div",{className:"text-sm text-fg-secondary py-6 text-center border border-dashed border-border rounded",children:"No tokens added yet."}):l.jsx("div",{className:"space-y-4",children:Se.map((B,v)=>l.jsxs("div",{className:"border border-border rounded p-4 bg-bg-light",children:[l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1",children:[l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Token ID",l.jsx("input",{type:"text",value:B.id,onChange:M=>Oe(v,{id:M.target.value}),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"scene"})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Label",l.jsx("input",{type:"text",value:B.label,onChange:M=>Oe(v,{label:M.target.value}),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"Scene"})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Format Scope",l.jsx("select",{value:B.format_scope||"line",onChange:M=>Oe(v,{format_scope:M.target.value}),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",children:Sv.map(M=>l.jsx("option",{value:M,children:M},M))})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Prefix",l.jsx("input",{type:"text",value:B.prefix||"",onChange:M=>Oe(v,{prefix:M.target.value}),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"[SCENE]"})]}),l.jsxs("label",{className:"text-xs text-fg-secondary md:col-span-2",children:["Pattern (regex)",l.jsx("input",{type:"text",value:B.pattern||"",onChange:M=>Oe(v,{pattern:M.target.value}),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"^(?P<name>[A-Z]+):"})]})]}),l.jsx("button",{type:"button",onClick:()=>ee(v),className:"p-2 border border-status-danger text-status-danger rounded hover:bg-status-danger/10",title:"Remove token",children:l.jsx(Ls,{size:14})})]}),l.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Text Transform",l.jsx("select",{value:B.format?.text_transform||"none",onChange:M=>$(v,"text_transform",M.target.value),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",children:wv.map(M=>l.jsx("option",{value:M,children:M},M))})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Align",l.jsxs("select",{value:B.format?.align||"",onChange:M=>$(v,"align",M.target.value),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",children:[l.jsx("option",{value:"",children:"Default"}),jv.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Font Size",l.jsx("input",{type:"text",value:B.format?.font_size||"",onChange:M=>$(v,"font_size",M.target.value),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"14px"})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Text Color",l.jsx("input",{type:"text",value:B.format?.color||"",onChange:M=>$(v,"color",M.target.value),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"#FF5733"})]}),l.jsxs("label",{className:"text-xs text-fg-secondary",children:["Background Color",l.jsx("input",{type:"text",value:B.format?.background_color||"",onChange:M=>$(v,"background_color",M.target.value),className:"mt-1 w-full px-2 py-1 border border-border rounded bg-bg-light text-fg-primary",placeholder:"#F0F0F0"})]}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-fg-secondary mt-6",children:[l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:!!B.format?.bold,onChange:M=>$(v,"bold",M.target.checked)}),"Bold"]}),l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:!!B.format?.italic,onChange:M=>$(v,"italic",M.target.checked)}),"Italic"]}),l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:!!B.format?.underline,onChange:M=>$(v,"underline",M.target.checked)}),"Underline"]})]})]})]},`${B.id||"token"}-${v}`))})]}),l.jsxs("div",{className:"flex items-center justify-between mt-6",children:[l.jsx("button",{type:"button",onClick:W,className:"px-4 py-2 border border-border rounded text-fg-primary hover:bg-bg-dark",children:"Cancel"}),l.jsxs("button",{type:"submit",disabled:ie,className:"flex items-center gap-2 px-4 py-2 bg-accent text-white rounded hover:bg-accent/90 disabled:opacity-70",children:[l.jsx(Pm,{size:16}),ie?"Saving...":"Save Profile"]})]})]})})})]})]})}function _v({onClose:o}){const[s,i]=m.useState([]),[u,f]=m.useState(!0),[h,x]=m.useState(null),[w,E]=m.useState(!1),[y,S]=m.useState("create"),[b,G]=m.useState(null),[L,ce]=m.useState({id:"",file:"",description:""}),[ie,ve]=m.useState(null),[ge,Ee]=m.useState(null),[_e,W]=m.useState(!1),[Te,fe]=m.useState(null);m.useEffect(()=>{oe()},[]);const oe=async()=>{try{f(!0),x(null);const ee=await Ae.getIconsConfig();i(ee.icons||[])}catch(ee){const Se=ee instanceof Error?ee.message:String(ee);x(`Failed to load icons: ${Se}`)}finally{f(!1)}},Ce=()=>{S("create"),G(null),ce({id:"",file:"",description:""}),ve(null),fe(null),Ee(null),E(!0)},Re=ee=>{if(S("edit"),G(ee.id),ce({id:ee.id,file:ee.file,description:ee.description||""}),ve(null),ee.file){const Se=`${Dn}/api/v1/assets/icons/${ee.id}`;fe(Se)}else fe(null);Ee(null),E(!0)},Oe=()=>{E(!1),ve(null),fe(null),Ee(null),W(!1)},$=async ee=>{if(window.confirm(`Delete icon "${ee}"?`))try{x(null),await Ae.deleteIcon(ee),await oe()}catch(B){const v=B instanceof Error?B.message:String(B);x(`Failed to delete icon: ${v}`)}},ye=async ee=>{if(ee.preventDefault(),!L.id||!L.file||!L.description){Ee("ID, file, and description are required.");return}try{W(!0),Ee(null);let Se=L.file;if(y==="create")await Ae.createIcon({id:L.id,file:Se,description:L.description}),ie&&(Se=(await Ae.uploadIconFile(L.id,ie)).file,await Ae.updateIcon(L.id,{id:L.id,file:Se,description:L.description}));else if(b){if(ie){const B=L.id||b;Se=(await Ae.uploadIconFile(B,ie)).file}await Ae.updateIcon(b,{id:L.id,file:Se,description:L.description})}await oe(),Oe()}catch(Se){const B=Se instanceof Error?Se.message:String(Se);Ee(`Failed to ${y} icon: ${B}`)}finally{W(!1)}};return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[l.jsx(El,{}),l.jsxs("div",{className:"flex flex-col h-full overflow-hidden flex-1 bg-bg-light",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"p-1 hover:bg-bg-dark rounded transition-colors",title:"Go back",children:l.jsx(_l,{size:24,className:"text-fg-primary"})}),l.jsx("h1",{className:"text-2xl font-display font-bold text-fg-primary",children:"Icon Editor"})]}),l.jsxs("button",{onClick:Ce,className:"flex items-center gap-2 px-3 py-2 bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity font-semibold",children:[l.jsx(Bs,{size:18}),"New Icon"]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[h&&l.jsxs("div",{className:"mb-4 p-4 bg-status-danger/10 border border-status-danger rounded flex items-start gap-3",children:[l.jsx(fa,{size:20,className:"text-status-danger flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-status-danger",children:"Error"}),l.jsx("p",{className:"text-sm text-status-danger/80",children:h})]})]}),u?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-fg-secondary",children:"Loading icons..."})}):s.length===0?l.jsx("div",{className:"flex items-center justify-center h-64 text-center",children:l.jsx("p",{className:"text-lg text-fg-secondary",children:"No icons found"})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(ee=>l.jsxs("div",{className:"p-4 bg-bg-dark border border-border rounded hover:border-accent-primary transition-colors",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-mono text-sm font-semibold text-fg-primary mb-2",children:ee.id}),ee.description&&l.jsx("p",{className:"text-xs text-fg-secondary mb-3",children:ee.description}),ee.file&&l.jsxs("p",{className:"text-xs text-fg-secondary mb-2",children:[l.jsx("span",{className:"font-semibold",children:"File:"})," ",ee.file]})]}),l.jsx("div",{className:"h-10 w-10 rounded bg-bg-light flex items-center justify-center",children:l.jsx("div",{style:{backgroundColor:"#e5e7eb",maskImage:`url(${Dn}/api/v1/assets/icons/${ee.id})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${Dn}/api/v1/assets/icons/${ee.id})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"},className:"h-6 w-6"})})]}),l.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[l.jsx("button",{onClick:()=>Re(ee),className:"px-2 py-1 text-xs font-semibold border border-border rounded hover:border-accent-primary transition-colors",children:"Edit"}),l.jsx("button",{onClick:()=>$(ee.id),className:"px-2 py-1 text-xs font-semibold border border-status-danger text-status-danger rounded hover:bg-status-danger/10 transition-colors",children:"Delete"})]})]},ee.id))})]})]}),w&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:l.jsxs("div",{className:"w-full max-w-2xl rounded border border-border bg-bg-dark max-h-96 overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-fg-primary",children:y==="create"?"Create Icon":"Edit Icon"}),l.jsx("button",{onClick:Oe,className:"text-sm text-fg-secondary hover:text-fg-primary",children:"Close"})]}),l.jsxs("form",{onSubmit:ye,className:"space-y-4 p-4",children:[ge&&l.jsx("div",{className:"rounded border border-status-danger bg-status-danger/10 px-3 py-2 text-sm text-status-danger",children:ge}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"ID"}),l.jsx("input",{type:"text",value:L.id,onChange:ee=>ce({...L,id:ee.target.value}),className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"SVG File"}),y==="edit"&&L.file&&l.jsxs("span",{className:"text-xs text-fg-secondary",children:["Current: ",L.file]})]}),l.jsx("input",{type:"file",accept:".svg",onChange:ee=>{const Se=ee.target.files?.[0]||null;if(ve(Se),ce({...L,file:Se?Se.name:L.file}),Se){const B=URL.createObjectURL(Se);fe(B)}else fe(null)},className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"}),l.jsx("div",{className:"text-xs text-fg-secondary",children:ie?`New file selected: ${ie.name}`:y==="edit"?"Leave empty to keep current file, or select a new one.":"Choose an SVG file to copy into the icons folder."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-semibold text-fg-secondary",children:"Description"}),l.jsx("textarea",{value:L.description,onChange:ee=>ce({...L,description:ee.target.value}),rows:3,className:"w-full rounded border border-border bg-bg-light px-3 py-2 text-sm text-fg-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),Te&&l.jsxs("div",{className:"space-y-2 rounded border border-border bg-bg-dark p-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-fg-secondary",children:"Preview"}),l.jsx("div",{className:"flex items-center justify-center rounded bg-bg-light p-4",children:l.jsx("div",{style:{backgroundColor:"#e5e7eb",maskImage:`url(${Te})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${Te})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"},className:"h-12 w-12"})})]}),l.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[l.jsx("button",{type:"button",onClick:Oe,className:"px-3 py-2 text-sm font-semibold border border-border rounded hover:border-accent-primary transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:_e,className:"px-3 py-2 text-sm font-semibold bg-accent-primary text-bg-dark rounded hover:opacity-90 transition-opacity disabled:opacity-50",children:_e?"Saving...":y==="create"?"Create Icon":"Save Changes"})]})]})]})})]})}function Tp(o={}){const[s,i]=m.useState(!1),[u,f]=m.useState(null),h=m.useRef(o);m.useEffect(()=>{h.current=o},[o]),m.useEffect(()=>{const w=localStorage.getItem("talus_tally_session_id"),E=Ae.connectSocket({onConnect:()=>{i(!0),h.current.onConnect?.()},onNodeCreated:y=>h.current.onNodeCreated?.(y),onNodeUpdated:y=>h.current.onNodeUpdated?.(y),onNodeDeleted:y=>h.current.onNodeDeleted?.(y),onDisconnect:()=>{i(!1),h.current.onDisconnect?.()},sessionId:w});return f(E),()=>{Ae.disconnectSocket()}},[]);const x=m.useCallback((w,E)=>{u?.emit(w,E)},[u]);return{connected:s,socket:u,emit:x}}function Ev({sessionId:o,onNodeSelect:s}){const[i,u]=m.useState([]),[f,h]=m.useState(!1),[x,w]=m.useState(null),E=m.useRef(!1),y=m.useRef(!1),S=m.useCallback(async()=>{if(o){if(y.current){E.current=!0;return}y.current=!0;try{h(!0),w(null);const b=await Ae.getVelocityRanking(o);u(b.nodes)}catch(b){w(b instanceof Error?b.message:"Failed to load velocity ranking"),console.error("Error loading velocity ranking:",b)}finally{h(!1),y.current=!1,E.current&&(E.current=!1,S())}}},[o]);return m.useEffect(()=>{S()},[S]),Tp({onNodeCreated:S,onNodeUpdated:S,onNodeDeleted:S}),o?l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark text-fg-primary",children:[x&&l.jsx("div",{className:"px-6 py-3 bg-status-danger/10 border-b border-status-danger text-status-danger",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(fa,{size:18}),l.jsx("span",{className:"text-sm",children:x})]})}),f&&l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"text-fg-secondary",children:"Loading velocity ranking..."})}),!f&&i.length>0&&l.jsx("div",{className:"flex-1 overflow-auto",children:l.jsx("div",{className:"space-y-0",children:i.map((b,G)=>l.jsx("div",{onClick:()=>s?.(b.nodeId),className:"border-b border-border hover:bg-bg-light transition-colors cursor-pointer",children:l.jsxs("div",{className:"px-6 py-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[l.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-accent-primary text-fg-primary font-bold text-sm",children:G+1}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-fg-primary",children:b.nodeName}),l.jsx("div",{className:"text-xs text-fg-secondary",children:b.nodeType})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-2xl font-bold text-accent-primary",children:b.totalVelocity.toFixed(0)}),l.jsx("div",{className:"text-xs text-fg-secondary",children:"velocity"})]})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-3 text-xs",children:[l.jsxs("div",{className:"bg-bg-dark p-2 rounded",children:[l.jsx("div",{className:"text-fg-secondary",children:"Base"}),l.jsxs("div",{className:"font-semibold text-fg-primary",children:["+",b.baseScore.toFixed(0)]})]}),l.jsxs("div",{className:"bg-bg-dark p-2 rounded",children:[l.jsx("div",{className:"text-fg-secondary",children:"Inherited"}),l.jsxs("div",{className:"font-semibold text-fg-primary",children:["+",b.inheritedScore.toFixed(0)]})]}),l.jsxs("div",{className:"bg-bg-dark p-2 rounded",children:[l.jsx("div",{className:"text-fg-secondary",children:"Status"}),l.jsxs("div",{className:"font-semibold text-fg-primary",children:["+",b.statusScore.toFixed(0)]})]}),l.jsxs("div",{className:"bg-bg-dark p-2 rounded",children:[l.jsx("div",{className:"text-fg-secondary",children:"Numerical"}),l.jsxs("div",{className:"font-semibold text-fg-primary",children:["+",b.numericalScore.toFixed(0)]})]})]}),(b.blockingBonus!==0||b.blockingPenalty!==0)&&l.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs",children:[b.blockingBonus!==0&&l.jsxs("div",{className:"bg-bg-dark px-2 py-1 rounded text-fg-primary",children:["Blocking Bonus: +",b.blockingBonus.toFixed(0)]}),b.blockingPenalty!==0&&l.jsxs("div",{className:"bg-bg-dark px-2 py-1 rounded text-fg-primary",children:["Blocking Penalty: ",b.blockingPenalty.toFixed(0)]})]}),(b.isBlocked||b.blockedByNodes&&b.blockedByNodes.length>0)&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[b.isBlocked&&l.jsxs("div",{className:"flex items-center gap-2 text-status-danger text-xs mb-2",children:[l.jsx(pb,{size:14}),l.jsxs("span",{children:["Blocked by ",b.blockedByNodes?.length||0," node(s)"]})]}),b.blocksNodeIds&&b.blocksNodeIds.length>0&&l.jsxs("div",{className:"flex items-center gap-2 text-accent-primary text-xs",children:[l.jsx(tp,{size:14}),l.jsxs("span",{children:["Blocking ",b.blocksNodeIds.length," node(s)"]})]})]})]})},b.nodeId))})}),!f&&i.length===0&&l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-fg-secondary",children:[l.jsx(ep,{size:48,className:"mx-auto mb-3 opacity-30"}),l.jsx("div",{className:"text-sm",children:"No nodes in project"})]})}),i.length>0&&l.jsx("div",{className:"border-t border-border px-6 py-3 bg-bg-light text-xs text-fg-secondary",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Score Components:"}),l.jsxs("div",{className:"mt-1 space-y-1",children:[l.jsx("div",{children:" Base: Fixed points from node type"}),l.jsx("div",{children:" Inherited: Cumulative parent scores"}),l.jsx("div",{children:" Status: Points from current status"}),l.jsx("div",{children:" Numerical: Value  multiplier"})]})]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Blocking Logic:"}),l.jsxs("div",{className:"mt-1 space-y-1",children:[l.jsx("div",{children:" Blocked nodes score is zeroed"}),l.jsx("div",{children:" Blocking node gains blocked scores"}),l.jsx("div",{children:" Floats important tasks to top"})]})]})]})})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center text-fg-secondary bg-bg-dark",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg mb-2",children:"No project loaded"}),l.jsx("div",{className:"text-sm",children:"Load a project to see velocity rankings"})]})})}const Cv=(o,s)=>{if(!o)return o;let i=o;return i=i.replace(/fill="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill="${f}"`:`fill="${s}"`}).replace(/fill='([^']*)'/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`fill='${f}'`:`fill='${s}'`}).replace(/stroke="([^"]*)"/gi,(u,f)=>{const h=String(f).trim().toLowerCase();return h==="none"||h==="transparent"?`stroke="${f}"`:`stroke="${s}"`}),i},Tv={project_root:"film",assets:"archive-box",inventory_root:"archive-box",camera_gear_inventory:"camera",camera_gear_category:"camera",camera_gear_asset:"camera",parts_inventory:"cog",part_category:"cog",part_asset:"cog",car_parts_inventory:"cog",tools_inventory:"cog",tool_category:"cog",tool_asset:"cog",vehicles:"truck",vehicle_asset:"truck",phase:"calendar-days",season:"calendar-days",episode:"video-camera",task:"clipboard-document-check",footage:"play-circle",location_scout:"map-pin"};function kv({sessionId:o,nodes:s,onNodeSelect:i,onCountsChange:u,onDirtyChange:f,fitToViewSignal:h,refreshSignal:x,blockingViewConfig:w,templateSchema:E}){const y=m.useRef(null),S=!1,[b,G]=m.useState([]),[L,ce]=m.useState([]),[ie,ve]=m.useState(null),[ge,Ee]=m.useState(null),[_e,W]=m.useState(null),[Te,fe]=m.useState(null),[oe,Ce]=m.useState(null),[Re,Oe]=m.useState({x:0,y:0}),[$,ye]=m.useState(!1),[ee,Se]=m.useState({x:0,y:0}),[B,v]=m.useState(1),[M,Z]=m.useState(!1),[j,se]=m.useState(null),[g,T]=m.useState({}),[A,X]=m.useState({}),[me,we]=m.useState(0),qe=m.useMemo(()=>{const z=new Map;return E?.node_types?.forEach(U=>{const C=U.color??U.schema_color??U.schemaColor,D=U.shape??U.schema_shape??U.schemaShape;z.set(U.id,{color:C,shape:D})}),z},[E]),te=m.useMemo(()=>{const z=Object.values(g);return z.length===0?0:z.reduce((U,C)=>C>U?C:U,0)},[g]),de=m.useMemo(()=>{const z={baseWidth:160,baseHeight:100,maxDepth:6,minScale:.7,maxScale:1.3},U=w?.node_size||{},C=Math.max(40,Number(U.base_width??z.baseWidth)),D=Math.max(30,Number(U.base_height??z.baseHeight)),Q=Math.max(1,Math.floor(Number(U.max_depth??z.maxDepth))),ue=Number(U.min_scale??z.minScale),be=Number(U.max_scale??z.maxScale),je=Math.max(.1,Math.min(ue,be)),Ne=Math.max(je+.01,Math.max(ue,be)),Le=U.direction==="up"?"up":"down";return{baseWidth:C,baseHeight:D,maxDepth:Q,minScale:je,maxScale:Ne,direction:Le}},[w]),Xe=m.useCallback(()=>te<=0?de.maxDepth:Math.max(1,Math.min(de.maxDepth,te)),[te,de.maxDepth]),Je=m.useCallback(z=>{const U=g[z]??0,C=Xe(),D=Math.min(U,C),Q=C>0?D/C:0;return de.direction==="up"?de.minScale+(de.maxScale-de.minScale)*Q:de.maxScale-(de.maxScale-de.minScale)*Q},[Xe,g,de.direction,de.maxScale,de.minScale]),Ie=(z,U,C)=>Math.min(C,Math.max(U,z)),vt=z=>{const U=z.trim();if(!/^#([0-9a-fA-F]{6})$/.test(U))return null;const C=parseInt(U.slice(1),16);return{r:C>>16&255,g:C>>8&255,b:C&255}},Ot=(z,U,C)=>{const D=z/255,Q=U/255,ue=C/255,be=Math.max(D,Q,ue),je=Math.min(D,Q,ue),Ne=be-je;let Le=0,He=0;const lt=(be+je)/2;if(Ne!==0){switch(He=Ne/(1-Math.abs(2*lt-1)),be){case D:Le=(Q-ue)/Ne%6;break;case Q:Le=(ue-D)/Ne+2;break;case ue:Le=(D-Q)/Ne+4;break}Le*=60,Le<0&&(Le+=360)}return{h:Le,s:He,l:lt}},zt=(z,U,C)=>{const D=(1-Math.abs(2*C-1))*U,Q=D*(1-Math.abs(z/60%2-1)),ue=C-D/2;let be=0,je=0,Ne=0;return z>=0&&z<60?(be=D,je=Q):z>=60&&z<120?(be=Q,je=D):z>=120&&z<180?(je=D,Ne=Q):z>=180&&z<240?(je=Q,Ne=D):z>=240&&z<300?(be=Q,Ne=D):(be=D,Ne=Q),{r:Math.round((be+ue)*255),g:Math.round((je+ue)*255),b:Math.round((Ne+ue)*255)}},wt=(z,U,C=0)=>{const D=vt(z);if(!D)return z;const{h:Q,s:ue,l:be}=Ot(D.r,D.g,D.b),je=U/255*100,Ne=Ie(be*100+je,0,100)/100,Le=Ie(ue*100+C,0,100)/100,{r:He,g:lt,b:ct}=zt(Q,Le,Ne);return`#${[He,lt,ct].map(Ye=>Ye.toString(16).padStart(2,"0")).join("")}`},Mt=(z,U,C=.5)=>{const D=vt(z),Q=vt(U);if(!D||!Q)return z;const ue=Ie(C,0,1),be=Math.round(D.r*(1-ue)+Q.r*ue),je=Math.round(D.g*(1-ue)+Q.g*ue),Ne=Math.round(D.b*(1-ue)+Q.b*ue);return`#${[be,je,Ne].map(Le=>Le.toString(16).padStart(2,"0")).join("")}`},Xt=z=>{const U=z?.trim();return U||"roundedSquare"};m.useEffect(()=>{if(!o){se(null);return}(async()=>{try{const U=await Ae.getVelocityRanking(o),C=new Set(U.nodes.filter(D=>D.totalVelocity>=0).map(D=>D.nodeId));se(C)}catch(U){console.error("Failed to fetch velocity ranking for blocker filter:",U),se(null)}})()},[o]),m.useEffect(()=>jp(()=>{we(U=>U+1)}),[]),m.useEffect(()=>{},[S,s,qe]),m.useEffect(()=>{const z=Object.keys(s);if(z.length===0){T({}),G([]);return}const U=z.find(Ye=>{const Tt=s[Ye].type;return Tt==="project"||Tt==="project_root"}),C={},D={},Q={};z.forEach(Ye=>{C[Ye]=0,D[Ye]=[]}),z.forEach(Ye=>{(s[Ye].children||[]).forEach(jt=>{D[Ye].includes(jt)||D[Ye].push(jt),Q[jt]||(Q[jt]=Ye)})});const ue=new Set,be=[];for(z.forEach(Ye=>{const Tt=Q[Ye];(!Tt||Tt===U)&&(be.push(Ye),C[Ye]=0,ue.add(Ye))});be.length>0;){const Ye=be.shift();(D[Ye]||[]).forEach(jt=>{ue.has(jt)||(C[jt]=C[Ye]+1,ue.add(jt),be.push(jt))})}T(C);const je=z.filter(Ye=>Ye===U?!1:j===null?!0:j.has(Ye)),Ne={width:de.baseWidth,height:de.baseHeight},Le=50,He=Math.max(Ne.width,Ne.height)*de.maxScale+60,lt=Math.max(3,Math.ceil(Math.sqrt(je.length*.7))),ct=je.map((Ye,Tt)=>{const jt=C[Ye],Lt=Math.floor(Tt/lt),ha=Tt%lt*He+jt*80+Le,$a=Lt*He+Le;return{id:Ye,label:s[Ye].properties?.name||Ye,x:ha,y:$a}});G(ct)},[s,j,de.baseWidth,de.baseHeight,de.maxScale]),m.useEffect(()=>{let z=!0;const U=new Map;return b.forEach(C=>{const D=s[C.id];if(!D)return;const Q=D.icon_id??Tv[D.type]??D.type??void 0;U.set(C.id,Q)}),X(C=>{const D={};return U.forEach((Q,ue)=>{ue in C&&(D[ue]=C[ue])}),D}),U.forEach((C,D)=>{if(!C){X(Q=>{if(!Q[D])return Q;const ue={...Q};return delete ue[D],ue});return}Np(C).then(Q=>{z&&X(ue=>ue[D]===Q?ue:{...ue,[D]:Q})}).catch(Q=>{console.warn("[NodeBlockingEditor] Failed to load icon",C,Q),z&&X(ue=>{if(!ue[D])return ue;const be={...ue};return delete be[D],be})})}),()=>{z=!1}},[s,b,me]),m.useEffect(()=>{const z=C=>{C.code==="Space"&&!M&&(Z(!0),C.preventDefault())},U=C=>{C.code==="Space"&&(Z(!1),C.preventDefault())};return window.addEventListener("keydown",z),window.addEventListener("keyup",U),()=>{window.removeEventListener("keydown",z),window.removeEventListener("keyup",U)}},[M]);const Qt=m.useCallback(async()=>{if(o)try{const z=await Ae.getBlockingGraph(o);ce(z.relationships.map(U=>({from:U.blockingNodeId,to:U.blockedNodeId})))}catch(z){console.error("Failed to fetch blocking relationships:",z)}},[o]);m.useEffect(()=>{Qt()},[Qt,x]),m.useEffect(()=>{u?.(b.length,L.length)},[b,L,u]);const Ut=z=>b.find(U=>U.id===z),un=(z,U)=>{U.button===0&&(ve(z),U.preventDefault())},On=(z,U)=>{if(!y.current)return;U.stopPropagation();const C=y.current.getBoundingClientRect(),D=(U.clientX-C.left-Re.x)/B,Q=(U.clientY-C.top-Re.y)/B;Ee({from:z,x:D,y:Q})},zn=z=>{if(!y.current)return;const U=y.current.getBoundingClientRect(),C=(z.clientX-U.left-Re.x)/B,D=(z.clientY-U.top-Re.y)/B;if(ie){const Q=Je(ie),ue=de.baseWidth*Q,be=de.baseHeight*Q;G(je=>je.map(Ne=>Ne.id===ie?{...Ne,x:C-ue/2,y:D-be/2}:Ne))}if(ge&&Ee(Q=>Q?{...Q,x:C,y:D}:null),$){const Q=Re.x+(z.clientX-U.left-ee.x),ue=Re.y+(z.clientY-U.top-ee.y);Oe({x:Q,y:ue}),Se({x:z.clientX-U.left,y:z.clientY-U.top})}},Ht=()=>{ve(null),ye(!1)},Qe=z=>{ge||W(z)},Ft=()=>{ge||W(null)},J=async z=>{if(!ge||!o)return;const{from:U}=ge;if(U===z){Ce({type:"error",text:"A node cannot block itself"}),Ee(null);return}if(L.some(C=>C.from===U&&C.to===z)){Ce({type:"error",text:"This relationship already exists"}),Ee(null);return}try{const C=await Ae.updateBlockingRelationship(o,z,U);await Qt(),Ce({type:"success",text:"Blocking relationship created"}),typeof C?.is_dirty=="boolean"?f?.(C.is_dirty):f?.(!0),setTimeout(()=>Ce(null),3e3)}catch{Ce({type:"error",text:"Failed to create relationship"})}Ee(null)},he=z=>{const U=z.button===1,C=M&&z.button===0&&!ie;if(U||C){ye(!0);const D=y.current.getBoundingClientRect();Se({x:z.clientX-D.left,y:z.clientY-D.top}),z.preventDefault()}},ke=z=>{z.preventDefault();const U=1.1,C=z.deltaY<0?B*U:B/U;v(Math.max(.1,Math.min(10,C)))},De=()=>{if(b.length===0||!y.current)return;let z=1/0,U=1/0,C=-1/0,D=-1/0;const Q=Lt=>{const hn=Je(Lt);return{width:de.baseWidth*hn,height:de.baseHeight*hn}};b.forEach(Lt=>{const hn=Q(Lt.id);z=Math.min(z,Lt.x),U=Math.min(U,Lt.y),C=Math.max(C,Lt.x+hn.width),D=Math.max(D,Lt.y+hn.height)});const ue=y.current.getBoundingClientRect(),be=ue.width,je=ue.height,Ne=C-z,Le=D-U,He=1.2,lt=be/(Ne*He),ct=je/(Le*He),Ye=Math.min(lt,ct),Tt=be/2-(z+Ne/2)*Ye,jt=je/2-(U+Le/2)*Ye;v(Math.max(.1,Math.min(10,Ye))),Oe({x:Tt,y:jt})};if(m.useEffect(()=>{h!==void 0&&De()},[h]),!o)return l.jsx("div",{className:"flex items-center justify-center h-full bg-bg-dark text-fg-secondary",children:l.jsxs("div",{className:"text-center",children:[l.jsx(fa,{size:48,className:"mx-auto mb-3 opacity-50"}),l.jsx("p",{children:"Please open a project to configure blocking relationships"})]})});const Me=z=>{const U=Je(z);return{width:de.baseWidth*U,height:de.baseHeight*U}},Ge=z=>`${z.from}-${z.to}`;return l.jsxs("div",{className:"flex flex-col h-full bg-bg-dark",children:[oe&&l.jsx("div",{className:`mx-4 mt-3 p-2 rounded-md text-sm ${oe.type==="success"?"bg-status-success/20 text-status-success":"bg-status-danger/20 text-status-danger"}`,children:oe.text}),l.jsx("div",{className:"flex-1 flex overflow-hidden",children:l.jsx("div",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-bg-dark to-bg-light cursor-grab active:cursor-grabbing",children:l.jsxs("svg",{ref:y,className:"w-full h-full",onMouseMove:zn,onMouseUp:Ht,onMouseDown:he,onWheel:ke,onContextMenu:z=>z.preventDefault(),children:[l.jsxs("defs",{children:[l.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",children:l.jsx("polygon",{points:"0 0, 10 3, 0 6",fill:"#ef4444"})}),l.jsx("marker",{id:"arrowhead-hover",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",children:l.jsx("polygon",{points:"0 0, 10 3, 0 6",fill:"#dc2626"})})]}),l.jsxs("g",{transform:`translate(${Re.x}, ${Re.y}) scale(${B})`,pointerEvents:"none",children:[l.jsx("defs",{children:l.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:l.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#374151",strokeWidth:"0.5"})})}),l.jsx("rect",{width:"5000",height:"5000",fill:"url(#grid)"})]}),l.jsxs("g",{transform:`translate(${Re.x}, ${Re.y}) scale(${B})`,children:[b.map(z=>{const U=s[z.id];if(!U||!U.parent_id)return null;const C=b.find(Le=>Le.id===U.parent_id);if(!C)return null;const D=Me(C.id),Q=Me(z.id),ue=C.x+D.width,be=C.y+D.height/2,je=z.x,Ne=z.y+Q.height/2;return l.jsx("line",{x1:ue,y1:be,x2:je,y2:Ne,stroke:"#6b7280",strokeWidth:"1",strokeDasharray:"3,3",opacity:"0.5",pointerEvents:"none"},`family-${z.id}`)}),L.map(z=>{const U=Ut(z.from),C=Ut(z.to);if(!U||!C)return null;const D=Ge(z),Q=Te===D,ue=Me(z.from),be=Me(z.to),je=U.x+ue.width,Ne=U.y+ue.height/2,Le=C.x,He=C.y+be.height/2,lt=(je+Le)/2,ct=(Ne+He)/2-40,Ye=`M ${je} ${Ne} Q ${lt} ${ct} ${Le} ${He}`;return l.jsxs("g",{children:[l.jsx("path",{d:Ye,fill:"none",stroke:Q?"#dc2626":"#ef4444",strokeWidth:Q?"3":"2",markerEnd:Q?"url(#arrowhead-hover)":"url(#arrowhead)",className:"transition-all",onMouseEnter:()=>fe(D),onMouseLeave:()=>fe(null),opacity:"0.7",strokeDasharray:"5,5"}),l.jsx("text",{x:(je+Le)/2,y:(Ne+He)/2-50,textAnchor:"middle",fontSize:"12",fill:"#ef4444",className:"cursor-pointer pointer-events-none select-none",fontWeight:"600",children:"blocks"})]},D)}),ge&&Ut(ge.from)&&l.jsx("line",{x1:Ut(ge.from).x+Me(ge.from).width,y1:Ut(ge.from).y+Me(ge.from).height/2,x2:ge.x,y2:ge.y,stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"4,4",markerEnd:"url(#arrowhead-hover)",pointerEvents:"none"}),b.map(z=>{const U=s[z.id],D=(U.parent_id?s[U.parent_id]:null)?.properties?.name||(U.parent_id?U.parent_id.slice(0,8):""),Q=Me(z.id);g[z.id],Je(z.id);const ue=qe.get(U.type),be=U.schema_color??ue?.color,je=Xt(U.schema_shape??ue?.shape),Ne=be?Mt(be,"#000000",.45):"#0f172a",Le="#1f2937",He=be?Mt(be,"#000000",.2):"#1f2937",lt=_e===z.id||ge?.from===z.id?"#3b82f6":be?Mt(be,"#000000",.6):"#4b5563",ct=Math.max(4,Math.min(12,Q.height*.1)),Ye=Math.max(20,Q.width-ct*2),Tt=Math.max(16,Q.height-ct*2),jt=Q.width/2,Lt=Q.height/2,hn=je==="circle"||je==="hexagon",ha=A[z.id],bn=ha?`data:image/svg+xml;utf8,${encodeURIComponent(Cv(ha,"#ffffff"))}`:null,Mn=!!bn,Vn={fill:_e===z.id?wt(Ne,10):Ne,stroke:lt||Le,strokeWidth:2,className:"cursor-move select-none transition-all",onMouseDown:Pt=>un(z.id,Pt),onMouseEnter:()=>Qe(z.id),onMouseLeave:Ft,onClick:()=>i?.(z.id)},Gn=hn?{fill:_e===z.id&&!U.schema_color?"#1e3a8a":He,stroke:lt,strokeWidth:1.5,pointerEvents:"none",className:"select-none transition-all"}:{...Vn,fill:_e===z.id&&!U.schema_color?"#1e3a8a":He,stroke:lt,strokeWidth:1.5},xn=()=>l.jsx("rect",{width:Q.width,height:Q.height,rx:Math.max(8,Math.min(18,Q.height*.22)),ry:Math.max(8,Math.min(18,Q.height*.22)),...Vn}),ut=()=>{if(je==="circle"){const it=Math.min(Ye,Tt)/2;return l.jsx("ellipse",{cx:jt,cy:Lt,rx:it,ry:it,...Gn})}if(je==="hexagon"){const it=Ye,Yn=Tt,nn=2,Xn=Math.max(6,Math.min(14,Math.min(it,Yn)*.1)),sa=jt,kt=Lt,la=Math.min(it,Yn)/2+Xn-nn,Bt=0,ia=Array.from({length:6},(ma,ja)=>{const Ha=Bt+ja*Math.PI/3,an=sa+la*Math.cos(Ha),ps=kt+la*Math.sin(Ha);return`${an},${ps}`}).join(" ");return l.jsx("polygon",{points:ia,...Gn})}const Pt=je==="rounded"?Math.max(6,Math.min(20,Q.height*.2)):je==="roundedSquare"?Math.max(4,Math.min(16,Q.height*.16)):Math.max(3,Math.min(12,Q.height*.12));return l.jsx("rect",{x:ct,y:ct,width:Ye,height:Tt,rx:Pt,ry:Pt,...Gn})},St=Math.max(14,Math.min(22,Q.height*.24)),Vt=Q.width/2-St/2,vn=Q.height*.24-St/2,aa=Mn?Q.height*.56:Q.height*.5,Tl=Mn?Q.height*.72:Q.height*.66,kl=Mn?Q.height*.86:Q.height*.82,We=Math.max(5,Math.min(10,Q.height*.08));return l.jsxs("g",{transform:`translate(${z.x}, ${z.y})`,children:[hn&&xn(),ut(),bn&&l.jsx("image",{href:bn,x:Vt,y:vn,width:St,height:St,className:"pointer-events-none select-none",opacity:"0.95"}),l.jsx("text",{x:Q.width/2,y:aa,textAnchor:"middle",fontSize:"13",fontWeight:"600",className:"pointer-events-none select-none",fill:"#ffffff",children:z.label.length>16?z.label.substring(0,14)+"...":z.label}),l.jsx("text",{x:Q.width/2,y:Tl,textAnchor:"middle",fontSize:"10",fontWeight:"700",className:"pointer-events-none select-none",fill:"#ffffff",children:U.type.toUpperCase()}),D&&l.jsxs("text",{x:Q.width/2,y:kl,textAnchor:"middle",fontSize:"10",className:"pointer-events-none select-none",fill:"#ffffff",children:[" ",D.length>14?D.substring(0,12)+"...":D]}),l.jsx("circle",{cx:Q.width,cy:Q.height/2,r:We,fill:"#3b82f6",stroke:"#1e40af",strokeWidth:"1",className:"cursor-crosshair hover:opacity-90 transition-opacity",onMouseDown:Pt=>On(z.id,Pt)}),l.jsx("circle",{cx:"0",cy:Q.height/2,r:We,fill:_e===z.id&&ge?"#10b981":"#6b7280",stroke:_e===z.id&&ge?"#059669":"#4b5563",strokeWidth:"2",className:"cursor-crosshair transition-all",onMouseUp:()=>ge&&J(z.id),onMouseEnter:()=>{ge&&Qe(z.id)}})]},z.id)})]})]})})}),l.jsx("div",{className:"p-4 border-t border-border bg-bg-light text-xs text-fg-secondary space-y-2",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-fg-primary mb-1",children:"Map Controls"}),l.jsxs("ul",{className:"space-y-0.5",children:[l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Left Drag:"})," Move nodes"]}),l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Space + Drag:"})," Pan canvas"]}),l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Middle Click + Drag:"})," Pan canvas"]}),l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Scroll:"})," Zoom in/out"]})]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-fg-primary mb-1",children:"Wire Controls"}),l.jsxs("ul",{className:"space-y-0.5",children:[l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Blue Circle:"})," Start connection"]}),l.jsxs("li",{children:[l.jsx("span",{className:"font-mono",children:"Drag to Node:"})," Create relationship"]})]})]})]})})]})}function Av({sessionId:o,nodes:s={},onNodeSelect:i,activeTab:u="velocity",onBlockingCountsChange:f,onBlockingDirtyChange:h,blockingFitToViewSignal:x,blockingRefreshSignal:w,blockingViewConfig:E,templateSchema:y}){const[S,b]=m.useState(null);return m.useEffect(()=>{i?.(S)},[S,i]),l.jsx("div",{className:"flex flex-col h-full bg-bg-dark text-fg-primary",children:l.jsx("div",{className:"flex-1 overflow-hidden",children:u==="velocity"?l.jsx(Ev,{sessionId:o||null,nodes:s,onNodeSelect:b}):l.jsx(kv,{sessionId:o||null,nodes:s,onNodeSelect:b,onCountsChange:f,onDirtyChange:h,fitToViewSignal:x,refreshSignal:w,blockingViewConfig:E,templateSchema:y})})})}class Dv extends Nl.Component{constructor(s){super(s),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,i){this.setState({errorInfo:i})}render(){return this.state.hasError?l.jsx("div",{className:"p-4 bg-status-danger/10 border border-status-danger rounded m-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"text-status-danger text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h2",{className:"text-lg font-display text-status-danger mb-2",children:"Application Error"}),l.jsx("p",{className:"text-sm text-fg-secondary mb-3",children:"An error occurred while rendering this component. This might be due to:"}),l.jsxs("ul",{className:"text-sm text-fg-secondary list-disc list-inside space-y-1 mb-4",children:[l.jsx("li",{children:"Invalid or corrupted template data"}),l.jsx("li",{children:"Missing required fields in the data"}),l.jsx("li",{children:"Incompatible template version"}),l.jsx("li",{children:"Network connection issues"})]}),l.jsxs("details",{className:"text-xs bg-bg-dark rounded p-2 mt-2 mb-4",children:[l.jsx("summary",{className:"cursor-pointer text-fg-primary font-semibold mb-2",children:"Error Details"}),l.jsxs("div",{className:"font-mono text-status-danger whitespace-pre-wrap text-xs",children:[l.jsx("strong",{children:"Error:"})," ",String(this.state.error?.message||this.state.error),this.state.errorInfo&&l.jsxs(l.Fragment,{children:[`

Component Stack:
`,this.state.errorInfo.componentStack]})]})]}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-accent-primary text-bg-dark rounded hover:bg-accent-primary/80 transition-colors text-sm font-semibold",children:"Reload Application"})]})]})}):this.props.children}}const Fm=o=>{let s;const i=new Set,u=(y,S)=>{const b=typeof y=="function"?y(s):y;if(!Object.is(b,s)){const G=s;s=S??(typeof b!="object"||b===null)?b:Object.assign({},s,b),i.forEach(L=>L(s,G))}},f=()=>s,w={setState:u,getState:f,getInitialState:()=>E,subscribe:y=>(i.add(y),()=>i.delete(y))},E=s=o(u,f,w);return w},Ov=(o=>o?Fm(o):Fm),zv=o=>o;function Mv(o,s=zv){const i=Nl.useSyncExternalStore(o.subscribe,Nl.useCallback(()=>s(o.getState()),[o,s]),Nl.useCallback(()=>s(o.getInitialState()),[o,s]));return Nl.useDebugValue(i),i}const Zm=o=>{const s=Ov(o),i=u=>Mv(s,u);return Object.assign(i,s),i},Vu=(o=>o?Zm(o):Zm),kp=Vu((o,s)=>({currentGraph:null,selectedNodeId:null,nodes:{},clipboard:null,setCurrentGraph:i=>{const u=i?.nodes?i.nodes.reduce((f,h)=>({...f,[h.id]:h}),{}):{};o({currentGraph:i||null,nodes:u})},clearGraph:()=>o({currentGraph:null,selectedNodeId:null,nodes:{}}),selectNode:i=>o({selectedNodeId:i}),deselectNode:()=>o({selectedNodeId:null}),updateNode:(i,u)=>o(f=>({nodes:{...f.nodes,[i]:u}})),addNode:i=>o(u=>({nodes:{...u.nodes,[i.id]:i}})),removeNode:i=>o(u=>{const f={...u.nodes};return delete f[i],{nodes:f,selectedNodeId:u.selectedNodeId===i?null:u.selectedNodeId}}),copyNode:i=>{const u=s().nodes[i];u&&o({clipboard:{...u}})},cutNode:i=>{const u=s().nodes[i];u&&(o({clipboard:{...u}}),s().removeNode(i))},pasteNode:()=>{const i=s().clipboard;if(i){const u={...i,id:`${i.id}_copy_${Date.now()}`};return s().addNode(u),u}return null},clearClipboard:()=>o({clipboard:null})}));Vu(o=>({theme:"dark",sidebarOpen:!0,inspectorOpen:!0,searchOpen:!1,setTheme:s=>o({theme:s}),toggleSidebar:()=>o(s=>({sidebarOpen:!s.sidebarOpen})),toggleInspector:()=>o(s=>({inspectorOpen:!s.inspectorOpen})),toggleSearch:()=>o(s=>({searchOpen:!s.searchOpen})),setSidebarOpen:s=>o({sidebarOpen:s}),setInspectorOpen:s=>o({inspectorOpen:s}),setSearchOpen:s=>o({searchOpen:s})}));Vu(o=>({sessionId:localStorage.getItem("sessionId"),isAuthenticated:!!localStorage.getItem("sessionId"),user:null,setSession:s=>{localStorage.setItem("sessionId",s),o({sessionId:s,isAuthenticated:!0})},clearSession:()=>{localStorage.removeItem("sessionId"),o({sessionId:null,isAuthenticated:!1,user:null})},setUser:s=>o({user:s})}));function Rv(){const{addNode:o,updateNode:s,removeNode:i}=kp(),u=m.useCallback(L=>{console.log("[GraphSync] Node created:",L),L.node&&o(L.node)},[o]),f=m.useCallback(L=>{console.log("[GraphSync] Node updated:",L),L.id&&L.node&&s(L.id,L.node)},[s]),h=m.useCallback(L=>{console.log("[GraphSync] Node deleted:",L),L.id&&i(L.id)},[i]),x=m.useCallback(()=>{console.log("[GraphSync] WebSocket connected")},[]),w=m.useCallback(()=>{console.log("[GraphSync] WebSocket disconnected")},[]),{connected:E,emit:y}=Tp({onNodeCreated:u,onNodeUpdated:f,onNodeDeleted:h,onConnect:x,onDisconnect:w});m.useEffect(()=>{if(!E)return;const L=localStorage.getItem("talus_tally_session_id");L&&y("join_session",{session_id:L})},[E,y]);const S=m.useCallback(L=>{y("node:create",{node:L})},[y]),b=m.useCallback((L,ce)=>{y("node:update",{id:L,node:ce})},[y]),G=m.useCallback(L=>{y("node:delete",{id:L})},[y]);return{connected:E,broadcastNodeCreated:S,broadcastNodeUpdated:b,broadcastNodeDeleted:G}}function Et(o){const s=performance.now();console.log("[normalizeGraph] START");try{if(!o)return console.log("[normalizeGraph] No graph data, returning default"),{id:"default",nodes:[],edges:[]};const i=o.graph??o;if(i&&Array.isArray(i.nodes))return console.log("[normalizeGraph] Graph already flat, returning as-is"),{id:i.id||"default",nodes:i.nodes,edges:i.edges||[]};if(i&&Array.isArray(i.roots)){console.log("[normalizeGraph] Processing hierarchical graph, roots:",i.roots.length);const u=[],f=new Set,h=100;let x=0;const w=(y,S=[])=>{if(x++,x>1e4)return console.error("[normalizeGraph] EMERGENCY STOP: processed >10000 nodes, likely infinite loop!"),null;if(x%10===0&&console.log(`[normalizeGraph] Progress: ${x} nodes processed...`),S.length>=h)return console.error("[normalizeGraph] Max recursion depth exceeded!",{nodeId:y.id,depth:S.length}),null;const b=y.id;if(!b)return console.error("[normalizeGraph] Node missing id field:",y),null;if(f.has(b)){console.warn("[normalizeGraph] Cycle detected! Node already visited:",b);const L=u.find(ce=>ce.id===b);return L||null}if(S.includes(b)){console.error("[normalizeGraph] Direct cycle detected! Node:",b);const L=u.find(ce=>ce.id===b);return L||null}f.add(b),console.log(`[normalizeGraph] Node ${b} (${y.blueprint_type_id}):`,{name:y.name,properties:y.properties,allKeys:Object.keys(y)});const G={id:b,type:y.blueprint_type_id||"unknown",properties:{name:y.name||"Unnamed",...y.properties},children:[],indicator_id:y.indicator_id,indicator_set:y.indicator_set,icon_id:y.icon_id,schema_shape:y.schema_shape,schema_color:y.schema_color,allowed_children:y.allowed_children};return console.log(`[normalizeGraph] Normalized node ${b}:`,{properties:G.properties,propertyCount:Object.keys(G.properties).length}),u.push(G),y.children&&Array.isArray(y.children)&&(G.children=y.children.map(L=>{const ce=w(L,[...S,b]);return ce?ce.id:null}).filter(L=>L!==null)),G};for(const y of i.roots||[])console.log("[normalizeGraph] Processing root node:",y.id||y.blueprint_type_id),w(y)||console.error("[normalizeGraph] Failed to process root node:",y);const E=performance.now()-s;return console.log(`[normalizeGraph] COMPLETE: ${u.length} nodes in ${E.toFixed(2)}ms`),{id:"default",nodes:u,edges:[]}}return console.log("[normalizeGraph] No valid graph structure found, returning empty"),{id:"default",nodes:[],edges:[]}}catch(i){const u=performance.now()-s;return console.error(`[normalizeGraph] Fatal error after ${u.toFixed(2)}ms:`,i),{id:"default",nodes:[],edges:[]}}}function Br(o){const s=[];return!o||typeof o!="object"?{isValid:!1,errors:["Template schema is null or not an object"]}:(o.id||s.push("Missing required field: id"),o.name||s.push("Missing required field: name"),o.node_types?Array.isArray(o.node_types)?o.node_types.length===0?s.push("node_types cannot be empty"):o.node_types.forEach((i,u)=>{const f=`node_types[${u}]`;if(!i||typeof i!="object"){s.push(`${f}: must be an object`);return}i.id||s.push(`${f}: missing required field 'id'`),i.name||s.push(`${f}: missing required field 'name'`),i.properties&&(Array.isArray(i.properties)?i.properties.forEach((h,x)=>{const w=`${f}.properties[${x}]`;if(!h||typeof h!="object"){s.push(`${w}: must be an object`);return}if(h.id||s.push(`${w}: missing required field 'id'`),h.name||s.push(`${w}: missing required field 'name'`),h.type==="select")if(!h.options)s.push(`${w}: select type requires 'options' field`);else if(!Array.isArray(h.options))s.push(`${w}.options: must be an array`);else if(h.options.length===0)s.push(`${w}.options: cannot be empty for select type`);else{const E=new Set;h.options.forEach((y,S)=>{const b=`${w}.options[${S}]`;typeof y=="string"?(E.has(y)&&s.push(`${b}: duplicate option value '${y}'`),E.add(y)):y&&typeof y=="object"?y.name?(E.has(y.name)&&s.push(`${b}: duplicate option name '${y.name}'`),E.add(y.name)):s.push(`${b}: missing required field 'name'`):s.push(`${b}: must be a string or object, got ${typeof y}`)})}}):s.push(`${f}.properties: must be an array`))}):s.push("node_types must be an array"):s.push("Missing required field: node_types"),{isValid:s.length===0,errors:s})}function qr(o){return!o||!o.options||!Array.isArray(o.options)?(console.warn("Property has no valid options array:",o),[]):o.options.map((s,i)=>{if(typeof s=="string")return{value:s,label:s};if(s&&typeof s=="object"){const u=s.name||s.label||`Option ${i+1}`;return{value:s.id||u,label:u}}return console.warn("Malformed option:",s),{value:`option-${i}`,label:`Option ${i+1}`}})}try{(async()=>{let s=0;for(;!window.__TAURI__&&s<50;)await new Promise(i=>setTimeout(i,50)),s++;window.__TAURI__&&console.log("[App] Tauri context initialized successfully")})().catch(()=>{console.log("[App] Not running in Tauri environment")})}catch{console.log("[App] Tauri initialization check completed")}const Km="talus-tally:recent-files";function Uv(){const[o,s]=m.useState(null),[i,u]=m.useState(null),[f,h]=m.useState(!0),[x,w]=m.useState("graph"),[E,y]=m.useState("velocity"),[S,b]=m.useState(null),[G,L]=m.useState(!1),ce=m.useRef(!1),ie=m.useRef(null),ve=m.useRef(null),ge=m.useRef(null),[Ee,_e]=m.useState([]),[W,Te]=m.useState(null),[fe,oe]=m.useState(!1),[Ce,Re]=m.useState(!1),[Oe,$]=m.useState(!1),[ye,ee]=m.useState(!1),[Se,B]=m.useState(!1),[v,M]=m.useState(!1),[Z,j]=m.useState(!1),[se,g]=m.useState(!1),[T,A]=m.useState(!1),[X,me]=m.useState(!1),[we,qe]=m.useState(!1),[te,de]=m.useState(!1),[Xe,Je]=m.useState(null),Ie=m.useRef(null),[vt,Ot]=m.useState(null),[zt,wt]=m.useState(void 0),[Mt,Xt]=m.useState(null),[Qt,Ut]=m.useState("asset_reference"),[un,On]=m.useState(null),[zn,Ht]=m.useState([]),[Qe,Ft]=m.useState(null),[J,he]=m.useState([]),[ke,De]=m.useState([]),[Me,Ge]=m.useState([]),[z,U]=m.useState(null),[C,D]=m.useState(0),[Q,ue]=m.useState(0),[be,je]=m.useState(0),[Ne,Le]=m.useState(0),[He,lt]=m.useState(null),[ct,Ye]=m.useState(null),[Tt,jt]=m.useState(0),[Lt,hn]=m.useState(0),[ha,$a]=m.useState([]),[bn,Mn]=m.useState(()=>{try{const _=localStorage.getItem(Km);if(_){const R=JSON.parse(_);if(Array.isArray(R))return R.filter(O=>typeof O=="string")}}catch(_){console.warn("Failed to restore recent files list:",_)}return[]});m.useRef(0);const[Vn,Gn]=m.useState(!1),[xn,ut]=m.useState(()=>{try{const _=localStorage.getItem("talus-tally:expandedMap");if(_)return JSON.parse(_)}catch(_){console.warn("Failed to restore expanded state:",_)}return{}}),[St,Vt]=m.useState(null),[vn,aa]=m.useState(!0),Tl=m.useRef(Date.now()),kl=15e3,{nodes:We,currentGraph:Pt,setCurrentGraph:it}=kp();Rv(),m.useEffect(()=>{ce.current=G},[G]),m.useEffect(()=>{ie.current=S},[S]),m.useEffect(()=>{ve.current=Pt||null},[Pt]),m.useEffect(()=>{ge.current=ct},[ct]),m.useEffect(()=>{const _=localStorage.getItem("indicator_size");if(_){const R=parseInt(_,10);isNaN(R)||(document.documentElement.style.setProperty("--indicator-size",`${R}px`),console.log(" Restored indicator size:",R+"px"))}},[]),m.useEffect(()=>{try{localStorage.setItem("talus-tally:expandedMap",JSON.stringify(xn))}catch(_){console.warn("Failed to persist expanded state:",_)}},[xn]),m.useEffect(()=>{try{localStorage.setItem(Km,JSON.stringify(bn))}catch(_){console.warn("Failed to persist recent files list:",_)}},[bn]),m.useEffect(()=>{(async()=>{try{const O=Tl.current,H=kl;let I=!1;for(;!I&&Date.now()-O<H;){try{if((await fetch(`${Dn}/api/v1/health`,{method:"GET",signal:AbortSignal.timeout(1e3)})).ok){I=!0,console.log(" Backend is ready");break}}catch{}await new Promise(Be=>setTimeout(Be,300))}if(aa(!1),!I){const Be="Cannot connect to backend. Please ensure the server is running.";console.error(Be),Vt(Be),Gn(!0);return}Vt(null);const re=localStorage.getItem("talus_tally_session_id");if(re){console.log("Found saved session ID:",re);try{const Be=await Ae.getSessionInfo(re);if(Be&&Be.session_id){if(console.log(" Restored session:",re),b(re),Be.has_project){console.log(" Session has existing project, restoring graph...");try{const ft=Be.template_id||localStorage.getItem("talus_tally_template_id");if(ft)try{const jn=await Ae.getTemplateSchema(ft),Nn=Br(jn);if(!Nn.isValid)throw console.error("Template validation failed:",Nn.errors),new Error(`Template validation failed:
${Nn.errors.join(`
`)}`);Ft(jn),Ye(ft),console.log(" Template schema restored:",ft)}catch(jn){console.warn("Failed to restore template schema:",jn),alert(`Template Error: ${jn instanceof Error?jn.message:String(jn)}

The template may be corrupted. Please start a new project.`)}const ga=await Ae.getSessionGraph(re);console.log("[DEBUG] Raw graphData from backend:",JSON.stringify(ga,null,2));const Sn=Et(ga.graph);console.log("[DEBUG] Normalized graph nodes:",Sn.nodes),it(Sn),console.log(" Graph restored with",Object.keys(Sn.nodes).length,"nodes")}catch(ft){console.warn("Failed to restore graph, starting fresh:",ft),it({id:"default",nodes:[],edges:[]})}}Gn(!0);return}}catch(Be){console.warn("Saved session invalid, creating new session:",Be),localStorage.removeItem("talus_tally_session_id"),localStorage.removeItem("sessionId")}}const ne=await Ae.createSession(),xe=ne.session_id||ne.id||"unknown";b(xe),localStorage.setItem("talus_tally_session_id",xe),localStorage.setItem("sessionId",xe),console.log(" Session created:",xe),Gn(!0),aa(!1)}catch(R){aa(!1);const O=`Failed to initialize app: ${R instanceof Error?R.message:String(R)}`;console.error("",O),Vt("Failed to initialize app. Please check the backend connection."),Gn(!0)}})()},[]),m.useEffect(()=>{},[]);const Yn=m.useCallback(_=>{const R=Object.values(_);if(R.length===0)return[];const O=Qe?.node_types?.reduce((ne,xe)=>(xe.id&&xe.icon&&(ne[xe.id]=xe.icon),ne),{})||{},H=ne=>ne?ne.allowed_children!==void 0&&Array.isArray(ne.allowed_children)?ne.allowed_children:Qe?.node_types?Qe.node_types.find(Be=>Be.id===ne.type)?.allowed_children||[]:[]:[],I=(ne,xe,Be)=>{const ft=O[ne.type],ga=ne.icon_id??ft??void 0,Sn=H(ne);return{id:ne.id,name:ne.properties?.name||ne.type,type:ne.type||"project",indicator_id:ne.indicator_id??void 0,indicator_set:ne.indicator_set??void 0,icon_id:ga,statusIndicatorSvg:ne.statusIndicatorSvg??void 0,statusText:ne.statusText??void 0,parent_id:Be??void 0,selected:ne.id===o,allowed_children:Sn,children:ne.children?.map(jn=>{const Nn=xe[jn];return Nn?I(Nn,xe,ne.id):{id:jn,name:"Unknown",type:"unknown",allowed_children:[],children:[],selected:!1,parent_id:ne.id}})||[]}};return R.filter(ne=>!R.some(xe=>xe.children?.includes(ne.id))).map(ne=>I(ne,_,null))},[Qe,o]);m.useRef(!0),m.useRef({}),m.useEffect(()=>{if(!We||Object.keys(We).length===0){_e([]);return}const _=Yn(We);_e(_)},[We,Yn]),m.useEffect(()=>{o&&We[o]?Te(We[o]):Te(null)},[o,We]);const nn=m.useCallback(async()=>{const _=x==="graph"?o:i;if(!_||!S){he([]),De([]);return}try{const O=(await Ae.getBlockingGraph(S)).relationships||[];Ge(O);const H=O.filter(re=>re.blockedNodeId===_).map(re=>re.blockingNodeId),I=O.filter(re=>re.blockingNodeId===_).map(re=>re.blockedNodeId);he(H),De(I)}catch(R){console.error("Failed to fetch blocking relationships:",R)}},[x,o,S,i]);m.useEffect(()=>{nn()},[nn]);const Xn=m.useCallback(async()=>{const _=x==="graph"?o:i;if(!_||!S){U(null);return}try{const R=await Ae.getNodeVelocity(S,_);U(R)}catch(R){console.error("Failed to fetch node velocity:",R),U(null)}},[x,o,S,i]);m.useEffect(()=>{Xn()},[Xn]);const sa=m.useCallback(()=>{if(!W||!Qe)return[];const _=Qe.node_types.find(H=>H.id===W.type);if(!_)return[];console.log("[App] Node type schema properties:",_.properties?.map(H=>({id:H.id,type:H.type,markup_profile:H.markup_profile})));const R={id:"name",name:"Name",type:"text",value:W.properties?.name||"",required:!0},O=_.properties.filter(H=>H.id!=="name").map(H=>{let I=W.properties?.[H.id];I===void 0&&H.id==="name"&&(I=W.properties?.name||"");let re="text";H.type==="number"?re="number":H.type==="select"?re="select":H.type==="textarea"?re="textarea":H.type==="currency"?re="currency":H.type==="date"?re="date":H.type==="checkbox"?re="checkbox":H.type==="editor"&&(re="editor");let ne;H.type==="select"&&(ne=qr(H));let xe,Be;return H.type==="editor"&&(H.markup_tokens&&(xe=H.markup_tokens),H.markup_profile&&(Be=H.markup_profile)),H.id==="description"&&console.log("[App] Building description property:",{propId:H.id,propType:re,hasMarkupProfile:!!Be,markupProfile:Be,rawProp:H.markup_profile}),{id:H.id,name:H.name,type:re,value:I??"",options:ne,required:H.required,markupTokens:xe,markupProfile:Be}});return[R,...O]},[W,Qe]),kt=m.useCallback(()=>{if(!W||!Qe)return null;const _=W.properties?.asset_id;if(!_)return null;const R=We[_];if(!R)return null;const O=Qe?.node_types?.find(I=>I.id===R.type);if(!O)return null;const H=(O.properties||[]).map(I=>{let re=R.properties?.[I.id];re===void 0&&I.id==="name"&&(re=R.properties?.name||"");let ne="text";I.type==="number"?ne="number":I.type==="select"?ne="select":I.type==="textarea"?ne="textarea":I.type==="currency"?ne="currency":I.type==="date"?ne="date":I.type==="checkbox"?ne="checkbox":I.type==="editor"&&(ne="editor");let xe;I.type==="select"&&(xe=qr(I));let Be,ft;return I.type==="editor"&&(I.markup_tokens&&(Be=I.markup_tokens),I.markup_profile&&(ft=I.markup_profile)),{id:I.id,name:I.name,type:ne,value:re??"",options:xe,required:I.required,markupTokens:Be,markupProfile:ft}});return{nodeId:R.id,nodeType:R.type,name:R.properties?.name||"Asset",properties:H}},[W,Qe,We]);m.useMemo(()=>sa(),[sa]),m.useMemo(()=>kt(),[kt]);const la=m.useMemo(()=>x==="graph"?o:i,[x,o,i]),Bt=m.useMemo(()=>la?We[la]:null,[la,We]),ia=m.useMemo(()=>{if(!Bt||!Qe)return[];const _=Qe.node_types.find(H=>H.id===Bt.type);if(!_)return[];const R={id:"name",name:"Name",type:"text",value:Bt.properties?.name||"",required:!0},O=_.properties.filter(H=>H.id!=="name").map(H=>{let I=Bt.properties?.[H.id];I===void 0&&H.id==="name"&&(I=Bt.properties?.name||"");let re="text";H.type==="number"?re="number":H.type==="select"?re="select":H.type==="textarea"?re="textarea":H.type==="currency"?re="currency":H.type==="date"?re="date":H.type==="checkbox"?re="checkbox":H.type==="editor"&&(re="editor");let ne;H.type==="select"&&(ne=qr(H));let xe,Be;return H.type==="editor"&&(H.markup_tokens&&(xe=H.markup_tokens),H.markup_profile&&(Be=H.markup_profile)),{id:H.id,name:H.name,type:re,value:I??"",options:ne,required:H.required,markupTokens:xe,markupProfile:Be}});return[R,...O]},[Bt,Qe]),ma=m.useMemo(()=>{if(!Bt||!Qe)return null;const _=Bt.properties?.asset_id;if(!_)return null;const R=We[_];if(!R)return null;const O=Qe?.node_types?.find(I=>I.id===R.type);if(!O)return null;const H=(O.properties||[]).map(I=>{let re=R.properties?.[I.id];re===void 0&&I.id==="name"&&(re=R.properties?.name||"");let ne="text";I.type==="number"?ne="number":I.type==="select"?ne="select":I.type==="textarea"?ne="textarea":I.type==="currency"?ne="currency":I.type==="date"?ne="date":I.type==="checkbox"?ne="checkbox":I.type==="editor"&&(ne="editor");let xe;I.type==="select"&&(xe=qr(I));let Be,ft;return I.type==="editor"&&(I.markup_tokens&&(Be=I.markup_tokens),I.markup_profile&&(ft=I.markup_profile)),{id:I.id,name:I.name,type:ne,value:re??"",options:xe,required:I.required,markupTokens:Be,markupProfile:ft}});return{nodeId:R.id,nodeType:R.type,name:R.properties?.name||"Asset",properties:H}},[Bt,Qe,We]),ja=m.useCallback(async()=>{if(ie.current)try{return await Ae.getSessionInfo(ie.current),console.log(`[Session] Using existing sessionId: ${ie.current}`),ie.current}catch(O){console.warn("[Session] Existing session invalid, creating new one:",O)}console.log("[Session] Creating new session...");const _=await Ae.createSession(),R=_.session_id||_.id||"unknown";return console.log(`[Session] Created new session: ${R}`),b(R),localStorage.setItem("talus_tally_session_id",R),localStorage.setItem("sessionId",R),R},[]),Ha=m.useCallback(async _=>{if(!ve.current){console.warn("[Recovery] No graph to restore (currentGraphRef is null)");return}console.log(`[Recovery] Restoring graph to new session ${_}...`);try{const R=await Ae.loadGraphIntoSession(_,ve.current,ge.current);return console.log(`[Recovery] Graph restored successfully to session ${_}`),R}catch(R){const O=R instanceof Error?R.message:String(R);throw console.error(`[Recovery] Failed to restore graph to session ${_}: ${O}`),R}},[]),an=m.useCallback(async(_,R)=>{const O=await ja();try{return console.log(`[Command] Executing ${_} with session ${O}...`),await Ae.executeCommand(O,_,R)}catch(H){const I=H instanceof Error?H.message:String(H);if(console.log(`[Command] Got error: ${I}`),I.includes("Session not found")||I.includes("INVALID_SESSION")){console.log("[Recovery] Detected session lost, starting recovery...");try{const re=await Ae.createSession(),ne=re.session_id||re.id||"unknown";return console.log(`[Recovery] Created new session: ${ne}`),b(ne),localStorage.setItem("talus_tally_session_id",ne),localStorage.setItem("sessionId",ne),await Ha(ne),console.log(`[Recovery] Retrying command ${_} with new session...`),await Ae.executeCommand(ne,_,R)}catch(re){const ne=re instanceof Error?re.message:String(re);throw console.error(`[Recovery] Recovery failed: ${ne}`),re}}throw H}},[ja,Ha]),ps=m.useCallback(async()=>{try{if(G&&S){if(!window.confirm("You have unsaved changes. Do you want to discard them and create a new project?"))return;try{await Ae.resetDirtyState(S),L(!1)}catch(R){console.warn("Failed to reset dirty state:",R),L(!1)}}if(zn.length===0){const _=await Ae.listTemplates();if(console.log("Loaded templates:",_),Ht(_),_.length===0){alert("No templates available. Please add templates to the backend.");return}}oe(!0)}catch(_){console.error(" Failed to load templates:",_),alert(`Failed to load templates. Error: ${_ instanceof Error?_.message:String(_)}`)}},[zn.length,G,S]),gs=m.useCallback(async(_,R)=>{try{console.log("Creating project with template:",_,"and name:",R);const O=await Ae.createProject(_,R);if(console.log(" API Response:",O),console.log(" API Response keys:",Object.keys(O)),"error"in O&&O.error){const re=O.error.message||O.error.code||"Unknown error";console.error(" API Error:",re),alert(`Failed to create project: ${re}`);return}console.log(" API Response.graph:",O.graph);const H=Et(O.graph);console.log("Setting graph with nodes:",H.nodes?.length||0),console.log("Final graph structure:",H);try{const re=await Ae.getTemplateSchema(_),ne=Br(re);if(!ne.isValid)throw console.error("Template validation failed:",ne.errors),new Error(`Template validation failed:
${ne.errors.join(`
`)}`);Ft(re),localStorage.setItem("talus_tally_template_id",_),console.log(" Template schema loaded:",re)}catch(re){throw console.error(" Failed to load template schema:",re),alert(`Template Error: ${re instanceof Error?re.message:String(re)}

The template may be invalid. Please check the template file.`),Ft(null),re}const I=O.session_id||"unknown";b(I),Ye(_),lt(null),localStorage.setItem("talus_tally_session_id",I),localStorage.setItem("sessionId",I),it(H),oe(!1),L(!1),console.log(" Project created with session:",I)}catch(O){console.error(" Failed to create project:",O),alert(`Failed to create project. Error: ${O instanceof Error?O.message:String(O)}`)}},[Et,it]),pa=m.useCallback(_=>{if(!_)return;const R=String(_).trim();R&&Mn(O=>{const H=O.filter(I=>I!==R);return[R,...H].slice(0,5)})},[Mn]),mn=m.useCallback(async()=>{if(console.log("[DEBUG] handleSave called. lastFilePath:",He),!S)return alert("No active session"),!1;try{const{isTauri:_}=await Rt(async()=>{const{isTauri:I}=await Promise.resolve().then(()=>qa);return{isTauri:I}},void 0);if(!_())return alert("Save is only available in the desktop app."),!1;const R=Pt||{id:"default",nodes:[],edges:[]};let O=Me;if(S)try{O=(await Ae.getBlockingGraph(S)).relationships||[]}catch(I){console.warn("Failed to refresh blocking relationships for save:",I)}const H=JSON.stringify({graph:R,template_id:ct,expanded_map:xn,blocking_relationships:O},null,2);if(He){console.log("[DEBUG] Saving to existing path:",He);const{writeTextFile:I}=await Rt(async()=>{const{writeTextFile:re}=await import("./index-CcyFo--U.js");return{writeTextFile:re}},[]);await I(He,H),pa(He)}else{console.log("[DEBUG] No lastFilePath, prompting for save location");const{save:I}=await Rt(async()=>{const{save:xe}=await import("./index-D1Z_VsQB.js");return{save:xe}},[]),re=await I({title:"Save Project",defaultPath:"talus-project.json",filters:[{name:"Talus Project",extensions:["json"]}]});if(!re)return!1;console.log("[DEBUG] User selected save path:",re),lt(re),pa(re);const{writeTextFile:ne}=await Rt(async()=>{const{writeTextFile:xe}=await import("./index-CcyFo--U.js");return{writeTextFile:xe}},[]);await ne(re,H)}return await Ae.saveSession(S),L(!1),console.log(" Project saved"),!0}catch(_){return console.error(" Save failed:",_),alert("Save failed."),!1}},[Pt,He,S,ct,xn,pa,Me]),dn=m.useCallback(async()=>{try{const{isTauri:_}=await Rt(async()=>{const{isTauri:xe}=await Promise.resolve().then(()=>qa);return{isTauri:xe}},void 0);if(!_())return alert("Save is only available in the desktop app."),!1;const R=Pt||{id:"default",nodes:[],edges:[]};let O=Me;if(S)try{O=(await Ae.getBlockingGraph(S)).relationships||[]}catch(xe){console.warn("Failed to refresh blocking relationships for save-as:",xe)}const H=JSON.stringify({graph:R,template_id:ct,expanded_map:xn,blocking_relationships:O},null,2),{save:I}=await Rt(async()=>{const{save:xe}=await import("./index-D1Z_VsQB.js");return{save:xe}},[]),re=await I({title:"Save Project As",defaultPath:"talus-project.json",filters:[{name:"Talus Project",extensions:["json"]}]});if(!re)return!1;lt(re);const{writeTextFile:ne}=await Rt(async()=>{const{writeTextFile:xe}=await import("./index-CcyFo--U.js");return{writeTextFile:xe}},[]);if(await ne(re,H),S)try{await Ae.saveSession(S),L(!1)}catch(xe){console.warn("Failed to mark session as clean (session may be stale):",xe)}return console.log(" Project saved"),!0}catch(_){return console.error(" Save As failed:",_),alert("Save failed."),!1}},[Pt,S,ct,xn,Me]),qs=m.useCallback(async _=>{console.log(" Opening recent file:",_);let R,O;try{const{readTextFile:xe}=await Rt(async()=>{const{readTextFile:Be}=await import("./index-CcyFo--U.js");return{readTextFile:Be}},[]);R=await xe(_)}catch(xe){const Be=xe instanceof Error?xe.message:String(xe);console.error(" Failed to read file:",xe),alert(`Cannot read file: ${Be}`);return}try{O=JSON.parse(R)}catch(xe){console.error(" File is not valid JSON:",xe),alert("File is not a valid Talus project (invalid JSON).");return}let H;try{H=Et(O.graph??O)}catch(xe){console.error(" Failed to normalize graph structure:",xe),alert("Project file has an invalid graph structure.");return}const I=O.template_id||null;let re=H,ne;if(S)try{await Ae.getSessionInfo(S),ne=S,console.log(`[File Open] Using existing session: ${ne}`)}catch(xe){console.warn("Existing session invalid, creating new one:",xe);const Be=await Ae.createSession();ne=Be.session_id||Be.id||"unknown",console.log(`[File Open] Created new session for file: ${ne}`),b(ne),localStorage.setItem("talus_tally_session_id",ne),localStorage.setItem("sessionId",ne)}else{const xe=await Ae.createSession();ne=xe.session_id||xe.id||"unknown",console.log(`[File Open] Created new session for file: ${ne}`),b(ne),localStorage.setItem("talus_tally_session_id",ne),localStorage.setItem("sessionId",ne)}try{console.log(`[File Open] Loading graph into session ${ne}...`);const xe=await Ae.loadGraphIntoSession(ne,H,I,O.blocking_relationships||[]);if(console.log(" Graph loaded into backend session"),re=Et(xe.graph??xe),Ye(I),I)try{const Be=await Ae.getTemplateSchema(I),ft=Br(Be);if(!ft.isValid)throw console.error("Template validation failed:",ft.errors),new Error(`Template validation failed:
${ft.errors.join(`
`)}`);Ft(Be),console.log(" Template schema loaded for:",I)}catch(Be){console.error(" Template schema error:",Be),alert(`Template Error: ${Be instanceof Error?Be.message:String(Be)}

The template may be invalid or corrupted.
The project will load but some features may not work correctly.`),Ft(null)}else console.info(" No template ID in project file, working with schema-less data"),Ft(null)}catch(xe){xe instanceof Error?xe.message:String(xe),console.error(" Failed to load graph into backend session:",xe),console.log("Continuing with local graph only - operations may fail later..."),alert("Warning: Could not sync project to backend. Edit operations may not work properly.")}it(re),lt(_),pa(_),console.log("[DEBUG] File opened and lastFilePath set to:",_),O.expanded_map&&typeof O.expanded_map=="object"&&(ut(O.expanded_map),console.log(" Restored tree expansion state")),console.log(" Project opened:",_)},[Et,it,S,b,ut,Ft,Ye,pa]),eo=m.useCallback(async()=>{try{const{isTauri:_}=await Rt(async()=>{const{isTauri:H}=await Promise.resolve().then(()=>qa);return{isTauri:H}},void 0);if(!_()){alert("Open is only available in the desktop app.");return}const{open:R}=await Rt(async()=>{const{open:H}=await import("./index-D1Z_VsQB.js");return{open:H}},[]),O=await R({title:"Open Project",multiple:!1,filters:[{name:"Talus Project",extensions:["json"]}]});if(!O||Array.isArray(O))return;console.log(" Opening file:",O),await qs(O)}catch(_){const R=_ instanceof Error?_.message:String(_);console.error(" Open failed:",_),alert(`Failed to open project: ${R}`)}},[qs]),ys=m.useCallback(async()=>{if(S)try{const _=await Ae.undo(S);console.log(" Undo executed:",_);const R=Et(_.graph??_);it(R),await nn(),Le(O=>O+1)}catch(_){console.error(" Undo failed:",_)}},[nn,Et,S,it]),$s=m.useCallback(async()=>{if(S)try{const _=await Ae.redo(S);console.log(" Redo executed:",_);const R=Et(_.graph??_);it(R),await nn(),Le(O=>O+1)}catch(_){console.error(" Redo failed:",_)}},[nn,Et,S,it]),Va=m.useCallback(()=>{h(_=>!_)},[]),to=m.useCallback(async _=>{if(S)try{for(const R of ke)await Ae.updateBlockingRelationship(S,R,null);Le(R=>R+1),await nn(),await Xn(),L(!0),console.log(` Cleared all blocks for node ${_}`)}catch(R){console.error("Failed to clear blocking relationships:",R),alert("Failed to clear blocking relationships")}},[ke,nn,Xn,S]),wn=m.useCallback(()=>{jt(_=>_+1)},[]),Al=m.useCallback(()=>{hn(_=>_+1)},[]),Ci=m.useCallback(()=>{je(_=>_+1)},[]),Dl=m.useCallback((_,R)=>{D(_),ue(R)},[]),Ga=m.useCallback(async()=>{const _=ce.current;if(console.log("handleCloseApp called, isDirty:",_),_)Ie.current=async()=>{console.log("[CLOSE] Proceeding with force close...");try{const{invoke:R}=await Rt(async()=>{const{invoke:O}=await Promise.resolve().then(()=>qa);return{invoke:O}},void 0);console.log("[CLOSE] Calling force_close_window command"),await R("force_close_window"),console.log("[CLOSE] force_close_window returned");return}catch(R){console.error("[CLOSE] Tauri force close failed:",R),console.log("[CLOSE] Trying fallback window.close()"),window.close?.()}},console.log("Opening save confirmation dialog"),me(!0);else{console.log("No unsaved changes, force closing immediately");try{const{invoke:R}=await Rt(async()=>{const{invoke:O}=await Promise.resolve().then(()=>qa);return{invoke:O}},void 0);console.log("[CLOSE] Calling force_close_window for clean state"),await R("force_close_window")}catch(R){console.error("[CLOSE] Clean force close failed:",R),window.close?.()}}},[]),[Ol,Hs]=m.useState(void 0),Ya=m.useCallback((_,R,O,H)=>{Ot(_),Hs(H);const I=O||"Child";wt(R?`Add ${I} to ${R}`:`Add ${I}`),Re(!0),ut(re=>({...re,[_]:!0}))},[]),zl=m.useCallback(()=>{if(!Qe)return["part_asset","tool_asset","vehicle_asset","camera_gear_asset"];const _=new Set;return Qe.node_types.filter(O=>O.id.endsWith("_category")).forEach(O=>{O.allowed_children?.forEach(H=>_.add(H))}),Qe.node_types.find(O=>O.id==="vehicles")?.allowed_children?.forEach(O=>_.add(O)),_.size===0&&Qe.node_types.map(O=>O.id).filter(O=>O.endsWith("_asset")).forEach(O=>_.add(O)),Array.from(_)},[Qe]),Ti=m.useCallback(_=>{let R;if(_&&Qe){const O=Qe.node_types.find(H=>H.id===_);O?.allowed_asset_types&&O.allowed_asset_types.length>0?R=new Set(O.allowed_asset_types):R=new Set(zl())}else R=new Set(zl());return Object.values(We).filter(O=>R.has(O.type)).map(O=>({id:O.id,name:O.properties?.name||O.type,type:O.type,typeLabel:Qe?.node_types.find(H=>H.id===O.type)?.name||O.type})).sort((O,H)=>O.name.localeCompare(H.name))},[zl,We,Qe]),ki=m.useCallback(()=>{const _=[{id:"parts_inventory",label:"Parts Inventory"},{id:"tools_inventory",label:"Tools Inventory"},{id:"vehicles",label:"Vehicles"}];if(!Qe)return _;const R=Qe.node_types.find(ne=>ne.id==="project_root"),O=Qe.node_types.find(ne=>ne.id==="inventory_root"),H=[...R?.allowed_children||[],...O?.allowed_children||[]],I=ne=>ne.endsWith("_inventory")||ne==="vehicles",re=H.filter(I).map(ne=>({id:ne,label:Qe.node_types.find(xe=>xe.id===ne)?.name||ne}));return re.length>0?re:_},[Qe]),Ml=(_,R)=>{const O=new Set;function H(I){if(O.has(I))return;O.add(I);const re=We[I];re&&Array.isArray(re.children)&&re.children.forEach(H)}return H(_),!1},no=m.useCallback(_=>{if(!vt){alert("No parent selected");return}const R=We[vt];if(!R){alert("Parent node not found");return}let O=Ol||"task";Ml(vt),console.log(`Creating child node: type="${O}", parent type="${R.type}"`),an("CreateNode",{blueprint_type_id:O,name:_,parent_id:vt}).then(H=>{const I=Et(H.graph??H);it(I),ut(re=>({...re,[vt]:!0})),Re(!1),Ot(null),Hs(void 0),L(H.is_dirty??!0)}).catch(H=>{console.error("Failed to add child:",H),alert("Failed to add child node")})},[vt,Ol,Et,an,it,We]),ao=m.useCallback(async _=>{if(!Mt){alert("No parent selected");return}const R=We[_];if(!R){alert("Asset not found");return}try{const O=await ja(),H=await an("CreateNode",{blueprint_type_id:Qt,name:R.properties?.name||"Asset Reference",parent_id:Mt}),I=Et(H.graph??H),re=I.nodes.find(xe=>xe.type===Qt&&xe.properties?.name===(R.properties?.name||"Asset Reference"))?.id;re&&await an("UpdateProperty",{node_id:re,property_id:"asset_id",old_value:null,new_value:_});const ne=re?Et((await Ae.getSessionGraph(O)).graph):I;it(ne),ut(xe=>({...xe,[Mt]:!0})),$(!1),Xt(null),Ut("asset_reference"),L(!0)}catch(O){console.error("Failed to add asset reference:",O),alert("Failed to add asset reference")}},[Mt,Qt,ja,Et,an,it,We]),Vs=m.useCallback(async(_,R)=>{if(!un){alert("No parent selected");return}try{const O=await an("CreateNode",{blueprint_type_id:_,name:R,parent_id:un}),H=Et(O.graph??O);it(H),ut(I=>({...I,[un]:!0})),ee(!1),On(null),L(O.is_dirty??!0)}catch(O){console.error("Failed to add asset category:",O),alert("Failed to add asset category")}},[un,Et,an,it]),ra=m.useCallback(_=>{const R=Et(_.graph);it(R),ut(O=>({...O,[_.parentId]:!0})),_.createdNodeIds.length>0&&s(_.createdNodeIds[0]),L(!0)},[Et,it,ut,s]);m.useEffect(()=>{const _=R=>{(R.ctrlKey||R.metaKey)&&R.key==="n"?(R.preventDefault(),ps()):(R.ctrlKey||R.metaKey)&&R.key==="s"?(R.preventDefault(),mn()):(R.ctrlKey||R.metaKey)&&R.key==="z"&&!R.shiftKey?(R.preventDefault(),ys()):(R.ctrlKey||R.metaKey)&&(R.shiftKey&&R.key==="z"||R.key==="y")?(R.preventDefault(),$s()):(R.ctrlKey||R.metaKey)&&R.key==="i"&&(R.preventDefault(),Va())};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[ps,mn,ys,$s,Va]),m.useEffect(()=>{let _=null;return(async()=>{console.log("[CLOSE HANDLER SETUP] Starting setup");try{let O=0;for(;!window.__TAURI__&&!window.__TAURI_INTERNALS__&&O<50;)await new Promise(ne=>setTimeout(ne,50)),O++;if(!window.__TAURI__&&!window.__TAURI_INTERNALS__){console.log("[CLOSE HANDLER SETUP] Tauri not available, skipping close handler");return}const{getCurrentWindow:H}=await Rt(async()=>{const{getCurrentWindow:ne}=await Promise.resolve().then(()=>zm);return{getCurrentWindow:ne}},void 0),{listen:I}=await Rt(async()=>{const{listen:ne}=await Promise.resolve().then(()=>Lb);return{listen:ne}},void 0),re=H();console.log("[CLOSE HANDLER SETUP] Got window reference"),_=await I("tauri://close-requested",async()=>{const ne=ce.current;if(console.log("===================================="),console.log("[CLOSE REQUESTED] EVENT RECEIVED!"),console.log("[CLOSE REQUESTED] isDirtyRef.current:",ne),console.log("===================================="),ne)console.log("[CLOSE REQUESTED] Dirty state detected, showing save dialog"),Ie.current=async()=>{console.log("[CLOSE REQUESTED DESTROY] About to force close window...");try{const{invoke:xe}=await Rt(async()=>{const{invoke:Be}=await Promise.resolve().then(()=>qa);return{invoke:Be}},void 0);console.log("[CLOSE REQUESTED DESTROY] Calling force_close_window"),await xe("force_close_window"),console.log("[CLOSE REQUESTED DESTROY] Force close completed")}catch(xe){console.error("[CLOSE REQUESTED DESTROY] Error:",xe)}},setTimeout(()=>{console.log("[CLOSE REQUESTED] Setting showSaveConfirmDialog to true"),me(!0)},0);else{console.log("[CLOSE REQUESTED] Clean state, force closing window...");try{const{invoke:xe}=await Rt(async()=>{const{invoke:Be}=await Promise.resolve().then(()=>qa);return{invoke:Be}},void 0);console.log("[CLOSE REQUESTED] Calling force_close_window"),await xe("force_close_window"),console.log("[CLOSE REQUESTED] Force close completed")}catch(xe){console.error("[CLOSE REQUESTED] Force close failed:",xe)}}}),console.log("[CLOSE HANDLER SETUP]  Event listener registered for tauri://close-requested")}catch(O){console.error("[CLOSE HANDLER SETUP]  Failed to setup close handler:",O)}})(),()=>{console.log("[CLOSE HANDLER CLEANUP] Cleaning up event listener"),_&&_()}},[]);const Rl=m.useCallback(async _=>{if(console.log("[SAVE DIALOG] User selected action:",_),me(!1),_==="save"){if(console.log("[SAVE DIALOG] Saving..."),!await mn()){console.log("[SAVE DIALOG] Save canceled or failed, staying open"),Ie.current=null;return}}else if(_==="save-as"){if(console.log("[SAVE DIALOG] Save As..."),!await dn()){console.log("[SAVE DIALOG] Save As canceled or failed, staying open"),Ie.current=null;return}}else if(_==="dont-save")console.log("[SAVE DIALOG] Don't save, closing immediately");else if(_==="cancel"){console.log("[SAVE DIALOG] Cancel, staying open"),Ie.current=null;return}if((_==="save-as"||_==="dont-save"||_==="save")&&Ie.current){console.log("[SAVE DIALOG] Executing pending close action, pendingCloseActionRef.current exists:",!!Ie.current);try{console.log("[SAVE DIALOG] About to call close action...");const R=Ie.current(),O=new Promise((I,re)=>setTimeout(()=>re(new Error("Close timeout")),5e3)),H=await Promise.race([R,O]);console.log("[SAVE DIALOG] Close action completed, result:",H)}catch(R){console.error("[SAVE DIALOG] Close action failed or timed out:",R);try{console.log("[SAVE DIALOG] Trying immediate fallback methods");try{const{getCurrentWindow:O}=await Rt(async()=>{const{getCurrentWindow:I}=await Promise.resolve().then(()=>zm);return{getCurrentWindow:I}},void 0),H=O();await Promise.race([H.destroy(),new Promise((I,re)=>setTimeout(()=>re(new Error("Timeout")),2e3))]),console.log("[SAVE DIALOG] Emergency destroy succeeded")}catch(O){console.error("[SAVE DIALOG] Emergency destroy failed:",O),window.close?.()}}catch(O){console.error("[SAVE DIALOG] All close attempts failed:",O)}}Ie.current=null}},[mn,dn]),Ul={File:[{label:"New Project",onClick:ps},{label:"Open Project...",onClick:eo},...bn.length>0?[{label:"---",onClick:()=>{}},{label:"Open Recent",submenu:bn.map(_=>({label:_.split("/").pop()||_,onClick:()=>qs(_)}))}]:[],{label:"---",onClick:()=>{}},{label:"Save",onClick:mn},{label:"Save As...",onClick:dn},{label:"---",onClick:()=>{}},{label:"Refresh Blueprint",onClick:async()=>{try{const _=ct;if(!_){alert("No template is currently loaded.");return}if(!S){alert("No active session. Please open or create a project first.");return}console.log("Refreshing template schema:",_);const R=await Ae.getTemplateSchema(_),O=Br(R);if(!O.isValid){console.error("Refreshed template validation failed:",O.errors),alert(`Template validation failed:
${O.errors.join(`
`)}`);return}Ft(R),console.log(" Template schema refreshed successfully"),Hx();try{await Ae.reloadBlueprint(S),console.log(" Backend blueprint reloaded from disk")}catch(H){console.warn("Failed to reload backend blueprint:",H)}try{const H=await Ae.getSessionGraph(S),I=Et(H.graph);it(I),console.log(" Graph reloaded with updated node metadata")}catch(H){console.warn("Failed to reload graph after schema refresh:",H)}alert("Template schema refreshed successfully!")}catch(_){console.error("Failed to refresh blueprint:",_),alert(`Failed to refresh template: ${_ instanceof Error?_.message:String(_)}`)}}},{label:"---",onClick:()=>{}},{label:"Exit",onClick:async()=>{try{const{invoke:_}=await Rt(async()=>{const{invoke:R}=await Promise.resolve().then(()=>qa);return{invoke:R}},void 0);await _("exit_app")}catch{window.close?.()}}}],Edit:[{label:"Undo",onClick:ys},{label:"Redo",onClick:$s}],View:[{label:"Toggle Properties Panel",onClick:Va},{label:"Expand All",onClick:wn},{label:"Collapse All",onClick:Al}],Tools:[{label:"Import from CSV...",onClick:()=>qe(!0)},{label:"Export Data...",onClick:()=>de(!0)},{label:"---",onClick:()=>{}},{label:"Template Editor",onClick:()=>M(!0)},{label:"Indicator Editor",onClick:()=>j(!0)},{label:"Markup Editor",onClick:()=>g(!0)},{label:"Icon Editor",onClick:()=>A(!0)},{label:"---",onClick:()=>{}},{label:"Settings",onClick:()=>B(!0)}],Help:[{label:"Documentation",onClick:()=>console.log("Docs - TODO")},{label:"About",onClick:()=>console.log("About - TODO")}]};return l.jsx(Dv,{children:!Vn||vn?l.jsx("div",{className:"flex items-center justify-center h-screen bg-bg-dark text-fg-primary",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl mb-4",children:"Loading Talus Tally..."}),l.jsx("div",{className:"text-sm text-fg-secondary",children:vn?"Connecting to backend server...":"Initializing session..."})]})}):St?l.jsx("div",{className:"flex items-center justify-center h-screen bg-bg-dark text-fg-primary",children:l.jsxs("div",{className:"text-center max-w-md",children:[l.jsx("div",{className:"text-2xl mb-4 text-red-500",children:"Connection Error"}),l.jsx("div",{className:"text-sm text-fg-secondary mb-6",children:St}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Retry Connection"})]})}):l.jsxs("div",{className:"flex flex-col h-screen bg-bg-dark text-fg-primary relative",children:[l.jsx(El,{title:G?"TALUS TALLY *":"TALUS TALLY",isDirty:G,onClose:Ga}),l.jsx(Gb,{menus:Ul}),l.jsx(Xb,{activeView:x,onViewChange:w,activeToolsTab:E,onToolsTabChange:y,blockingNodeCount:C,blockingEdgeCount:Q,onBlockingFitToView:Ci}),l.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[x==="graph"?l.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:l.jsx("main",{className:"flex-1 bg-bg-dark border-r border-border overflow-auto p-4",children:Ee.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-fg-secondary",children:[l.jsx("div",{className:"text-lg mb-4",children:"No project loaded"}),l.jsx("div",{className:"text-sm",children:"Use File  New Project to get started"})]}):l.jsx(Qx,{nodes:Ee,onSelectNode:s,expandAllSignal:Tt,collapseAllSignal:Lt,getTypeLabel:_=>Qe&&Qe.node_types.find(O=>O.id===_)?.name||_,expandedMap:xn,setExpandedMap:ut,onContextMenu:(_,R)=>{if(console.log(`Context menu action "${R}" on node:`,_),R==="add-asset-category"){On(_),ee(!0);return}if(R.startsWith("add:")){const O=R.split(":")[1],H=We[_];if(!H){alert("Node not found");return}if(O==="assets"||O==="asset_category"){On(_),ee(!0);return}if(O==="asset_reference"||O==="uses_camera_gear"||O==="uses_car_part"||O==="uses_tool"){Xt(_),Ut(O),$(!0);return}let I=O;if(Qe){const re=Qe.node_types.find(ne=>ne.id===O);re&&(I=re.name)}Ya(_,H.properties?.name,I,O)}else if(R==="delete"){const O=We[_],H=O?.properties?.name||O?.type||_;Je({nodeIds:[_],label:H})}else if(R.startsWith("move:")){const O=R.split(":")[1];console.log(`Moving node ${_} to new parent ${O}`),an("MoveNode",{node_id:_,new_parent_id:O}).then(H=>{const I=Et(H.graph??H);it(I),L(H.is_dirty??!0),console.log(" Node moved via API")}).catch(H=>{const I=H instanceof Error?H.message:String(H);console.error("Failed to move node:",H);const re=I.includes("not allowed")?I:"Failed to move node to this location";alert(`Cannot move node: ${re}`)})}else if(R.startsWith("reorder:")){const[,O,H]=R.split(":"),I=We[O],re=We[_],ne=bt=>bt==null?null:String(bt),xe=bt=>{if(!bt)return null;for(const At of Object.values(We??{}))if(At?.children?.includes(bt))return At.id;return null},Be=ne(I?.parent_id??xe(O)),ft=ne(re?.parent_id??xe(_));if(!I||!re||Be!==ft){alert("Invalid reorder operation");return}const ga=()=>{if(Array.isArray(Ee)&&Ee.length>0)return Ee.map(pn=>pn.id);const bt=Object.values(We??{}),At=new Set;return bt.forEach(pn=>pn.children?.forEach(Gs=>At.add(Gs))),bt.filter(pn=>!At.has(pn.id)).map(pn=>pn.id)};let Sn;if(Be){const bt=We[Be];if(!bt||!Array.isArray(bt.children)){alert("Parent not found for reorder");return}Sn=bt.children.slice()}else Sn=ga();const Nn=Sn.filter(bt=>bt!==_).indexOf(O);if(Nn===-1){alert("Target position unavailable for reorder");return}let bs=Nn;H==="below"&&(bs+=1),an("ReorderNode",{node_id:_,new_index:bs}).then(bt=>{const At=Et(bt.graph??bt);it(At),L(bt.is_dirty??!0),console.log(" Node reordered via API")}).catch(bt=>{const At=bt instanceof Error?bt.message:String(bt);console.error("Failed to reorder node:",bt),alert(`Cannot reorder node: ${At}`)})}}})})}):l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(Av,{sessionId:S,nodes:We,onNodeSelect:u,activeTab:E,onBlockingCountsChange:Dl,onBlockingDirtyChange:L,blockingFitToViewSignal:be,blockingRefreshSignal:Ne,blockingViewConfig:Qe?.blocking_view,templateSchema:Qe})}),f&&l.jsx("aside",{className:"w-80 h-full bg-bg-darker border-l border-border flex flex-col flex-shrink-0",children:l.jsx(Ix,{nodeId:la||void 0,nodeName:Bt?.properties?.name||la||void 0,nodeType:Bt?.type||void 0,properties:ia,linkedAsset:x==="graph"&&ma?ma:void 0,orphanedProperties:x==="graph"?Bt?.metadata?.orphaned_properties:void 0,onPropertyChange:(_,R)=>{if(!Bt){alert("No node selected");return}console.log("[onPropertyChange] Starting property update:",{nodeId:Bt.id,propId:_,oldValue:Bt.properties?.[_],newValue:R}),an("UpdateProperty",{node_id:Bt.id,property_id:_,old_value:Bt.properties?.[_],new_value:R}).then(O=>{console.log("[onPropertyChange] Got result from API"),console.log("[onPropertyChange] Result keys:",Object.keys(O)),console.log("[onPropertyChange] Result.graph:",O.graph),console.log("[onPropertyChange] Result.graph.roots count:",O.graph?.roots?.length),console.log("[onPropertyChange] Starting normalizeGraph...");try{const H=Et(O.graph??O);console.log("[onPropertyChange] Graph normalized successfully, nodes:",H.nodes.length),it(H),L(O.is_dirty??!0),console.log(" Property updated")}catch(H){console.error("[onPropertyChange] Error normalizing graph:",H),alert("Error updating UI after property change: "+H.message)}}).catch(O=>{console.error("Failed to update property:",O),alert("Failed to update property")})},onLinkedAssetPropertyChange:(_,R)=>{const O=kt();if(!O){alert("No linked asset");return}an("UpdateProperty",{node_id:O.nodeId,property_id:_,old_value:We[O.nodeId]?.properties?.[_],new_value:R}).then(H=>{const I=Et(H.graph??H);it(I),L(H.is_dirty??!0),console.log(" Asset property updated")}).catch(H=>{console.error("Failed to update asset property:",H),alert("Failed to update asset property")})},blockedByNodes:J,blocksNodes:ke,nodes:We,onClearBlocks:to,velocityScore:z||void 0})})]}),fe&&l.jsx(Gm,{templates:zn,onConfirm:gs,onCancel:()=>oe(!1)}),!1,fe&&l.jsx(Gm,{templates:zn,onConfirm:gs,onCancel:()=>oe(!1)}),Ce&&l.jsx(Wx,{title:zt,confirmLabel:zt?.replace(/^Add /,"Add ")||"Add Child",onConfirm:no,onCancel:()=>{Re(!1),Ot(null),Hs(void 0)}}),Oe&&l.jsx(Px,{title:"Select Asset to Use",assets:Ti(Qt),onConfirm:ao,onCancel:()=>{$(!1),Xt(null),Ut("asset_reference")}}),ye&&l.jsx(ev,{title:"Add Asset Category",categories:ki(),onConfirm:Vs,onCancel:()=>{ee(!1),On(null)}}),we&&l.jsx(ov,{isOpen:we,selectedNodeId:o,nodes:We,templateSchema:Qe,ensureSession:ja,onClose:()=>qe(!1),onImported:ra}),te&&l.jsx(dv,{isOpen:te,onClose:()=>de(!1),sessionId:S}),Se&&l.jsx(nv,{isOpen:Se,onClose:()=>B(!1)}),v&&l.jsx("div",{className:"absolute inset-0 bg-bg-dark z-50",children:l.jsx(xv,{onClose:()=>M(!1)})}),Z&&l.jsx("div",{className:"absolute inset-0 bg-bg-dark z-50",children:l.jsx(vv,{onClose:()=>j(!1)})}),se&&l.jsx("div",{className:"absolute inset-0 bg-bg-dark z-50",children:l.jsx(Nv,{onClose:()=>g(!1)})}),T&&l.jsx("div",{className:"absolute inset-0 bg-bg-dark z-50",children:l.jsx(_v,{onClose:()=>A(!1)})}),l.jsx(av,{isOpen:X,onConfirm:Rl,onCancel:()=>{console.log("[SAVE DIALOG] User clicked Cancel"),me(!1),Ie.current=null}}),l.jsx(Ep,{isOpen:!!Xe,onClose:()=>Je(null),title:"Delete Node",actions:l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"px-4 py-2 bg-bg-dark border border-border text-fg-primary rounded hover:bg-bg-light transition-colors",onClick:()=>Je(null),children:"Cancel"}),l.jsx("button",{className:"px-4 py-2 bg-status-danger/20 text-status-danger rounded hover:bg-status-danger/30 transition-colors",onClick:()=>{const _=Xe;if(!_)return;const R=_.nodeIds[0];an("DeleteNode",{node_id:R}).then(O=>{const H=Et(O.graph??O);it(H),L(O.is_dirty??!0),console.log(" Node deleted via API")}).catch(O=>{console.error("Failed to delete node:",O),alert("Failed to delete node")}).finally(()=>Je(null))},children:"Delete"})]}),children:l.jsxs("div",{className:"text-sm text-fg-secondary",children:["Delete ",l.jsx("span",{className:"text-fg-primary font-semibold",children:Xe?.label}),"? You can undo this action."]})})]})})}Vy.createRoot(document.getElementById("root")).render(l.jsx(m.StrictMode,{children:l.jsx(Uv,{})}));export{np as C,ap as R,pe as i};
